
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://pasqal-io.github.io/qadence/v1.0.4/qadence/constructors/">
      
      
        <link rel="prev" href="../states/">
      
      
        <link rel="next" href="../transpile/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.3.2">
    
    
      
        <title>Constructors - Qadence</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.30068a00.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_markdown_exec_ansi.css">
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#constructors-for-common-quantum-circuits" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Qadence" class="md-header__button md-logo" aria-label="Qadence" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Qadence
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Constructors
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pasqal-io/qadence/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    qadence
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
    
  
  Qadence

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../digital_analog_qc/daqc-basics/" class="md-tabs__link">
        
  
    
  
  Digital-analog quantum computing

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../qml/" class="md-tabs__link">
        
  
    
  
  Variational quantum algorithms

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../advanced_tutorials/differentiability/" class="md-tabs__link">
          
  
    
  
  Advanced Tutorials

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../blocks/" class="md-tabs__link">
          
  
    
  
  API

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../development/architecture/" class="md-tabs__link">
          
  
    
  
  Development

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Qadence" class="md-nav__button md-logo" aria-label="Qadence" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Qadence
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pasqal-io/qadence/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    qadence
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Qadence
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_1">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Qadence
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../CODE_OF_CONDUCT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code of conduct
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/quantummodels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantum models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parametric programs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/register/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantum registers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/state_conventions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State conventions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/state_init/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State initialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/hamiltonians/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arbitrary Hamiltonians
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/overlap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wavefunction overlaps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/serializ_and_prep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/backends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backends
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../digital_analog_qc/daqc-basics/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Digital-analog quantum computing
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Digital-analog quantum computing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../digital_analog_qc/analog-basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Digital-analog emulation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../digital_analog_qc/pulser-basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pulse-level programming with Pulser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../digital_analog_qc/analog-qubo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solve a QUBO problem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../digital_analog_qc/daqc-cnot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CNOT with interacting qubits
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../qml/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Variational quantum algorithms
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Variational quantum algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../qml/qml_constructors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constructors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../qml/ml_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../qml/qcl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantum circuit learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../qml/qaoa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solving MaxCut with QAOA
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced_tutorials/differentiability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantum circuits differentiation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced_tutorials/custom-models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom quantum models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../blocks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Block system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../operations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../register/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Register
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../quantumcircuit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QuantumCircuit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State preparation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Constructors
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Constructors
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.feature_maps.chebyshev_feature_map" class="md-nav__link">
    chebyshev_feature_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.feature_maps.exp_fourier_feature_map" class="md-nav__link">
    exp_fourier_feature_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.feature_maps.feature_map" class="md-nav__link">
    feature_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.feature_maps.fourier_feature_map" class="md-nav__link">
    fourier_feature_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.feature_maps.tower_feature_map" class="md-nav__link">
    tower_feature_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.ansatze.build_qnn" class="md-nav__link">
    build_qnn()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.ansatze.hea" class="md-nav__link">
    hea()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.ansatze.hea_digital" class="md-nav__link">
    hea_digital()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.ansatze.hea_sDAQC" class="md-nav__link">
    hea_sDAQC()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.hamiltonians.hamiltonian_factory" class="md-nav__link">
    hamiltonian_factory()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.hamiltonians.interaction_nn" class="md-nav__link">
    interaction_nn()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.hamiltonians.interaction_xy" class="md-nav__link">
    interaction_xy()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.hamiltonians.interaction_xyz" class="md-nav__link">
    interaction_xyz()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.hamiltonians.interaction_zz" class="md-nav__link">
    interaction_zz()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.qft.qft" class="md-nav__link">
    qft()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-daqc-transform" class="md-nav__link">
    The DAQC Transform
  </a>
  
    <nav class="md-nav" aria-label="The DAQC Transform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.constructors.daqc.daqc.daqc_transform" class="md-nav__link">
    daqc_transform()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#some-utility-functions" class="md-nav__link">
    Some utility functions
  </a>
  
    <nav class="md-nav" aria-label="Some utility functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.constructors.utils.build_idx_fms" class="md-nav__link">
    build_idx_fms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.constructors.utils.generator_prefactor" class="md-nav__link">
    generator_prefactor()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.constructors.utils.get_fm_qubits" class="md-nav__link">
    get_fm_qubits()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../transpile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transpilation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../execution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Execution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantum models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ml_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QML tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../serialization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_14" >
        
          <label class="md-nav__link" for="__nav_5_14" id="__nav_5_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Backends
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_14">
            <span class="md-nav__icon md-icon"></span>
            Backends
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../backends/backend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abstract backend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../backends/pyqtorch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyQTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../backends/braket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Amazon Braket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../backends/pulser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pulser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../backends/differentiable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DifferentiableBackend
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../development/architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture and sharp bits
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../development/draw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drawing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.feature_maps.chebyshev_feature_map" class="md-nav__link">
    chebyshev_feature_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.feature_maps.exp_fourier_feature_map" class="md-nav__link">
    exp_fourier_feature_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.feature_maps.feature_map" class="md-nav__link">
    feature_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.feature_maps.fourier_feature_map" class="md-nav__link">
    fourier_feature_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.feature_maps.tower_feature_map" class="md-nav__link">
    tower_feature_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.ansatze.build_qnn" class="md-nav__link">
    build_qnn()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.ansatze.hea" class="md-nav__link">
    hea()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.ansatze.hea_digital" class="md-nav__link">
    hea_digital()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.ansatze.hea_sDAQC" class="md-nav__link">
    hea_sDAQC()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.hamiltonians.hamiltonian_factory" class="md-nav__link">
    hamiltonian_factory()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.hamiltonians.interaction_nn" class="md-nav__link">
    interaction_nn()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.hamiltonians.interaction_xy" class="md-nav__link">
    interaction_xy()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.hamiltonians.interaction_xyz" class="md-nav__link">
    interaction_xyz()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.hamiltonians.interaction_zz" class="md-nav__link">
    interaction_zz()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qadence.constructors.qft.qft" class="md-nav__link">
    qft()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-daqc-transform" class="md-nav__link">
    The DAQC Transform
  </a>
  
    <nav class="md-nav" aria-label="The DAQC Transform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.constructors.daqc.daqc.daqc_transform" class="md-nav__link">
    daqc_transform()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#some-utility-functions" class="md-nav__link">
    Some utility functions
  </a>
  
    <nav class="md-nav" aria-label="Some utility functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.constructors.utils.build_idx_fms" class="md-nav__link">
    build_idx_fms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.constructors.utils.generator_prefactor" class="md-nav__link">
    generator_prefactor()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.constructors.utils.get_fm_qubits" class="md-nav__link">
    get_fm_qubits()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/pasqal-io/qadence/edit/main/docs/qadence/constructors.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/pasqal-io/qadence/raw/main/docs/qadence/constructors.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


<h1 id="constructors-for-common-quantum-circuits">Constructors for common quantum circuits</h1>


<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.feature_maps.chebyshev_feature_map" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">chebyshev_feature_map</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="s1">&#39;phi&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">RX</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Construct a Chebyshev feature map.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_qubits</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>number of qubits across which the FM is created</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>support</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The qubit support</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Iterable[int]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>param</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The base name for the feature <code>Parameter</code></p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;phi&#39;</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/feature_maps.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="k">def</span> <span class="nf">chebyshev_feature_map</span><span class="p">(</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">support</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;phi&quot;</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">RotationTypes</span> <span class="o">=</span> <span class="n">RX</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct a Chebyshev feature map.</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        n_qubits: number of qubits across which the FM is created</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        support (Iterable[int]): The qubit support</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        param: The base name for the feature `Parameter`</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="s2">&quot;Function &#39;chebyshev_feature_map&#39; is deprecated. Please use &#39;feature_map&#39; directly.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="ne">FutureWarning</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="n">fm</span> <span class="o">=</span> <span class="n">feature_map</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">op</span><span class="p">,</span> <span class="n">fm_type</span><span class="o">=</span><span class="n">BasisSet</span><span class="o">.</span><span class="n">CHEBYSHEV</span><span class="p">)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="k">return</span> <span class="n">fm</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.feature_maps.exp_fourier_feature_map" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">exp_fourier_feature_map</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">feature_range</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Exponential fourier feature map.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_qubits</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>number of qubits in the feature</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>support</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>qubit support</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>tuple[int, ...]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>param</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>name of feature <code>Parameter</code></p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;x&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>feature_range</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>min and max value of the feature, as floats in a Tuple</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>tuple[float, float]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/feature_maps.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="k">def</span> <span class="nf">exp_fourier_feature_map</span><span class="p">(</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="n">support</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="n">param</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="n">feature_range</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    Exponential fourier feature map.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        n_qubits: number of qubits in the feature</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        support: qubit support</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        param: name of feature `Parameter`</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        feature_range: min and max value of the feature, as floats in a Tuple</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="k">if</span> <span class="n">feature_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="n">feature_range</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">**</span><span class="n">n_qubits</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="n">support</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">))</span> <span class="k">if</span> <span class="n">support</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">support</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="n">hlayer</span> <span class="o">=</span> <span class="n">kron</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">qubit</span><span class="p">)</span> <span class="k">for</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="n">support</span><span class="p">)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="n">rlayer</span> <span class="o">=</span> <span class="n">feature_map</span><span class="p">(</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="n">n_qubits</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">,</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="n">op</span><span class="o">=</span><span class="n">RZ</span><span class="p">,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="n">fm_type</span><span class="o">=</span><span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span><span class="p">,</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="n">reupload_scaling</span><span class="o">=</span><span class="n">ReuploadScaling</span><span class="o">.</span><span class="n">EXP</span><span class="p">,</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="n">feature_range</span><span class="o">=</span><span class="n">feature_range</span><span class="p">,</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">target_range</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">),</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="n">rlayer</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="k">return</span> <span class="n">tag</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="n">hlayer</span><span class="p">,</span> <span class="n">rlayer</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;ExpFourierFM(</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.feature_maps.feature_map" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">feature_map</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="s1">&#39;phi&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">RX</span><span class="p">,</span> <span class="n">fm_type</span><span class="o">=</span><span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span><span class="p">,</span> <span class="n">reupload_scaling</span><span class="o">=</span><span class="n">ReuploadScaling</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">,</span> <span class="n">feature_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">multiplier</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Construct a feature map of a given type.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_qubits</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Number of qubits the feature map covers. Results in <code>support=range(n_qubits)</code>.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>support</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Puts one feature-encoding rotation gate on every qubit in <code>support</code>. n_qubits in
this case specifies the total overall qubits of the circuit, which may be wider than the
support itself, but not narrower.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>tuple[int, ...] | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>param</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Parameter of the feature map; you can pass a string or Parameter;
it will be set as non-trainable (FeatureParameter) regardless.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.parameters.Parameter" href="../parameters/#qadence.parameters.Parameter">Parameter</a> | str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;phi&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>op</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Rotation operation of the feature map; choose from RX, RY, RZ or PHASE.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="qadence.constructors.feature_maps.RotationTypes">RotationTypes</span></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><a class="autorefs autorefs-internal" title="qadence.operations.RX" href="../operations/#qadence.operations.RX">RX</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>fm_type</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Basis set for data encoding; choose from <code>BasisSet.FOURIER</code> for Fourier
encoding, or <code>BasisSet.CHEBYSHEV</code> for Chebyshev polynomials of the first kind.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.types.BasisSet" href="../types/#qadence.types.BasisSet">BasisSet</a> | type[<span title="sympy.Function">Function</span>] | str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><a class="autorefs autorefs-internal" title="qadence.types.BasisSet.FOURIER" href="../types/#qadence.types.BasisSet.FOURIER">FOURIER</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>reupload_scaling</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>how the feature map scales the data that is re-uploaded for each qubit.
choose from <code>ReuploadScaling</code> enumeration or provide your own function with a single
int as input and int or float as output.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.types.ReuploadScaling" href="../types/#qadence.types.ReuploadScaling">ReuploadScaling</a> | <span title="collections.abc.Callable">Callable</span> | str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><a class="autorefs autorefs-internal" title="qadence.types.ReuploadScaling.CONSTANT" href="../types/#qadence.types.ReuploadScaling.CONSTANT">CONSTANT</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>feature_range</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>range of data that the input data is assumed to come from.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>tuple[float, float] | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>target_range</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>range of data the data encoder assumes as the natural range. For example,
in Chebyshev polynomials it is (-1, 1), while for Fourier it may be chosen as (0, 2*pi).</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>tuple[float, float] | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>multiplier</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>overall multiplier; this is useful for reuploading the feature map serially with
different scalings; can be a number or parameter/expression.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.parameters.Parameter" href="../parameters/#qadence.parameters.Parameter">Parameter</a> | <a class="autorefs autorefs-internal" title="qadence.types.TParameter" href="../types/#qadence.types.TParameter">TParameter</a> | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span> <span class="nn">qadence</span> <span class="kn">import</span> <span class="n">feature_map</span><span class="p">,</span> <span class="n">BasisSet</span><span class="p">,</span> <span class="n">ReuploadScaling</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">fm</span> <span class="o">=</span> <span class="n">feature_map</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">fm_type</span><span class="o">=</span><span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fm</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">fm</span> <span class="o">=</span> <span class="n">feature_map</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">fm_type</span><span class="o">=</span><span class="n">BasisSet</span><span class="o">.</span><span class="n">CHEBYSHEV</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fm</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">fm</span> <span class="o">=</span> <span class="n">feature_map</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">fm_type</span><span class="o">=</span><span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span><span class="p">,</span> <span class="n">reupload_scaling</span> <span class="o">=</span> <span class="n">ReuploadScaling</span><span class="o">.</span><span class="n">TOWER</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fm</span><span class="w"> </span><span class="si">= }</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kc">f</span><span class="err">m</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">Kro</span><span class="kc">n</span><span class="err">Block(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="err">)</span><span class="w"> </span><span class="p">[</span><span class="kc">ta</span><span class="err">g</span><span class="p">:</span><span class="w"> </span><span class="err">Co</span><span class="kc">nstant</span><span class="w"> </span><span class="err">Fourier</span><span class="w"> </span><span class="err">FM</span><span class="p">]</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="err"></span><span class="w"> </span><span class="err">RX(</span><span class="mi">0</span><span class="err">)</span><span class="w"> </span><span class="p">[</span><span class="err">params</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;phi&#39;</span><span class="p">]]</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="err"></span><span class="w"> </span><span class="err">RX(</span><span class="mi">1</span><span class="err">)</span><span class="w"> </span><span class="p">[</span><span class="err">params</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;phi&#39;</span><span class="p">]]</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="err"></span><span class="w"> </span><span class="err">RX(</span><span class="mi">2</span><span class="err">)</span><span class="w"> </span><span class="p">[</span><span class="err">params</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;phi&#39;</span><span class="p">]]</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="kc">f</span><span class="err">m</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">Kro</span><span class="kc">n</span><span class="err">Block(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="err">)</span><span class="w"> </span><span class="p">[</span><span class="kc">ta</span><span class="err">g</span><span class="p">:</span><span class="w"> </span><span class="err">Co</span><span class="kc">nstant</span><span class="w"> </span><span class="err">Chebyshev</span><span class="w"> </span><span class="err">FM</span><span class="p">]</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="err"></span><span class="w"> </span><span class="err">RX(</span><span class="mi">0</span><span class="err">)</span><span class="w"> </span><span class="p">[</span><span class="err">params</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;acos(phi)&#39;</span><span class="p">]]</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="err"></span><span class="w"> </span><span class="err">RX(</span><span class="mi">1</span><span class="err">)</span><span class="w"> </span><span class="p">[</span><span class="err">params</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;acos(phi)&#39;</span><span class="p">]]</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="err"></span><span class="w"> </span><span class="err">RX(</span><span class="mi">2</span><span class="err">)</span><span class="w"> </span><span class="p">[</span><span class="err">params</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;acos(phi)&#39;</span><span class="p">]]</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="kc">f</span><span class="err">m</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">Kro</span><span class="kc">n</span><span class="err">Block(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="err">)</span><span class="w"> </span><span class="p">[</span><span class="kc">ta</span><span class="err">g</span><span class="p">:</span><span class="w"> </span><span class="err">Tower</span><span class="w"> </span><span class="err">Fourier</span><span class="w"> </span><span class="err">FM</span><span class="p">]</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="err"></span><span class="w"> </span><span class="err">RX(</span><span class="mi">0</span><span class="err">)</span><span class="w"> </span><span class="p">[</span><span class="err">params</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;</span><span class="mi">1</span><span class="err">_</span><span class="mi">0</span><span class="err">*phi&#39;</span><span class="p">]]</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="err"></span><span class="w"> </span><span class="err">RX(</span><span class="mi">1</span><span class="err">)</span><span class="w"> </span><span class="p">[</span><span class="err">params</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;</span><span class="mi">2</span><span class="err">_</span><span class="mi">0</span><span class="err">*phi&#39;</span><span class="p">]]</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="err"></span><span class="w"> </span><span class="err">RX(</span><span class="mi">2</span><span class="err">)</span><span class="w"> </span><span class="p">[</span><span class="err">params</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;</span><span class="mi">3</span><span class="err">_</span><span class="mi">0</span><span class="err">*phi&#39;</span><span class="p">]]</span>
</code></pre></div>

</div></p>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/feature_maps.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="k">def</span> <span class="nf">feature_map</span><span class="p">(</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">support</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">param</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;phi&quot;</span><span class="p">,</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">op</span><span class="p">:</span> <span class="n">RotationTypes</span> <span class="o">=</span> <span class="n">RX</span><span class="p">,</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">fm_type</span><span class="p">:</span> <span class="n">BasisSet</span> <span class="o">|</span> <span class="nb">type</span><span class="p">[</span><span class="n">Function</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span><span class="p">,</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="n">reupload_scaling</span><span class="p">:</span> <span class="n">ReuploadScaling</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">ReuploadScaling</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">,</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">feature_range</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">target_range</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">multiplier</span><span class="p">:</span> <span class="n">Parameter</span> <span class="o">|</span> <span class="n">TParameter</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KronBlock</span><span class="p">:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct a feature map of a given type.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        n_qubits: Number of qubits the feature map covers. Results in `support=range(n_qubits)`.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        support: Puts one feature-encoding rotation gate on every qubit in `support`. n_qubits in</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">            this case specifies the total overall qubits of the circuit, which may be wider than the</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            support itself, but not narrower.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        param: Parameter of the feature map; you can pass a string or Parameter;</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">            it will be set as non-trainable (FeatureParameter) regardless.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        op: Rotation operation of the feature map; choose from RX, RY, RZ or PHASE.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        fm_type: Basis set for data encoding; choose from `BasisSet.FOURIER` for Fourier</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">            encoding, or `BasisSet.CHEBYSHEV` for Chebyshev polynomials of the first kind.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        reupload_scaling: how the feature map scales the data that is re-uploaded for each qubit.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">            choose from `ReuploadScaling` enumeration or provide your own function with a single</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">            int as input and int or float as output.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        feature_range: range of data that the input data is assumed to come from.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        target_range: range of data the data encoder assumes as the natural range. For example,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">            in Chebyshev polynomials it is (-1, 1), while for Fourier it may be chosen as (0, 2*pi).</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        multiplier: overall multiplier; this is useful for reuploading the feature map serially with</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">            different scalings; can be a number or parameter/expression.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    ```python exec=&quot;on&quot; source=&quot;material-block&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    from qadence import feature_map, BasisSet, ReuploadScaling</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    fm = feature_map(3, fm_type=BasisSet.FOURIER)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    print(f&quot;{fm = }&quot;)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    fm = feature_map(3, fm_type=BasisSet.CHEBYSHEV)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    print(f&quot;{fm = }&quot;)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    fm = feature_map(3, fm_type=BasisSet.FOURIER, reupload_scaling = ReuploadScaling.TOWER)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    print(f&quot;{fm = }&quot;)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    ```</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="c1"># Process input</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="k">if</span> <span class="n">support</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="n">support</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">))</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">support</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_qubits</span><span class="p">:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wrong qubit support supplied&quot;</span><span class="p">)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="n">op</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ROTATIONS</span><span class="p">:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="sa">f</span><span class="s2">&quot;Operation </span><span class="si">{</span><span class="n">op</span><span class="si">}</span><span class="s2"> not supported. &quot;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="sa">f</span><span class="s2">&quot;Please provide one from </span><span class="si">{</span><span class="p">[</span><span class="n">rot</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">rot</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">ROTATIONS</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="c1"># Backwards compatibility</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="k">if</span> <span class="n">fm_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;fourier&quot;</span><span class="p">,</span> <span class="s2">&quot;chebyshev&quot;</span><span class="p">,</span> <span class="s2">&quot;tower&quot;</span><span class="p">):</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="s2">&quot;Selecting `fm_type` as &#39;fourier&#39;, &#39;chebyshev&#39; or &#39;tower&#39; is deprecated. &quot;</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="s2">&quot;Please use the respective enumerations: &#39;fm_type = BasisSet.FOURIER&#39;, &quot;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="s2">&quot;&#39;fm_type = BasisSet.CHEBYSHEV&#39; or &#39;reupload_scaling = ReuploadScaling.TOWER&#39;.&quot;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="k">if</span> <span class="n">fm_type</span> <span class="o">==</span> <span class="s2">&quot;fourier&quot;</span><span class="p">:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="n">fm_type</span> <span class="o">=</span> <span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="k">elif</span> <span class="n">fm_type</span> <span class="o">==</span> <span class="s2">&quot;chebyshev&quot;</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">fm_type</span> <span class="o">=</span> <span class="n">BasisSet</span><span class="o">.</span><span class="n">CHEBYSHEV</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="k">elif</span> <span class="n">fm_type</span> <span class="o">==</span> <span class="s2">&quot;tower&quot;</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="n">fm_type</span> <span class="o">=</span> <span class="n">BasisSet</span><span class="o">.</span><span class="n">CHEBYSHEV</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="n">reupload_scaling</span> <span class="o">=</span> <span class="n">ReuploadScaling</span><span class="o">.</span><span class="n">TOWER</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">):</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">fparam</span> <span class="o">=</span> <span class="n">param</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">fparam</span><span class="o">.</span><span class="n">trainable</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">fparam</span> <span class="o">=</span> <span class="n">FeatureParameter</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="c1"># Set feature and target range</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">feature_range</span> <span class="o">=</span> <span class="n">_set_range</span><span class="p">(</span><span class="n">fm_type</span><span class="p">)</span> <span class="k">if</span> <span class="n">feature_range</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">feature_range</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">target_range</span> <span class="o">=</span> <span class="n">_set_range</span><span class="p">(</span><span class="n">fm_type</span><span class="p">)</span> <span class="k">if</span> <span class="n">target_range</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">target_range</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="c1"># Rescale the feature parameter</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">scaling</span> <span class="o">=</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">target_range</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">target_range</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">feature_range</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">feature_range</span><span class="p">))</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">shift</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">target_range</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">feature_range</span><span class="p">)</span> <span class="o">*</span> <span class="n">scaling</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">if</span> <span class="n">isclose</span><span class="p">(</span><span class="n">scaling</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">):</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="c1"># So we don&#39;t get 1.0 factor in visualization</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">scaled_fparam</span> <span class="o">=</span> <span class="n">fparam</span> <span class="o">+</span> <span class="n">shift</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">scaled_fparam</span> <span class="o">=</span> <span class="n">scaling</span> <span class="o">*</span> <span class="n">fparam</span> <span class="o">+</span> <span class="n">shift</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="c1"># Transform feature parameter</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">if</span> <span class="n">fm_type</span> <span class="o">==</span> <span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">transformed_feature</span> <span class="o">=</span> <span class="n">scaled_fparam</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="k">elif</span> <span class="n">fm_type</span> <span class="o">==</span> <span class="n">BasisSet</span><span class="o">.</span><span class="n">CHEBYSHEV</span><span class="p">:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">transformed_feature</span> <span class="o">=</span> <span class="n">acos</span><span class="p">(</span><span class="n">scaled_fparam</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="k">elif</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">fm_type</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">fm_type</span><span class="p">,</span> <span class="n">Function</span><span class="p">):</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">transformed_feature</span> <span class="o">=</span> <span class="n">fm_type</span><span class="p">(</span><span class="n">scaled_fparam</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="sa">f</span><span class="s2">&quot;Feature map type </span><span class="si">{</span><span class="n">fm_type</span><span class="si">}</span><span class="s2"> not implemented. Choose an item from the BasisSet &quot;</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="sa">f</span><span class="s2">&quot;enum: </span><span class="si">{</span><span class="p">[</span><span class="n">bs</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">bs</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">BasisSet</span><span class="p">]</span><span class="si">}</span><span class="s2">, or your own sympy.Function to wrap &quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>            <span class="s2">&quot;the given feature parameter with.&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="p">)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">basis_tag</span> <span class="o">=</span> <span class="n">fm_type</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fm_type</span><span class="p">,</span> <span class="n">BasisSet</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">fm_type</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="c1"># Set reupload scaling function</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">reupload_scaling</span><span class="p">):</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="n">rs_func</span> <span class="o">=</span> <span class="n">reupload_scaling</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">rs_tag</span> <span class="o">=</span> <span class="s2">&quot;Custom&quot;</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="n">rs_func</span> <span class="o">=</span> <span class="n">RS_FUNC_DICT</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reupload_scaling</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># type: ignore [call-overload]</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="k">if</span> <span class="n">rs_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                <span class="sa">f</span><span class="s2">&quot;Reupload scaling </span><span class="si">{</span><span class="n">reupload_scaling</span><span class="si">}</span><span class="s2"> not implemented; choose an item from &quot;</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                <span class="sa">f</span><span class="s2">&quot;the ReuploadScaling enum: </span><span class="si">{</span><span class="p">[</span><span class="n">rs</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">ReuploadScaling</span><span class="p">]</span><span class="si">}</span><span class="s2">, or your own &quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                <span class="s2">&quot;python function with a single int arg as input and int or float output.&quot;</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reupload_scaling</span><span class="p">,</span> <span class="n">ReuploadScaling</span><span class="p">):</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="n">rs_tag</span> <span class="o">=</span> <span class="n">reupload_scaling</span><span class="o">.</span><span class="n">value</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="n">rs_tag</span> <span class="o">=</span> <span class="n">reupload_scaling</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="c1"># Set overall multiplier</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="n">multiplier</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">multiplier</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">multiplier</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="c1"># Build feature map</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">op_list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">support</span><span class="p">):</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">op_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="p">(</span><span class="n">qubit</span><span class="p">,</span> <span class="n">multiplier</span> <span class="o">*</span> <span class="n">rs_func</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">transformed_feature</span><span class="p">))</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="n">fm</span> <span class="o">=</span> <span class="n">kron</span><span class="p">(</span><span class="o">*</span><span class="n">op_list</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="n">fm</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="n">rs_tag</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">basis_tag</span> <span class="o">+</span> <span class="s2">&quot; FM&quot;</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="k">return</span> <span class="n">fm</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.feature_maps.fourier_feature_map" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">fourier_feature_map</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="s1">&#39;phi&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">RX</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Construct a Fourier feature map.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_qubits</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>number of qubits across which the FM is created</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>param</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The base name for the feature <code>Parameter</code></p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;phi&#39;</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/feature_maps.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="k">def</span> <span class="nf">fourier_feature_map</span><span class="p">(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">support</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;phi&quot;</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">RotationTypes</span> <span class="o">=</span> <span class="n">RX</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct a Fourier feature map.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        n_qubits: number of qubits across which the FM is created</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        param: The base name for the feature `Parameter`</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="s2">&quot;Function &#39;fourier_feature_map&#39; is deprecated. Please use &#39;feature_map&#39; directly.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="ne">FutureWarning</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="n">fm</span> <span class="o">=</span> <span class="n">feature_map</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">op</span><span class="p">,</span> <span class="n">fm_type</span><span class="o">=</span><span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="k">return</span> <span class="n">fm</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.feature_maps.tower_feature_map" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">tower_feature_map</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="s1">&#39;phi&#39;</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">RX</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Construct a Chebyshev tower feature map.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_qubits</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>number of qubits across which the FM is created</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>param</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The base name for the feature <code>Parameter</code></p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;phi&#39;</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/feature_maps.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="k">def</span> <span class="nf">tower_feature_map</span><span class="p">(</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">support</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;phi&quot;</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">RotationTypes</span> <span class="o">=</span> <span class="n">RX</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct a Chebyshev tower feature map.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        n_qubits: number of qubits across which the FM is created</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        param: The base name for the feature `Parameter`</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="s2">&quot;Function &#39;tower_feature_map&#39; is deprecated. Please use feature_map directly.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="ne">FutureWarning</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="p">)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="n">fm</span> <span class="o">=</span> <span class="n">feature_map</span><span class="p">(</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">n_qubits</span><span class="p">,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="n">op</span><span class="o">=</span><span class="n">op</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="n">fm_type</span><span class="o">=</span><span class="n">BasisSet</span><span class="o">.</span><span class="n">CHEBYSHEV</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="n">reupload_scaling</span><span class="o">=</span><span class="n">ReuploadScaling</span><span class="o">.</span><span class="n">TOWER</span><span class="p">,</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="k">return</span> <span class="n">fm</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.ansatze.build_qnn" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">build_qnn</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ansatz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fm_pauli</span><span class="o">=</span><span class="n">RY</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">=</span><span class="s1">&#39;simple&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;fourier&#39;</span><span class="p">,</span> <span class="n">fm_strategy</span><span class="o">=</span><span class="s1">&#39;parallel&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Helper function to build a qadence QNN quantum circuit</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_qubits</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The number of qubits.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>n_features</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The number of input dimensions.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>depth</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The depth of the ansatz.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ansatz</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>An optional argument to pass a custom qadence ansatz.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="qadence.blocks.AbstractBlock" href="../blocks/#qadence.blocks.abstract.AbstractBlock">AbstractBlock</a>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>fm_pauli</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The type of Pauli gate for the feature map. Must be one of 'RX',
'RY', or 'RZ'.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><a class="autorefs autorefs-internal" title="qadence.operations.RY" href="../operations/#qadence.operations.RY">RY</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>spectrum</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The desired spectrum of the feature map generator. The options simple,
tower and exponential produce a spectrum with linear, quadratic and exponential
eigenvalues with respect to the number of qubits.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;simple&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>basis</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The encoding function. The options fourier and chebyshev correspond to (x)=x
and arcos(x) respectively.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;fourier&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>fm_strategy</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The feature map encoding strategy. If "parallel", the features
are encoded in one block of rotation gates, with each feature given
an equal number of qubits. If "serial", the features are encoded
sequentially, with a HEA block between.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;parallel&#39;</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>list[<a class="autorefs autorefs-internal" title="qadence.blocks.AbstractBlock" href="../blocks/#qadence.blocks.abstract.AbstractBlock">AbstractBlock</a>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>A list of Abstract blocks to be used for constructing a quantum circuit</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/ansatze.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="k">def</span> <span class="nf">build_qnn</span><span class="p">(</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="n">n_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="n">ansatz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AbstractBlock</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="n">fm_pauli</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">RY</span><span class="p">]</span> <span class="o">=</span> <span class="n">RY</span><span class="p">,</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="n">spectrum</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;simple&quot;</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="n">basis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fourier&quot;</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="n">fm_strategy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;parallel&quot;</span><span class="p">,</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">AbstractBlock</span><span class="p">]:</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper function to build a qadence QNN quantum circuit</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        n_qubits (int): The number of qubits.</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">        n_features (int): The number of input dimensions.</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        depth (int): The depth of the ansatz.</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        ansatz (Optional[AbstractBlock]):  An optional argument to pass a custom qadence ansatz.</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        fm_pauli (str): The type of Pauli gate for the feature map. Must be one of &#39;RX&#39;,</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">            &#39;RY&#39;, or &#39;RZ&#39;.</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        spectrum (str): The desired spectrum of the feature map generator. The options simple,</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">            tower and exponential produce a spectrum with linear, quadratic and exponential</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">            eigenvalues with respect to the number of qubits.</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        basis (str): The encoding function. The options fourier and chebyshev correspond to (x)=x</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">            and arcos(x) respectively.</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        fm_strategy (str): The feature map encoding strategy. If &quot;parallel&quot;, the features</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">            are encoded in one block of rotation gates, with each feature given</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">            an equal number of qubits. If &quot;serial&quot;, the features are encoded</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">            sequentially, with a HEA block between.</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        A list of Abstract blocks to be used for constructing a quantum circuit</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="n">depth</span> <span class="o">=</span> <span class="n">n_qubits</span> <span class="k">if</span> <span class="n">depth</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">depth</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>    <span class="n">idx_fms</span> <span class="o">=</span> <span class="n">build_idx_fms</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">fm_pauli</span><span class="p">,</span> <span class="n">fm_strategy</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">,</span> <span class="n">spectrum</span><span class="p">)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="k">if</span> <span class="n">fm_strategy</span> <span class="o">==</span> <span class="s2">&quot;parallel&quot;</span><span class="p">:</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="n">_fm</span> <span class="o">=</span> <span class="n">kron</span><span class="p">(</span><span class="o">*</span><span class="n">idx_fms</span><span class="p">)</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="n">fm</span> <span class="o">=</span> <span class="n">tag</span><span class="p">(</span><span class="n">_fm</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;FM&quot;</span><span class="p">)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="k">elif</span> <span class="n">fm_strategy</span> <span class="o">==</span> <span class="s2">&quot;serial&quot;</span><span class="p">:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="n">fm_components</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AbstractBlock</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">fm_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idx_fms</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="n">fm_idx</span> <span class="o">=</span> <span class="n">tag</span><span class="p">(</span><span class="n">fm_idx</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;FM</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="n">fm_component</span> <span class="o">=</span> <span class="p">(</span><span class="n">fm_idx</span><span class="p">,</span> <span class="n">hea</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;theta_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>            <span class="n">fm_components</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">fm_component</span><span class="p">)</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">fm_components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="n">idx_fms</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;FM</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_fms</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="n">fm</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">fm_components</span><span class="p">)</span>  <span class="c1"># type: ignore[assignment]</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="n">ansatz</span> <span class="o">=</span> <span class="n">hea</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="p">)</span> <span class="k">if</span> <span class="n">ansatz</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ansatz</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">fm</span><span class="p">,</span> <span class="n">ansatz</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.ansatze.hea" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">hea</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">param_prefix</span><span class="o">=</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span><span class="p">,</span> <span class="o">**</span><span class="n">strategy_args</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Factory function for the Hardware Efficient Ansatz (HEA).</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_qubits</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>number of qubits in the block</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>depth</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>number of layers of the HEA</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>param_prefix</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>the base name of the variational parameters</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;theta&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>support</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>qubit indexes where the HEA is applied</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>tuple[int, ...]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>strategy</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Strategy.Digital or Strategy.DigitalAnalog</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.types.Strategy" href="../types/#qadence.types.Strategy">Strategy</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><a class="autorefs autorefs-internal" title="qadence.types.Strategy.DIGITAL" href="../types/#qadence.types.Strategy.DIGITAL">DIGITAL</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>**strategy_args</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>see below</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.Any">Any</span></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>{}</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>operations</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>list of operations to cycle through in the
digital single-qubit rotations of each layer. Valid for
Digital and DigitalAnalog HEA.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>list</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>periodic</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>if the qubits should be linked periodically.
periodic=False is not supported in emu-c. Valid for only
for Digital HEA.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>entangler</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <ul>
<li>Digital: 2-qubit entangling operation. Supports CNOT, CZ,
CRX, CRY, CRZ, CPHASE. Controlled rotations will have variational
parameters on the rotation angles.</li>
<li>DigitaAnalog | Analog: Hamiltonian generator for the
analog entangling layer. Defaults to global ZZ Hamiltonian.
Time parameter is considered variational.</li>
</ul>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.blocks.AbstractBlock" href="../blocks/#qadence.blocks.abstract.AbstractBlock">AbstractBlock</a></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Examples:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span> <span class="nn">qadence</span> <span class="kn">import</span> <span class="n">RZ</span><span class="p">,</span> <span class="n">RX</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span> <span class="nn">qadence</span> <span class="kn">import</span> <span class="n">hea</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># create the circuit</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">n_qubits</span><span class="p">,</span> <span class="n">depth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">ansatz</span> <span class="o">=</span> <span class="n">hea</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">n_qubits</span><span class="o">=</span><span class="n">n_qubits</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;sDAQC&quot;</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">operations</span><span class="o">=</span><span class="p">[</span><span class="n">RZ</span><span class="p">,</span><span class="n">RX</span><span class="p">,</span><span class="n">RZ</span><span class="p">]</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/ansatze.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="k">def</span> <span class="nf">hea</span><span class="p">(</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">param_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;theta&quot;</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">support</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">strategy</span><span class="p">:</span> <span class="n">Strategy</span> <span class="o">=</span> <span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="o">**</span><span class="n">strategy_args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Factory function for the Hardware Efficient Ansatz (HEA).</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        n_qubits: number of qubits in the block</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        depth: number of layers of the HEA</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        param_prefix: the base name of the variational parameters</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        support: qubit indexes where the HEA is applied</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        strategy: Strategy.Digital or Strategy.DigitalAnalog</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        **strategy_args: see below</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    Keyword Arguments:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        operations (list): list of operations to cycle through in the</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">            digital single-qubit rotations of each layer. Valid for</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            Digital and DigitalAnalog HEA.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        periodic (bool): if the qubits should be linked periodically.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">            periodic=False is not supported in emu-c. Valid for only</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">            for Digital HEA.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        entangler (AbstractBlock):</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">            - Digital: 2-qubit entangling operation. Supports CNOT, CZ,</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">            CRX, CRY, CRZ, CPHASE. Controlled rotations will have variational</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">            parameters on the rotation angles.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">            - DigitaAnalog | Analog: Hamiltonian generator for the</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            analog entangling layer. Defaults to global ZZ Hamiltonian.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">            Time parameter is considered variational.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    ```python exec=&quot;on&quot; source=&quot;material-block&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    from qadence import RZ, RX</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    from qadence import hea</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    # create the circuit</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    n_qubits, depth = 2, 4</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    ansatz = hea(</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        n_qubits=n_qubits,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        depth=depth,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        strategy=&quot;sDAQC&quot;,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        operations=[RZ,RX,RZ]</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    )</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    ```</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">if</span> <span class="n">support</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">support</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">))</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">hea_func_dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span><span class="p">:</span> <span class="n">hea_digital</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="n">Strategy</span><span class="o">.</span><span class="n">SDAQC</span><span class="p">:</span> <span class="n">hea_sDAQC</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">Strategy</span><span class="o">.</span><span class="n">BDAQC</span><span class="p">:</span> <span class="n">hea_bDAQC</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">Strategy</span><span class="o">.</span><span class="n">ANALOG</span><span class="p">:</span> <span class="n">hea_analog</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="p">}</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">hea_func</span> <span class="o">=</span> <span class="n">hea_func_dict</span><span class="p">[</span><span class="n">strategy</span><span class="p">]</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Strategy </span><span class="si">{</span><span class="n">strategy</span><span class="si">}</span><span class="s2"> not recognized.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="n">hea_block</span><span class="p">:</span> <span class="n">AbstractBlock</span> <span class="o">=</span> <span class="n">hea_func</span><span class="p">(</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="n">n_qubits</span><span class="o">=</span><span class="n">n_qubits</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">param_prefix</span><span class="o">=</span><span class="n">param_prefix</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="o">**</span><span class="n">strategy_args</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">return</span> <span class="n">hea_block</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.ansatze.hea_digital" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">hea_digital</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">param_prefix</span><span class="o">=</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">periodic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="p">[</span><span class="n">RX</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">RX</span><span class="p">],</span> <span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">entangler</span><span class="o">=</span><span class="n">CNOT</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Construct the Digital Hardware Efficient Ansatz (HEA).</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_qubits</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>number of qubits in the block.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>depth</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>number of layers of the HEA.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>param_prefix</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>the base name of the variational parameters</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;theta&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>periodic</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>if the qubits should be linked periodically.
periodic=False is not supported in emu-c.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>operations</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>list of operations to cycle through in the
digital single-qubit rotations of each layer.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>list</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>[<a class="autorefs autorefs-internal" title="qadence.operations.RX" href="../operations/#qadence.operations.RX">RX</a>, <a class="autorefs autorefs-internal" title="qadence.operations.RY" href="../operations/#qadence.operations.RY">RY</a>, <a class="autorefs autorefs-internal" title="qadence.operations.RX" href="../operations/#qadence.operations.RX">RX</a>]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>support</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>qubit indexes where the HEA is applied.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>tuple</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>entangler</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>2-qubit entangling operation.
Supports CNOT, CZ, CRX, CRY, CRZ. Controlld rotations
will have variational parameters on the rotation angles.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.blocks.AbstractBlock" href="../blocks/#qadence.blocks.abstract.AbstractBlock">AbstractBlock</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><a class="autorefs autorefs-internal" title="qadence.operations.CNOT" href="../operations/#qadence.operations.CNOT">CNOT</a></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/ansatze.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="k">def</span> <span class="nf">hea_digital</span><span class="p">(</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="n">param_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;theta&quot;</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="n">periodic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="n">operations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">AbstractBlock</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">RX</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">RX</span><span class="p">],</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="n">support</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="n">entangler</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">DigitalEntanglers</span><span class="p">]</span> <span class="o">=</span> <span class="n">CNOT</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    Construct the Digital Hardware Efficient Ansatz (HEA).</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        n_qubits (int): number of qubits in the block.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        depth (int): number of layers of the HEA.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        param_prefix (str): the base name of the variational parameters</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        periodic (bool): if the qubits should be linked periodically.</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            periodic=False is not supported in emu-c.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        operations (list): list of operations to cycle through in the</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">            digital single-qubit rotations of each layer.</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        support (tuple): qubit indexes where the HEA is applied.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        entangler (AbstractBlock): 2-qubit entangling operation.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            Supports CNOT, CZ, CRX, CRY, CRZ. Controlld rotations</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            will have variational parameters on the rotation angles.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">if</span> <span class="n">entangler</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">CNOT</span><span class="p">,</span> <span class="n">CZ</span><span class="p">,</span> <span class="n">CRX</span><span class="p">,</span> <span class="n">CRY</span><span class="p">,</span> <span class="n">CRZ</span><span class="p">,</span> <span class="n">CPHASE</span><span class="p">]:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                <span class="s2">&quot;Please provide a valid two-qubit entangler operation for digital HEA.&quot;</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please provide a valid two-qubit entangler operation for digital HEA.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">rot_list</span> <span class="o">=</span> <span class="n">_rotations_digital</span><span class="p">(</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="n">n_qubits</span><span class="o">=</span><span class="n">n_qubits</span><span class="p">,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">param_prefix</span><span class="o">=</span><span class="n">param_prefix</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="n">operations</span><span class="o">=</span><span class="n">operations</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">ent_list</span> <span class="o">=</span> <span class="n">_entanglers_digital</span><span class="p">(</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">n_qubits</span><span class="o">=</span><span class="n">n_qubits</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="n">param_prefix</span><span class="o">=</span><span class="n">param_prefix</span><span class="p">,</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="n">periodic</span><span class="o">=</span><span class="n">periodic</span><span class="p">,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="n">entangler</span><span class="o">=</span><span class="n">entangler</span><span class="p">,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">depth</span><span class="p">):</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rot_list</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ent_list</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="k">return</span> <span class="n">tag</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">layers</span><span class="p">),</span> <span class="s2">&quot;HEA&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.ansatze.hea_sDAQC" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">hea_sDAQC</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">param_prefix</span><span class="o">=</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="p">[</span><span class="n">RX</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">RX</span><span class="p">],</span> <span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">entangler</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Construct the Hardware Efficient Ansatz (HEA) with analog entangling layers
using step-wise digital-analog computation.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_qubits</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>number of qubits in the block.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>depth</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>number of layers of the HEA.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>param_prefix</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>the base name of the variational parameters</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;theta&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>operations</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>list of operations to cycle through in the
digital single-qubit rotations of each layer.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>list</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>[<a class="autorefs autorefs-internal" title="qadence.operations.RX" href="../operations/#qadence.operations.RX">RX</a>, <a class="autorefs autorefs-internal" title="qadence.operations.RY" href="../operations/#qadence.operations.RY">RY</a>, <a class="autorefs autorefs-internal" title="qadence.operations.RX" href="../operations/#qadence.operations.RX">RX</a>]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>support</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>qubit indexes where the HEA is applied.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>tuple</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>entangler</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Hamiltonian generator for the
analog entangling layer. Defaults to global ZZ Hamiltonian.
Time parameter is considered variational.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.blocks.AbstractBlock" href="../blocks/#qadence.blocks.abstract.AbstractBlock">AbstractBlock</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/ansatze.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="k">def</span> <span class="nf">hea_sDAQC</span><span class="p">(</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="n">param_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;theta&quot;</span><span class="p">,</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="n">operations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">AbstractBlock</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">RX</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">RX</span><span class="p">],</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>    <span class="n">support</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="n">entangler</span><span class="p">:</span> <span class="n">AbstractBlock</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    Construct the Hardware Efficient Ansatz (HEA) with analog entangling layers</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    using step-wise digital-analog computation.</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        n_qubits (int): number of qubits in the block.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">        depth (int): number of layers of the HEA.</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        param_prefix (str): the base name of the variational parameters</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        operations (list): list of operations to cycle through in the</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">            digital single-qubit rotations of each layer.</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        support (tuple): qubit indexes where the HEA is applied.</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        entangler (AbstractBlock): Hamiltonian generator for the</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">            analog entangling layer. Defaults to global ZZ Hamiltonian.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">            Time parameter is considered variational.</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="c1"># TODO: Add qubit support</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="k">if</span> <span class="n">entangler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="n">entangler</span> <span class="o">=</span> <span class="n">hamiltonian_factory</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">interaction</span><span class="o">=</span><span class="n">Interaction</span><span class="o">.</span><span class="n">NN</span><span class="p">)</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">block_is_qubit_hamiltonian</span><span class="p">(</span><span class="n">entangler</span><span class="p">):</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                <span class="s2">&quot;Please provide a valid Pauli Hamiltonian generator for digital-analog HEA.&quot;</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>            <span class="p">)</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>            <span class="s2">&quot;Please provide a valid Pauli Hamiltonian generator for digital-analog HEA.&quot;</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="p">)</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="n">rot_list</span> <span class="o">=</span> <span class="n">_rotations_digital</span><span class="p">(</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="n">n_qubits</span><span class="o">=</span><span class="n">n_qubits</span><span class="p">,</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="n">param_prefix</span><span class="o">=</span><span class="n">param_prefix</span><span class="p">,</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="n">operations</span><span class="o">=</span><span class="n">operations</span><span class="p">,</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="p">)</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>    <span class="n">ent_list</span> <span class="o">=</span> <span class="n">_entanglers_analog</span><span class="p">(</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="p">,</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="n">param_prefix</span><span class="o">=</span><span class="n">param_prefix</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="n">entangler</span><span class="o">=</span><span class="n">entangler</span><span class="p">,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="p">)</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">depth</span><span class="p">):</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rot_list</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ent_list</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="k">return</span> <span class="n">tag</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">layers</span><span class="p">),</span> <span class="s2">&quot;HEA-sDA&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.hamiltonians.hamiltonian_factory" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">hamiltonian_factory</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="n">interaction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">detuning</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interaction_strength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">detuning_strength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_strength</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">force_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>General Hamiltonian creation function. Can be used to create Hamiltonians with 2-qubit
interactions and single-qubit detunings, both with arbitrary strength or parameterized.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>register</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>register of qubits with a specific graph topology, or number of qubits.
When passing a number of qubits a register with all-to-all connectivity
is created.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.register.Register" href="../register/#qadence.register.Register">Register</a> | int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>interaction</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Interaction.ZZ, Interaction.NN, Interaction.XY, or Interacton.XYZ.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.types.Interaction" href="../types/#qadence.types.Interaction">Interaction</a> | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>detuning</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>single-qubit operator N, X, Y, or Z.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="qadence.constructors.hamiltonians.TDetuning">TDetuning</span> | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>interaction_strength</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>list of values to be used as the interaction strength for each
pair of qubits. Should be ordered following the order of <code>Register(n_qubits).edges</code>.
Alternatively, some string "x" can be passed, which will create a parameterized
interactions for each pair of qubits, each labelled as <code>"x_ij"</code>.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.types.TArray" href="../types/#qadence.types.TArray">TArray</a> | str | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>detuning_strength</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>list of values to be used as the detuning strength for each qubit.
Alternatively, some string "x" can be passed, which will create a parameterized
detuning for each qubit, each labelled as <code>"x_i"</code>.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.types.TArray" href="../types/#qadence.types.TArray">TArray</a> | str | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>random_strength</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>set random interaction and detuning strengths between -1 and 1.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>force_update</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>force override register detuning and interaction strengths.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span> <span class="nn">qadence</span> <span class="kn">import</span> <span class="n">hamiltonian_factory</span><span class="p">,</span> <span class="n">Interaction</span><span class="p">,</span> <span class="n">Register</span><span class="p">,</span> <span class="n">Z</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># Constant total magnetization observable:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">observable</span> <span class="o">=</span> <span class="n">hamiltonian_factory</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">detuning</span> <span class="o">=</span> <span class="n">Z</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1"># Parameterized total magnetization observable:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">observable</span> <span class="o">=</span> <span class="n">hamiltonian_factory</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">detuning</span> <span class="o">=</span> <span class="n">Z</span><span class="p">,</span> <span class="n">detuning_strength</span> <span class="o">=</span> <span class="s2">&quot;z&quot;</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="c1"># Random all-to-all XY Hamiltonian generator:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">generator</span> <span class="o">=</span> <span class="n">hamiltonian_factory</span><span class="p">(</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">n_qubits</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">interaction</span> <span class="o">=</span> <span class="n">Interaction</span><span class="o">.</span><span class="n">XY</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">random_strength</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="c1"># Parameterized NN Hamiltonian generator with a square grid interaction topology:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="n">register</span> <span class="o">=</span> <span class="n">Register</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">qubits_side</span> <span class="o">=</span> <span class="n">n_qubits</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">generator</span> <span class="o">=</span> <span class="n">hamiltonian_factory</span><span class="p">(</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="n">register</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="n">interaction</span> <span class="o">=</span> <span class="n">Interaction</span><span class="o">.</span><span class="n">NN</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    <span class="n">interaction_strength</span> <span class="o">=</span> <span class="s2">&quot;theta&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    <span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/hamiltonians.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="k">def</span> <span class="nf">hamiltonian_factory</span><span class="p">(</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">register</span><span class="p">:</span> <span class="n">Register</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">interaction</span><span class="p">:</span> <span class="n">Interaction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">detuning</span><span class="p">:</span> <span class="n">TDetuning</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">interaction_strength</span><span class="p">:</span> <span class="n">TArray</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">detuning_strength</span><span class="p">:</span> <span class="n">TArray</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">random_strength</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">force_update</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    General Hamiltonian creation function. Can be used to create Hamiltonians with 2-qubit</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    interactions and single-qubit detunings, both with arbitrary strength or parameterized.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        register: register of qubits with a specific graph topology, or number of qubits.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            When passing a number of qubits a register with all-to-all connectivity</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">            is created.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        interaction: Interaction.ZZ, Interaction.NN, Interaction.XY, or Interacton.XYZ.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        detuning: single-qubit operator N, X, Y, or Z.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        interaction_strength: list of values to be used as the interaction strength for each</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">            pair of qubits. Should be ordered following the order of `Register(n_qubits).edges`.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            Alternatively, some string &quot;x&quot; can be passed, which will create a parameterized</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            interactions for each pair of qubits, each labelled as `&quot;x_ij&quot;`.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        detuning_strength: list of values to be used as the detuning strength for each qubit.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            Alternatively, some string &quot;x&quot; can be passed, which will create a parameterized</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">            detuning for each qubit, each labelled as `&quot;x_i&quot;`.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        random_strength: set random interaction and detuning strengths between -1 and 1.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        force_update: force override register detuning and interaction strengths.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        ```python exec=&quot;on&quot; source=&quot;material-block&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        from qadence import hamiltonian_factory, Interaction, Register, Z</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        n_qubits = 3</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        # Constant total magnetization observable:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        observable = hamiltonian_factory(n_qubits, detuning = Z)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        # Parameterized total magnetization observable:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        observable = hamiltonian_factory(n_qubits, detuning = Z, detuning_strength = &quot;z&quot;)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        # Random all-to-all XY Hamiltonian generator:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        generator = hamiltonian_factory(</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            n_qubits,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            interaction = Interaction.XY,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            random_strength = True,</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            )</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        # Parameterized NN Hamiltonian generator with a square grid interaction topology:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        register = Register.square(qubits_side = n_qubits)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        generator = hamiltonian_factory(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">            register,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            interaction = Interaction.NN,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            interaction_strength = &quot;theta&quot;</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            )</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        ```</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="k">if</span> <span class="n">interaction</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">detuning</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please provide an interaction and/or detuning for the Hamiltonian.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="c1"># If number of qubits is given, creates all-to-all register</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">register</span> <span class="o">=</span> <span class="n">Register</span><span class="p">(</span><span class="n">register</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="n">register</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="c1"># Get interaction function</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">int_fn</span> <span class="o">=</span> <span class="n">INTERACTION_DICT</span><span class="p">[</span><span class="n">interaction</span><span class="p">]</span>  <span class="c1"># type: ignore [index]</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="k">if</span> <span class="n">interaction</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="k">pass</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Interaction </span><span class="si">{</span><span class="n">interaction</span><span class="si">}</span><span class="s2"> not supported.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="c1"># Check single-qubit detuning</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">detuning</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">detuning</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">DETUNINGS</span><span class="p">):</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detuning of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">detuning</span><span class="p">)</span><span class="si">}</span><span class="s2"> not supported.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="c1"># Pre-process detuning and interaction strengths and update register</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">has_detuning_strength</span><span class="p">,</span> <span class="n">detuning_strength</span> <span class="o">=</span> <span class="n">_preprocess_strengths</span><span class="p">(</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">register</span><span class="p">,</span> <span class="n">detuning_strength</span><span class="p">,</span> <span class="s2">&quot;nodes&quot;</span><span class="p">,</span> <span class="n">force_update</span><span class="p">,</span> <span class="n">random_strength</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">has_interaction_strength</span><span class="p">,</span> <span class="n">interaction_strength</span> <span class="o">=</span> <span class="n">_preprocess_strengths</span><span class="p">(</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">register</span><span class="p">,</span> <span class="n">interaction_strength</span><span class="p">,</span> <span class="s2">&quot;edges&quot;</span><span class="p">,</span> <span class="n">force_update</span><span class="p">,</span> <span class="n">random_strength</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">has_detuning_strength</span><span class="p">)</span> <span class="ow">or</span> <span class="n">force_update</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">register</span> <span class="o">=</span> <span class="n">_update_detuning_strength</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="n">detuning_strength</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">has_interaction_strength</span><span class="p">)</span> <span class="ow">or</span> <span class="n">force_update</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">register</span> <span class="o">=</span> <span class="n">_update_interaction_strength</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="n">interaction_strength</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="c1"># Create single-qubit detunings:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">single_qubit_terms</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AbstractBlock</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="k">if</span> <span class="n">detuning</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">register</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="n">block_sq</span> <span class="o">=</span> <span class="n">detuning</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>  <span class="c1"># type: ignore [operator]</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>            <span class="n">strength_sq</span> <span class="o">=</span> <span class="n">register</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;strength&quot;</span><span class="p">]</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>            <span class="n">single_qubit_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">strength_sq</span> <span class="o">*</span> <span class="n">block_sq</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="c1"># Create two-qubit interactions:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="n">two_qubit_terms</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">AbstractBlock</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="k">if</span> <span class="n">interaction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">register</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="n">block_tq</span> <span class="o">=</span> <span class="n">int_fn</span><span class="p">(</span><span class="o">*</span><span class="n">edge</span><span class="p">)</span>  <span class="c1"># type: ignore [operator]</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="n">strength_tq</span> <span class="o">=</span> <span class="n">register</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">edge</span><span class="p">][</span><span class="s2">&quot;strength&quot;</span><span class="p">]</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="n">two_qubit_terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">strength_tq</span> <span class="o">*</span> <span class="n">block_tq</span><span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="k">return</span> <span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">single_qubit_terms</span><span class="p">,</span> <span class="o">*</span><span class="n">two_qubit_terms</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.hamiltonians.interaction_nn" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">interaction_nn</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Ising NN interaction.</p>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/hamiltonians.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="k">def</span> <span class="nf">interaction_nn</span><span class="p">(</span><span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Ising NN interaction.&quot;&quot;&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="k">return</span> <span class="n">N</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">@</span> <span class="n">N</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.hamiltonians.interaction_xy" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">interaction_xy</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>XY interaction.</p>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/hamiltonians.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="k">def</span> <span class="nf">interaction_xy</span><span class="p">(</span><span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;XY interaction.&quot;&quot;&quot;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="k">return</span> <span class="n">X</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">@</span> <span class="n">X</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">Y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">@</span> <span class="n">Y</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.hamiltonians.interaction_xyz" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">interaction_xyz</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Heisenberg XYZ interaction.</p>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/hamiltonians.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="k">def</span> <span class="nf">interaction_xyz</span><span class="p">(</span><span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Heisenberg XYZ interaction.&quot;&quot;&quot;</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="k">return</span> <span class="n">X</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">@</span> <span class="n">X</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">Y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">@</span> <span class="n">Y</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">Z</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">@</span> <span class="n">Z</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.hamiltonians.interaction_zz" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">interaction_zz</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Ising ZZ interaction.</p>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/hamiltonians.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="k">def</span> <span class="nf">interaction_zz</span><span class="p">(</span><span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Ising ZZ interaction.&quot;&quot;&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="k">return</span> <span class="n">Z</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">@</span> <span class="n">Z</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.qft.qft" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">qft</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reverse_in</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">swaps_out</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span><span class="p">,</span> <span class="n">gen_build</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The Quantum Fourier Transform</p>
<p>Depending on the application, user should be careful with qubit ordering
in the input and output. This can be controlled with reverse_in and swaps_out
arguments.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_qubits</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>number of qubits in the QFT</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>support</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>qubit support to use</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>tuple[int, ...]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>inverse</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>True performs the inverse QFT</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>reverse_in</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Reverses the input qubits to account for endianness</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>swaps_out</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Performs swaps on the output qubits to match the "textbook" QFT.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>strategy</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Strategy.Digital or Strategy.sDAQC</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.types.Strategy" href="../types/#qadence.types.Strategy">Strategy</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><a class="autorefs autorefs-internal" title="qadence.types.Strategy.DIGITAL" href="../types/#qadence.types.Strategy.DIGITAL">DIGITAL</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>gen_build</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>building block Ising Hamiltonian for the DAQC transform.
Defaults to constant all-to-all Ising.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.blocks.AbstractBlock" href="../blocks/#qadence.blocks.abstract.AbstractBlock">AbstractBlock</a> | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span> <span class="nn">qadence</span> <span class="kn">import</span> <span class="n">qft</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">qft_circuit</span> <span class="o">=</span> <span class="n">qft</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">strategy</span> <span class="o">=</span> <span class="s2">&quot;sDAQC&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/qft.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">def</span> <span class="nf">qft</span><span class="p">(</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">support</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">inverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">reverse_in</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">swaps_out</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">strategy</span><span class="p">:</span> <span class="n">Strategy</span> <span class="o">=</span> <span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">gen_build</span><span class="p">:</span> <span class="n">AbstractBlock</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    The Quantum Fourier Transform</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Depending on the application, user should be careful with qubit ordering</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    in the input and output. This can be controlled with reverse_in and swaps_out</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    arguments.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        n_qubits: number of qubits in the QFT</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        support: qubit support to use</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        inverse: True performs the inverse QFT</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        reverse_in: Reverses the input qubits to account for endianness</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        swaps_out: Performs swaps on the output qubits to match the &quot;textbook&quot; QFT.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        strategy: Strategy.Digital or Strategy.sDAQC</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        gen_build: building block Ising Hamiltonian for the DAQC transform.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            Defaults to constant all-to-all Ising.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        ```python exec=&quot;on&quot; source=&quot;material-block&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        from qadence import qft</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        n_qubits = 3</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        qft_circuit = qft(n_qubits, strategy = &quot;sDAQC&quot;)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        ```</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="k">if</span> <span class="n">support</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="n">support</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">))</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">support</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">n_qubits</span><span class="p">,</span> <span class="s2">&quot;Wrong qubit support supplied&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="k">if</span> <span class="n">reverse_in</span><span class="p">:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="n">support</span> <span class="o">=</span> <span class="n">support</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">qft_layer_dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span><span class="p">:</span> <span class="n">_qft_layer_digital</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="n">Strategy</span><span class="o">.</span><span class="n">SDAQC</span><span class="p">:</span> <span class="n">_qft_layer_sDAQC</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">Strategy</span><span class="o">.</span><span class="n">BDAQC</span><span class="p">:</span> <span class="n">_qft_layer_bDAQC</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="n">Strategy</span><span class="o">.</span><span class="n">ANALOG</span><span class="p">:</span> <span class="n">_qft_layer_analog</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="p">}</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">layer_func</span> <span class="o">=</span> <span class="n">qft_layer_dict</span><span class="p">[</span><span class="n">strategy</span><span class="p">]</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Strategy </span><span class="si">{</span><span class="n">strategy</span><span class="si">}</span><span class="s2"> not recognized.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">qft_layers</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">))</span> <span class="k">if</span> <span class="n">inverse</span> <span class="k">else</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">qft_circ</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">layer_func</span><span class="p">(</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="n">n_qubits</span><span class="o">=</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="n">support</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="n">inverse</span><span class="p">,</span> <span class="n">gen_build</span><span class="o">=</span><span class="n">gen_build</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">qft_layers</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">if</span> <span class="n">swaps_out</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="n">swap_ops</span> <span class="o">=</span> <span class="p">[</span><span class="n">SWAP</span><span class="p">(</span><span class="n">support</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">support</span><span class="p">[</span><span class="n">n_qubits</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_qubits</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)]</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">qft_circ</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">swap_ops</span><span class="p">,</span> <span class="n">qft_circ</span><span class="p">)</span> <span class="k">if</span> <span class="n">inverse</span> <span class="k">else</span> <span class="n">chain</span><span class="p">(</span><span class="n">qft_circ</span><span class="p">,</span> <span class="o">*</span><span class="n">swap_ops</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="k">return</span> <span class="n">tag</span><span class="p">(</span><span class="n">qft_circ</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;iQFT&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">inverse</span> <span class="k">else</span> <span class="n">tag</span><span class="p">(</span><span class="n">qft_circ</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;QFT&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="the-daqc-transform">The DAQC Transform</h2>


<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.daqc.daqc.daqc_transform" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">daqc_transform</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">gen_target</span><span class="p">,</span> <span class="n">t_f</span><span class="p">,</span> <span class="n">gen_build</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">zero_tol</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="n">Strategy</span><span class="o">.</span><span class="n">SDAQC</span><span class="p">,</span> <span class="n">ignore_global_phases</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Implements the DAQC transform for representing an arbitrary 2-body Hamiltonian
with another fixed 2-body Hamiltonian.</p>
<p>Reference for universality of 2-body Hamiltonians:</p>
<p>-- https://arxiv.org/abs/quant-ph/0106064</p>
<p>Based on the transformation for Ising (ZZ) interactions, as described in the paper</p>
<p>-- https://arxiv.org/abs/1812.03637</p>
<p>The transform translates a target weighted generator of the type:</p>
<div class="highlight"><pre><span></span><code>`gen_target = add(g_jk * kron(op(j), op(k)) for j &lt; k)`
</code></pre></div>
<p>To a circuit using analog evolutions with a fixed building block generator:</p>
<div class="highlight"><pre><span></span><code>`gen_build = add(f_jk * kron(op(j), op(k)) for j &lt; k)`
</code></pre></div>
<p>where <code>op = Z</code> or <code>op = N</code>.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>n_qubits</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>total number of qubits to use.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>gen_target</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>target generator built with the structure above. The type
of the generator will be automatically evaluated when parsing.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.blocks.AbstractBlock" href="../blocks/#qadence.blocks.abstract.AbstractBlock">AbstractBlock</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>t_f</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>total time for the gen_target evolution.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>float</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>gen_build</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>fixed generator to act as a building block. Defaults to
constant NN: add(1.0 * kron(N(j), N(k)) for j &lt; k). The type
of the generator will be automatically evaluated when parsing.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.blocks.AbstractBlock" href="../blocks/#qadence.blocks.abstract.AbstractBlock">AbstractBlock</a> | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>zero_tol</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>default "zero" for a missing interaction. Included for
numerical reasons, see notes below.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>float</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1e-08</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>strategy</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>sDAQC or bDAQC, following definitions in the reference paper.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="qadence.types.Strategy" href="../types/#qadence.types.Strategy">Strategy</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><a class="autorefs autorefs-internal" title="qadence.types.Strategy.SDAQC" href="../types/#qadence.types.Strategy.SDAQC">SDAQC</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ignore_global_phases</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>if <code>True</code> the transform does not correct the global
phases coming from the mapping between ZZ and NN interactions.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Notes:</p>
<div class="highlight"><pre><span></span><code>The paper follows an index convention of running from 1 to N. A few functions
here also use that convention to be consistent with the paper. However, for qadence
related things the indices are converted to [0, N-1].

The case for `n_qubits = 4` is an edge case where the sign matrix is not invertible.
There is a workaround for this described in the paper, but it is currently not implemented.

The current implementation may result in evolution times that are both positive or
negative. In practice, both can be represented by simply changing the signs of the
interactions. However, for a real implementation where the interactions should remain
fixed, the paper discusses a workaround that is not currently implemented.

The transformation works by representing each interaction in the target hamiltonian by
a set of evolutions using the build hamiltonian. As a consequence, some care must be
taken when choosing the build hamiltonian. Some cases:

- The target hamiltonian can have any interaction, as long as it is sufficiently
represented in the build hamiltonian. E.g., if the interaction `g_01 * kron(Z(0), Z(1))`
is in the target hamiltonian, the corresponding interaction `f_01 * kron(Z(0), Z(1))`
needs to be in the build hamiltonian. This is checked when the generators are parsed.

- The build hamiltonian can have any interaction, irrespectively of it being needed
for the target hamiltonian. This is especially useful for designing local operations
through the repeated evolution of a &quot;global&quot; hamiltonian.

- The parameter `zero_tol` controls what it means for an interaction to be &quot;missing&quot;.
Any interaction strength smaller than `zero_tol` in the build hamiltonian will not be
considered, and thus that interaction is missing.

- The various ratios `g_jk / f_jk` will influence the time parameter for the various
evolution slices, meaning that if there is a big discrepancy in the interaction strength
for a given qubit pair (j, k), the output circuit may require the usage of hamiltonian
evolutions with very large times.

- A warning will be issued for evolution times larger than `1/sqrt(zero_tol)`. Evolution
times smaller than `zero_tol` will not be represented.
</code></pre></div>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span> <span class="nn">qadence</span> <span class="kn">import</span> <span class="n">Z</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">daqc_transform</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">gen_build</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="nd">@N</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="nd">@N</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="nd">@N</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">gen_target</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="nd">@Z</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">t_f</span> <span class="o">=</span> <span class="mf">2.0</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">transformed_circuit</span> <span class="o">=</span> <span class="n">daqc_transform</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">n_qubits</span> <span class="o">=</span> <span class="n">n_qubits</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">gen_target</span> <span class="o">=</span> <span class="n">gen_target</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">t_f</span> <span class="o">=</span> <span class="n">t_f</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">gen_build</span> <span class="o">=</span> <span class="n">gen_build</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/daqc/daqc.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="k">def</span> <span class="nf">daqc_transform</span><span class="p">(</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">gen_target</span><span class="p">:</span> <span class="n">AbstractBlock</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">t_f</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">gen_build</span><span class="p">:</span> <span class="n">AbstractBlock</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">zero_tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-08</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">strategy</span><span class="p">:</span> <span class="n">Strategy</span> <span class="o">=</span> <span class="n">Strategy</span><span class="o">.</span><span class="n">SDAQC</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="n">ignore_global_phases</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AbstractBlock</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Implements the DAQC transform for representing an arbitrary 2-body Hamiltonian</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    with another fixed 2-body Hamiltonian.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    Reference for universality of 2-body Hamiltonians:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    -- https://arxiv.org/abs/quant-ph/0106064</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    Based on the transformation for Ising (ZZ) interactions, as described in the paper</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    -- https://arxiv.org/abs/1812.03637</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    The transform translates a target weighted generator of the type:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        `gen_target = add(g_jk * kron(op(j), op(k)) for j &lt; k)`</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    To a circuit using analog evolutions with a fixed building block generator:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        `gen_build = add(f_jk * kron(op(j), op(k)) for j &lt; k)`</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    where `op = Z` or `op = N`.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        n_qubits: total number of qubits to use.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        gen_target: target generator built with the structure above. The type</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">            of the generator will be automatically evaluated when parsing.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        t_f (float): total time for the gen_target evolution.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        gen_build: fixed generator to act as a building block. Defaults to</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">            constant NN: add(1.0 * kron(N(j), N(k)) for j &lt; k). The type</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            of the generator will be automatically evaluated when parsing.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        zero_tol: default &quot;zero&quot; for a missing interaction. Included for</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">            numerical reasons, see notes below.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        strategy: sDAQC or bDAQC, following definitions in the reference paper.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        ignore_global_phases: if `True` the transform does not correct the global</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">            phases coming from the mapping between ZZ and NN interactions.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        The paper follows an index convention of running from 1 to N. A few functions</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        here also use that convention to be consistent with the paper. However, for qadence</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        related things the indices are converted to [0, N-1].</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        The case for `n_qubits = 4` is an edge case where the sign matrix is not invertible.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        There is a workaround for this described in the paper, but it is currently not implemented.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        The current implementation may result in evolution times that are both positive or</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        negative. In practice, both can be represented by simply changing the signs of the</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        interactions. However, for a real implementation where the interactions should remain</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        fixed, the paper discusses a workaround that is not currently implemented.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        The transformation works by representing each interaction in the target hamiltonian by</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        a set of evolutions using the build hamiltonian. As a consequence, some care must be</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        taken when choosing the build hamiltonian. Some cases:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        - The target hamiltonian can have any interaction, as long as it is sufficiently</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        represented in the build hamiltonian. E.g., if the interaction `g_01 * kron(Z(0), Z(1))`</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        is in the target hamiltonian, the corresponding interaction `f_01 * kron(Z(0), Z(1))`</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        needs to be in the build hamiltonian. This is checked when the generators are parsed.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        - The build hamiltonian can have any interaction, irrespectively of it being needed</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        for the target hamiltonian. This is especially useful for designing local operations</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        through the repeated evolution of a &quot;global&quot; hamiltonian.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        - The parameter `zero_tol` controls what it means for an interaction to be &quot;missing&quot;.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        Any interaction strength smaller than `zero_tol` in the build hamiltonian will not be</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        considered, and thus that interaction is missing.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        - The various ratios `g_jk / f_jk` will influence the time parameter for the various</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        evolution slices, meaning that if there is a big discrepancy in the interaction strength</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        for a given qubit pair (j, k), the output circuit may require the usage of hamiltonian</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        evolutions with very large times.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        - A warning will be issued for evolution times larger than `1/sqrt(zero_tol)`. Evolution</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        times smaller than `zero_tol` will not be represented.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        ```python exec=&quot;on&quot; source=&quot;material-block&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        from qadence import Z, N, daqc_transform</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        n_qubits = 3</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        gen_build = 0.5 * (N(0)@N(1)) + 0.7 * (N(1)@N(2)) + 0.2 * (N(0)@N(2))</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        gen_target = 0.1 * (Z(1)@Z(2))</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        t_f = 2.0</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        transformed_circuit = daqc_transform(</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            n_qubits = n_qubits,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">            gen_target = gen_target,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">            t_f = t_f,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">            gen_build = gen_build,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        )</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">        ```</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="c1">##################</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="c1"># Input controls #</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="c1">##################</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">if</span> <span class="n">strategy</span> <span class="o">!=</span> <span class="n">Strategy</span><span class="o">.</span><span class="n">SDAQC</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Currently only the sDAQC transform is implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">if</span> <span class="n">n_qubits</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;DAQC transform 4-qubit edge case not implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">if</span> <span class="n">gen_build</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">gen_build</span> <span class="o">=</span> <span class="n">hamiltonian_factory</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">interaction</span><span class="o">=</span><span class="n">Interaction</span><span class="o">.</span><span class="n">NN</span><span class="p">)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">block_is_qubit_hamiltonian</span><span class="p">(</span><span class="n">gen_target</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="ow">not</span> <span class="n">block_is_qubit_hamiltonian</span><span class="p">(</span><span class="n">gen_build</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="p">):</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                <span class="s2">&quot;Generator block is not a qubit Hamiltonian. Only ZZ or NN interactions allowed.&quot;</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="p">)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="c1"># Happens when block_is_qubit_hamiltonian is called on something that is not a block.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>            <span class="s2">&quot;Generator block is not a qubit Hamiltonian. Only ZZ or NN interactions allowed.&quot;</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="c1">#####################</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="c1"># Generator parsing #</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="c1">#####################</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="n">g_jk_target</span><span class="p">,</span> <span class="n">mat_jk_target</span><span class="p">,</span> <span class="n">target_type</span> <span class="o">=</span> <span class="n">_parse_generator</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">gen_target</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="n">g_jk_build</span><span class="p">,</span> <span class="n">mat_jk_build</span><span class="p">,</span> <span class="n">build_type</span> <span class="o">=</span> <span class="n">_parse_generator</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">gen_build</span><span class="p">,</span> <span class="n">zero_tol</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="c1"># Get the global phase hamiltonian and single-qubit detuning hamiltonian</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="k">if</span> <span class="n">build_type</span> <span class="o">==</span> <span class="n">GenDAQC</span><span class="o">.</span><span class="n">NN</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="n">h_phase_build</span><span class="p">,</span> <span class="n">h_sq_build</span> <span class="o">=</span> <span class="n">_nn_phase_and_detunings</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">mat_jk_build</span><span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="k">if</span> <span class="n">target_type</span> <span class="o">==</span> <span class="n">GenDAQC</span><span class="o">.</span><span class="n">NN</span><span class="p">:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">h_phase_target</span><span class="p">,</span> <span class="n">h_sq_target</span> <span class="o">=</span> <span class="n">_nn_phase_and_detunings</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">mat_jk_target</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="c1"># Time re-scalings</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">if</span> <span class="n">build_type</span> <span class="o">==</span> <span class="n">GenDAQC</span><span class="o">.</span><span class="n">ZZ</span> <span class="ow">and</span> <span class="n">target_type</span> <span class="o">==</span> <span class="n">GenDAQC</span><span class="o">.</span><span class="n">NN</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="n">t_star</span> <span class="o">=</span> <span class="n">t_f</span> <span class="o">/</span> <span class="mf">4.0</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="k">elif</span> <span class="n">build_type</span> <span class="o">==</span> <span class="n">GenDAQC</span><span class="o">.</span><span class="n">NN</span> <span class="ow">and</span> <span class="n">target_type</span> <span class="o">==</span> <span class="n">GenDAQC</span><span class="o">.</span><span class="n">ZZ</span><span class="p">:</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">t_star</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">t_f</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">t_star</span> <span class="o">=</span> <span class="n">t_f</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="c1"># Check if target Hamiltonian can be mapped with the build Hamiltonian</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">assert</span> <span class="n">_check_compatibility</span><span class="p">(</span><span class="n">g_jk_target</span><span class="p">,</span> <span class="n">g_jk_build</span><span class="p">,</span> <span class="n">zero_tol</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="c1">##################</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="c1"># DAQC Transform #</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="c1">##################</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="c1"># Section III A of https://arxiv.org/abs/1812.03637:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="c1"># Matrix M for the linear system, exemplified in Table I:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">matrix_M</span> <span class="o">=</span> <span class="n">_build_matrix_M</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="c1"># Linear system mapping interaction ratios -&gt; evolution times.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="n">t_slices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">matrix_M</span><span class="p">,</span> <span class="n">g_jk_target</span> <span class="o">/</span> <span class="n">g_jk_build</span><span class="p">)</span> <span class="o">*</span> <span class="n">t_star</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="c1"># ZZ-DAQC with ZZ or NN build Hamiltonian</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="n">daqc_slices</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="n">alpha</span> <span class="o">=</span> <span class="n">_ix_map</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="n">t</span> <span class="o">=</span> <span class="n">t_slices</span><span class="p">[</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">zero_tol</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">zero_tol</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)):</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="w">                        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">Transformed circuit with very long evolution time.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">Make sure your target interactions are sufficiently</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">represented in the build Hamiltonian.&quot;&quot;&quot;</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                    <span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                <span class="n">x_gates</span> <span class="o">=</span> <span class="n">kron</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">X</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                <span class="n">analog_evo</span> <span class="o">=</span> <span class="n">HamEvo</span><span class="p">(</span><span class="n">gen_build</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                <span class="c1"># TODO: Fix repeated X-gates</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                <span class="k">if</span> <span class="n">build_type</span> <span class="o">==</span> <span class="n">GenDAQC</span><span class="o">.</span><span class="n">NN</span><span class="p">:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                    <span class="c1"># Local detuning at each DAQC layer for NN build Hamiltonian</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                    <span class="n">sq_detuning_build</span> <span class="o">=</span> <span class="n">HamEvo</span><span class="p">(</span><span class="n">h_sq_build</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                    <span class="n">daqc_slices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="n">x_gates</span><span class="p">,</span> <span class="n">sq_detuning_build</span><span class="p">,</span> <span class="n">analog_evo</span><span class="p">,</span> <span class="n">x_gates</span><span class="p">))</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                <span class="k">elif</span> <span class="n">build_type</span> <span class="o">==</span> <span class="n">GenDAQC</span><span class="o">.</span><span class="n">ZZ</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                    <span class="n">daqc_slices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="n">x_gates</span><span class="p">,</span> <span class="n">analog_evo</span><span class="p">,</span> <span class="n">x_gates</span><span class="p">))</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="n">daqc_circuit</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">daqc_slices</span><span class="p">)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="c1">########################</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="c1"># Phases and Detunings #</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="c1">########################</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="k">if</span> <span class="n">target_type</span> <span class="o">==</span> <span class="n">GenDAQC</span><span class="o">.</span><span class="n">NN</span><span class="p">:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="c1"># Local detuning given a NN target Hamiltonian</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">sq_detuning_target</span> <span class="o">=</span> <span class="n">HamEvo</span><span class="p">(</span><span class="n">h_sq_target</span><span class="p">,</span> <span class="n">t_f</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">daqc_circuit</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="n">sq_detuning_target</span><span class="p">,</span> <span class="n">daqc_circuit</span><span class="p">)</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_global_phases</span><span class="p">:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="k">if</span> <span class="n">build_type</span> <span class="o">==</span> <span class="n">GenDAQC</span><span class="o">.</span><span class="n">NN</span><span class="p">:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="c1"># Constant global phase given a NN build Hamiltonian</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="n">global_phase_build</span> <span class="o">=</span> <span class="n">HamEvo</span><span class="p">(</span><span class="n">h_phase_build</span><span class="p">,</span> <span class="n">t_slices</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="n">daqc_circuit</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="n">global_phase_build</span><span class="p">,</span> <span class="n">daqc_circuit</span><span class="p">)</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="k">if</span> <span class="n">target_type</span> <span class="o">==</span> <span class="n">GenDAQC</span><span class="o">.</span><span class="n">NN</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="c1"># Constant global phase and given a NN target Hamiltonian</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="n">global_phase_target</span> <span class="o">=</span> <span class="n">HamEvo</span><span class="p">(</span><span class="n">h_phase_target</span><span class="p">,</span> <span class="n">t_f</span><span class="p">)</span><span class="o">.</span><span class="n">dagger</span><span class="p">()</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="n">daqc_circuit</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="n">global_phase_target</span><span class="p">,</span> <span class="n">daqc_circuit</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="k">return</span> <span class="n">daqc_circuit</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="some-utility-functions">Some utility functions</h2>


<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.utils.build_idx_fms" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">build_idx_fms</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">fm_pauli</span><span class="p">,</span> <span class="n">fm_strategy</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">,</span> <span class="n">spectrum</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Builds the index feature maps based on the given parameters.</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>basis</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Type of basis chosen for the feature map.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>fm_pauli</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The chosen Pauli rotation type.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>PrimitiveBlock type</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>fm_strategy</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The feature map strategy to be used. Possible values are
'parallel' or 'serial'.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>n_features</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The number of features.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>n_qubits</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The number of qubits.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>spectrum</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The chosen spectrum.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>list[<a class="autorefs autorefs-internal" title="qadence.blocks.KronBlock" href="../blocks/#qadence.blocks.composite.KronBlock">KronBlock</a>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>List[KronBlock]: The list of index feature maps.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="k">def</span> <span class="nf">build_idx_fms</span><span class="p">(</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">basis</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">fm_pauli</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">RY</span><span class="p">],</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">fm_strategy</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">n_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">spectrum</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">KronBlock</span><span class="p">]:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Builds the index feature maps based on the given parameters.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        basis (str): Type of basis chosen for the feature map.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        fm_pauli (PrimitiveBlock type): The chosen Pauli rotation type.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        fm_strategy (str): The feature map strategy to be used. Possible values are</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">            &#39;parallel&#39; or &#39;serial&#39;.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        n_features (int): The number of features.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        n_qubits (int): The number of qubits.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        spectrum (str): The chosen spectrum.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        List[KronBlock]: The list of index feature maps.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">idx_fms</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">):</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">target_qubits</span> <span class="o">=</span> <span class="n">get_fm_qubits</span><span class="p">(</span><span class="n">fm_strategy</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="n">param</span> <span class="o">=</span> <span class="n">FeatureParameter</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">block</span> <span class="o">=</span> <span class="n">kron</span><span class="p">(</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="o">*</span><span class="p">[</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>                <span class="n">fm_pauli</span><span class="p">(</span><span class="n">qubit</span><span class="p">,</span> <span class="n">generator_prefactor</span><span class="p">(</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">*</span> <span class="n">basis_func</span><span class="p">(</span><span class="n">basis</span><span class="p">,</span> <span class="n">param</span><span class="p">))</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">target_qubits</span><span class="p">)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>            <span class="p">]</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">idx_fm</span> <span class="o">=</span> <span class="n">block</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">idx_fms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx_fm</span><span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="k">return</span> <span class="n">idx_fms</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.utils.generator_prefactor" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generator_prefactor</span><span class="p">(</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">qubit_index</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Converts a spectrum string (e.g., tower or exponential) to the correct generator prefactor.</p>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="k">def</span> <span class="nf">generator_prefactor</span><span class="p">(</span><span class="n">spectrum</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">qubit_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    Converts a spectrum string (e.g., tower or exponential) to the correct generator prefactor.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">conversion_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>        <span class="s2">&quot;simple&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="s2">&quot;tower&quot;</span><span class="p">:</span> <span class="n">qubit_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="s2">&quot;exponential&quot;</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">qubit_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)),</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="p">}</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="k">return</span> <span class="n">conversion_dict</span><span class="p">[</span><span class="n">spectrum</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="qadence.constructors.utils.get_fm_qubits" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_fm_qubits</span><span class="p">(</span><span class="n">fm_strategy</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the list of target qubits for the given feature map strategy and feature index</p>



  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b> DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>fm_strategy</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The feature map strategy to be used. Possible values
are 'parallel' or 'serial'.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>i</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The feature index.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>n_qubits</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The number of qubits.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>n_features</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The number of features.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><span title="typing.Iterable">Iterable</span></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>List[int]: The list of target qubits.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code>ValueError</code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>If the feature map strategy is not implemented.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>qadence/constructors/utils.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="k">def</span> <span class="nf">get_fm_qubits</span><span class="p">(</span><span class="n">fm_strategy</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the list of target qubits for the given feature map strategy and feature index</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        fm_strategy (str): The feature map strategy to be used. Possible values</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            are &#39;parallel&#39; or &#39;serial&#39;.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        i (int): The feature index.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        n_qubits (int): The number of qubits.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        n_features (int): The number of features.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        List[int]: The list of target qubits.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        ValueError: If the feature map strategy is not implemented.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="k">if</span> <span class="n">fm_strategy</span> <span class="o">==</span> <span class="s2">&quot;parallel&quot;</span><span class="p">:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="n">n_qubits_per_feature</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_qubits</span> <span class="o">/</span> <span class="n">n_features</span><span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="n">target_qubits</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">n_qubits_per_feature</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">n_qubits_per_feature</span><span class="p">)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="k">elif</span> <span class="n">fm_strategy</span> <span class="o">==</span> <span class="s2">&quot;serial&quot;</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">target_qubits</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Feature map strategy </span><span class="si">{</span><span class="n">fm_strategy</span><span class="si">}</span><span class="s2"> not implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="k">return</span> <span class="n">target_qubits</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.action.view", "content.action.edit", "navigation.tabs", "navigation.indexes", "navigation.sections", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>