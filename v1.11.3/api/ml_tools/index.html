
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://pasqal-io.github.io/qadence/v1.11.3/api/ml_tools/">
      
      
        <link rel="prev" href="../models/">
      
      
        <link rel="next" href="../serialization/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.13">
    
    
      
        <title>QML tools - Qadence</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extras/css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extras/css/colors.css">
    
      <link rel="stylesheet" href="../../extras/css/home.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ml-tools" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Qadence" class="md-header__button md-logo" aria-label="Qadence" data-md-component="logo">
      
  <img src="../../extras/assets/logo/qadence_logo_small_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Qadence
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              QML tools
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/pasqal-io/qadence/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    qadence
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting_started/installation/" class="md-tabs__link">
          
  
  
    
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../content/block_system/" class="md-tabs__link">
          
  
  
    
  
  Contents

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../tutorials/" class="md-tabs__link">
        
  
  
    
  
  Tutorials

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../blocks/" class="md-tabs__link">
          
  
  
    
  
  API

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://github.com/pasqal-io/qadence/discussions" class="md-tabs__link">
        
  
  
    
  
  Contact

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Qadence" class="md-nav__button md-logo" aria-label="Qadence" data-md-component="logo">
      
  <img src="../../extras/assets/logo/qadence_logo_small_white.svg" alt="logo">

    </a>
    Qadence
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pasqal-io/qadence/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    qadence
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development & Info
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Development & Info
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/CODE_OF_CONDUCT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of conduct
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/LICENSE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Contents
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Contents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/block_system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block system
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/parameters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parametric programs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/quantummodels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantum models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/register/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantum registers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/state_init/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    State initialization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/noisy_simulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Noisy Simulation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/hamiltonians/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Arbitrary Hamiltonians
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/time_dependent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Time-dependent generators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/qml_constructors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    QML Constructors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/overlap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wavefunction overlaps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/backends/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Backends
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_12" >
        
          
          <label class="md-nav__link" for="__nav_3_12" id="__nav_3_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Useful info
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_12">
            <span class="md-nav__icon md-icon"></span>
            Useful info
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/state_conventions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    State conventions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/serializ_and_prep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Serialization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/digital_analog_qc/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Digital-analog quantum computing
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Digital-analog quantum computing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/analog-basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic operations on neutral-atoms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/analog-blocks-qcl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fitting a function with analog blocks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/semi-local-addressing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Restricted local addressability
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/pulser-basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pulse-level programming with Pulser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/digital-analog-qcl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fitting a function with a Hamiltonian ansatz
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/analog-qubo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solve a QUBO problem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/daqc-cnot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CNOT with interacting qubits
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/qml/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Variational quantum algorithms
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Variational quantum algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/config_qnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuring a QNN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/qcl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantum circuit learning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classification with QNN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/qaoa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving MaxCut with QAOA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/dqc_1d/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solving a 1D ODE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/qcnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    QCNN model
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/qml/ml_tools/intro/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    ML Tools
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            ML Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/ml_tools/trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/ml_tools/data_and_config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data and Configurations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/ml_tools/callbacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training Callbacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/ml_tools/accelerator_doc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accelerator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/ml_tools/CPU/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CPU Training
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/ml_tools/GPU/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GPU Training
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/advanced_tutorials/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Advanced Tutorials
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/advanced_tutorials/differentiability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantum circuits differentiation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/advanced_tutorials/custom-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom quantum models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/advanced_tutorials/projectors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Projector blocks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/advanced_tutorials/profiling-and-debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Profiling and debugging on CUDA devices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/advanced_tutorials/cloud-submission/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Submission to Pasqal Cloud
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/realistic_sims/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Realistic simulations
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Realistic simulations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/realistic_sims/measurements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Measurement protocols
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/realistic_sims/noise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simulated errors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/realistic_sims/mitigation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Error mitigation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/development/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture and sharp bits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/development/draw/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Drawing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blocks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block system
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../register/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Register
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quantumcircuit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    QuantumCircuit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parameters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../states/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    State preparation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../noise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Noise
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constructors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transpile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transpilation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Execution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantum models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    QML tools
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    QML tools
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ml-tools" class="md-nav__link">
    <span class="md-ellipsis">
      ML Tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ML Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer" class="md-nav__link">
    <span class="md-ellipsis">
      Trainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.build_optimize_result" class="md-nav__link">
    <span class="md-ellipsis">
      build_optimize_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.get_ic_grad_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      get_ic_grad_bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_test_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_test_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_train_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_train_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_training" class="md-nav__link">
    <span class="md-ellipsis">
      run_training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_val_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_val_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_validation" class="md-nav__link">
    <span class="md-ellipsis">
      run_validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.stop_training" class="md-nav__link">
    <span class="md-ellipsis">
      stop_training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.test" class="md-nav__link">
    <span class="md-ellipsis">
      test
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig" class="md-nav__link">
    <span class="md-ellipsis">
      AnsatzConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AnsatzConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.ansatz_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      ansatz_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.ansatz_type" class="md-nav__link">
    <span class="md-ellipsis">
      ansatz_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.depth" class="md-nav__link">
    <span class="md-ellipsis">
      depth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.m_block_qubits" class="md-nav__link">
    <span class="md-ellipsis">
      m_block_qubits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.param_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      param_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.strategy_args" class="md-nav__link">
    <span class="md-ellipsis">
      strategy_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.tag" class="md-nav__link">
    <span class="md-ellipsis">
      tag
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureMapConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureMapConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.basis_set" class="md-nav__link">
    <span class="md-ellipsis">
      basis_set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.feature_map_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      feature_map_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.feature_range" class="md-nav__link">
    <span class="md-ellipsis">
      feature_range
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.inputs" class="md-nav__link">
    <span class="md-ellipsis">
      inputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.multivariate_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      multivariate_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.num_features" class="md-nav__link">
    <span class="md-ellipsis">
      num_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.num_repeats" class="md-nav__link">
    <span class="md-ellipsis">
      num_repeats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.operation" class="md-nav__link">
    <span class="md-ellipsis">
      operation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.param_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      param_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.reupload_scaling" class="md-nav__link">
    <span class="md-ellipsis">
      reupload_scaling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.tag" class="md-nav__link">
    <span class="md-ellipsis">
      tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.target_range" class="md-nav__link">
    <span class="md-ellipsis">
      target_range
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig" class="md-nav__link">
    <span class="md-ellipsis">
      TrainConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TrainConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.all_reduce_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      all_reduce_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.backend" class="md-nav__link">
    <span class="md-ellipsis">
      backend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.batch_size" class="md-nav__link">
    <span class="md-ellipsis">
      batch_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.checkpoint_best_only" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_best_only
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.checkpoint_every" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.compute_setup" class="md-nav__link">
    <span class="md-ellipsis">
      compute_setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.create_subfolder_per_run" class="md-nav__link">
    <span class="md-ellipsis">
      create_subfolder_per_run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.dtype" class="md-nav__link">
    <span class="md-ellipsis">
      dtype
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.log_folder" class="md-nav__link">
    <span class="md-ellipsis">
      log_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.log_setup" class="md-nav__link">
    <span class="md-ellipsis">
      log_setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.max_iter" class="md-nav__link">
    <span class="md-ellipsis">
      max_iter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.nprocs" class="md-nav__link">
    <span class="md-ellipsis">
      nprocs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.plot_every" class="md-nav__link">
    <span class="md-ellipsis">
      plot_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.plotting_functions" class="md-nav__link">
    <span class="md-ellipsis">
      plotting_functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.print_every" class="md-nav__link">
    <span class="md-ellipsis">
      print_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.root_folder" class="md-nav__link">
    <span class="md-ellipsis">
      root_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.tracking_tool" class="md-nav__link">
    <span class="md-ellipsis">
      tracking_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.trainstop_criterion" class="md-nav__link">
    <span class="md-ellipsis">
      trainstop_criterion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.val_epsilon" class="md-nav__link">
    <span class="md-ellipsis">
      val_epsilon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.val_every" class="md-nav__link">
    <span class="md-ellipsis">
      val_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.validation_criterion" class="md-nav__link">
    <span class="md-ellipsis">
      validation_criterion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.verbose" class="md-nav__link">
    <span class="md-ellipsis">
      verbose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.write_every" class="md-nav__link">
    <span class="md-ellipsis">
      write_every
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.parameters.get_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.parameters.num_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      num_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.parameters.set_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      set_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.optimize_step.optimize_step" class="md-nav__link">
    <span class="md-ellipsis">
      optimize_step
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.optimize_step.update_ng_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      update_ng_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.DictDataLoader" class="md-nav__link">
    <span class="md-ellipsis">
      DictDataLoader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.InfiniteTensorDataset" class="md-nav__link">
    <span class="md-ellipsis">
      InfiniteTensorDataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult" class="md-nav__link">
    <span class="md-ellipsis">
      OptimizeResult
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OptimizeResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.device" class="md-nav__link">
    <span class="md-ellipsis">
      device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.extra" class="md-nav__link">
    <span class="md-ellipsis">
      extra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.iteration" class="md-nav__link">
    <span class="md-ellipsis">
      iteration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.loss" class="md-nav__link">
    <span class="md-ellipsis">
      loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      optimizer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.rank" class="md-nav__link">
    <span class="md-ellipsis">
      rank
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.data_to_device" class="md-nav__link">
    <span class="md-ellipsis">
      data_to_device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.to_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      to_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN" class="md-nav__link">
    <span class="md-ellipsis">
      QNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN.from_configs" class="md-nav__link">
    <span class="md-ellipsis">
      from_configs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.derivative" class="md-nav__link">
    <span class="md-ellipsis">
      derivative
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.format_to_dict_fn" class="md-nav__link">
    <span class="md-ellipsis">
      format_to_dict_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback" class="md-nav__link">
    <span class="md-ellipsis">
      Callback
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Callback">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback.on" class="md-nav__link">
    <span class="md-ellipsis">
      on
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.EarlyStopping" class="md-nav__link">
    <span class="md-ellipsis">
      EarlyStopping
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EarlyStopping">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.EarlyStopping.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.GradientMonitoring" class="md-nav__link">
    <span class="md-ellipsis">
      GradientMonitoring
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GradientMonitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.GradientMonitoring.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCosineAnnealing" class="md-nav__link">
    <span class="md-ellipsis">
      LRSchedulerCosineAnnealing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LRSchedulerCosineAnnealing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCosineAnnealing.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCyclic" class="md-nav__link">
    <span class="md-ellipsis">
      LRSchedulerCyclic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LRSchedulerCyclic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCyclic.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerStepDecay" class="md-nav__link">
    <span class="md-ellipsis">
      LRSchedulerStepDecay
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LRSchedulerStepDecay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerStepDecay.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LoadCheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      LoadCheckpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LoadCheckpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LoadCheckpoint.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogHyperparameters" class="md-nav__link">
    <span class="md-ellipsis">
      LogHyperparameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LogHyperparameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogHyperparameters.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogModelTracker" class="md-nav__link">
    <span class="md-ellipsis">
      LogModelTracker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LogModelTracker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogModelTracker.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PlotMetrics" class="md-nav__link">
    <span class="md-ellipsis">
      PlotMetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PlotMetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PlotMetrics.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PrintMetrics" class="md-nav__link">
    <span class="md-ellipsis">
      PrintMetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PrintMetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PrintMetrics.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveBestCheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      SaveBestCheckpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SaveBestCheckpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveBestCheckpoint.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveCheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      SaveCheckpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SaveCheckpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveCheckpoint.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.WriteMetrics" class="md-nav__link">
    <span class="md-ellipsis">
      WriteMetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WriteMetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.WriteMetrics.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer" class="md-nav__link">
    <span class="md-ellipsis">
      BaseTrainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseTrainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      optimizer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.test_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      test_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.train_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      train_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.use_grad" class="md-nav__link">
    <span class="md-ellipsis">
      use_grad
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.val_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      val_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.callback" class="md-nav__link">
    <span class="md-ellipsis">
      callback
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.disable_grad_opt" class="md-nav__link">
    <span class="md-ellipsis">
      disable_grad_opt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.enable_grad_opt" class="md-nav__link">
    <span class="md-ellipsis">
      enable_grad_opt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_test_batch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_test_batch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_test_batch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_test_batch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_batch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_batch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_batch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_batch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_epoch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_epoch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_epoch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_epoch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_batch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_batch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_batch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_batch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_epoch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_epoch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_epoch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_epoch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.set_use_grad" class="md-nav__link">
    <span class="md-ellipsis">
      set_use_grad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter" class="md-nav__link">
    <span class="md-ellipsis">
      BaseWriter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      log_hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.print_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      print_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter" class="md-nav__link">
    <span class="md-ellipsis">
      MLFlowWriter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MLFlowWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.get_signature_from_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      get_signature_from_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.log_hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      log_hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter" class="md-nav__link">
    <span class="md-ellipsis">
      TensorBoardWriter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TensorBoardWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.log_hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      log_hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.get_writer" class="md-nav__link">
    <span class="md-ellipsis">
      get_writer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent" class="md-nav__link">
    <span class="md-ellipsis">
      InformationContent
    </span>
  </a>
  
    <nav class="md-nav" aria-label="InformationContent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.calculate_IC" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_IC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.batched_loss" class="md-nav__link">
    <span class="md-ellipsis">
      batched_loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.calculate_transition_probabilities_batch" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_transition_probabilities_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.discretize_derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      discretize_derivatives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.get_grad_norm_bounds_max_IC" class="md-nav__link">
    <span class="md-ellipsis">
      get_grad_norm_bounds_max_IC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.get_grad_norm_bounds_sensitivity_IC" class="md-nav__link">
    <span class="md-ellipsis">
      get_grad_norm_bounds_sensitivity_IC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.max_IC" class="md-nav__link">
    <span class="md-ellipsis">
      max_IC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.q_value" class="md-nav__link">
    <span class="md-ellipsis">
      q_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.randomized_finite_der" class="md-nav__link">
    <span class="md-ellipsis">
      randomized_finite_der
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.reshape_param_variations" class="md-nav__link">
    <span class="md-ellipsis">
      reshape_param_variations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.sensitivity_IC" class="md-nav__link">
    <span class="md-ellipsis">
      sensitivity_IC
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator" class="md-nav__link">
    <span class="md-ellipsis">
      Accelerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accelerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.all_reduce_dict" class="md-nav__link">
    <span class="md-ellipsis">
      all_reduce_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.broadcast" class="md-nav__link">
    <span class="md-ellipsis">
      broadcast
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.distribute" class="md-nav__link">
    <span class="md-ellipsis">
      distribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.is_class_method" class="md-nav__link">
    <span class="md-ellipsis">
      is_class_method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.prepare" class="md-nav__link">
    <span class="md-ellipsis">
      prepare
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.prepare_batch" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.worker" class="md-nav__link">
    <span class="md-ellipsis">
      worker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../serialization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Serialization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../draw/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Drawing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pasqal_cloud_connection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pasqal Cloud Connection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_17" >
        
          
          <label class="md-nav__link" for="__nav_5_17" id="__nav_5_17_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Backends
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_17">
            <span class="md-nav__icon md-icon"></span>
            Backends
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backends/backend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Abstract backend
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backends/pyqtorch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PyQTorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backends/pulser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pulser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backends/differentiable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DifferentiableBackend
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/pasqal-io/qadence/discussions" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ml-tools" class="md-nav__link">
    <span class="md-ellipsis">
      ML Tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ML Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer" class="md-nav__link">
    <span class="md-ellipsis">
      Trainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.build_optimize_result" class="md-nav__link">
    <span class="md-ellipsis">
      build_optimize_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.get_ic_grad_bounds" class="md-nav__link">
    <span class="md-ellipsis">
      get_ic_grad_bounds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_test_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_test_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_train_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_train_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_training" class="md-nav__link">
    <span class="md-ellipsis">
      run_training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_val_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_val_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_validation" class="md-nav__link">
    <span class="md-ellipsis">
      run_validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.stop_training" class="md-nav__link">
    <span class="md-ellipsis">
      stop_training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.test" class="md-nav__link">
    <span class="md-ellipsis">
      test
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig" class="md-nav__link">
    <span class="md-ellipsis">
      AnsatzConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AnsatzConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.ansatz_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      ansatz_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.ansatz_type" class="md-nav__link">
    <span class="md-ellipsis">
      ansatz_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.depth" class="md-nav__link">
    <span class="md-ellipsis">
      depth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.m_block_qubits" class="md-nav__link">
    <span class="md-ellipsis">
      m_block_qubits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.param_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      param_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.strategy_args" class="md-nav__link">
    <span class="md-ellipsis">
      strategy_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.tag" class="md-nav__link">
    <span class="md-ellipsis">
      tag
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureMapConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureMapConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.basis_set" class="md-nav__link">
    <span class="md-ellipsis">
      basis_set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.feature_map_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      feature_map_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.feature_range" class="md-nav__link">
    <span class="md-ellipsis">
      feature_range
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.inputs" class="md-nav__link">
    <span class="md-ellipsis">
      inputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.multivariate_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      multivariate_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.num_features" class="md-nav__link">
    <span class="md-ellipsis">
      num_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.num_repeats" class="md-nav__link">
    <span class="md-ellipsis">
      num_repeats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.operation" class="md-nav__link">
    <span class="md-ellipsis">
      operation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.param_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      param_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.reupload_scaling" class="md-nav__link">
    <span class="md-ellipsis">
      reupload_scaling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.tag" class="md-nav__link">
    <span class="md-ellipsis">
      tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.target_range" class="md-nav__link">
    <span class="md-ellipsis">
      target_range
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig" class="md-nav__link">
    <span class="md-ellipsis">
      TrainConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TrainConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.all_reduce_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      all_reduce_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.backend" class="md-nav__link">
    <span class="md-ellipsis">
      backend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.batch_size" class="md-nav__link">
    <span class="md-ellipsis">
      batch_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.checkpoint_best_only" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_best_only
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.checkpoint_every" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.compute_setup" class="md-nav__link">
    <span class="md-ellipsis">
      compute_setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.create_subfolder_per_run" class="md-nav__link">
    <span class="md-ellipsis">
      create_subfolder_per_run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.dtype" class="md-nav__link">
    <span class="md-ellipsis">
      dtype
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.log_folder" class="md-nav__link">
    <span class="md-ellipsis">
      log_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.log_setup" class="md-nav__link">
    <span class="md-ellipsis">
      log_setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.max_iter" class="md-nav__link">
    <span class="md-ellipsis">
      max_iter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.nprocs" class="md-nav__link">
    <span class="md-ellipsis">
      nprocs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.plot_every" class="md-nav__link">
    <span class="md-ellipsis">
      plot_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.plotting_functions" class="md-nav__link">
    <span class="md-ellipsis">
      plotting_functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.print_every" class="md-nav__link">
    <span class="md-ellipsis">
      print_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.root_folder" class="md-nav__link">
    <span class="md-ellipsis">
      root_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.tracking_tool" class="md-nav__link">
    <span class="md-ellipsis">
      tracking_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.trainstop_criterion" class="md-nav__link">
    <span class="md-ellipsis">
      trainstop_criterion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.val_epsilon" class="md-nav__link">
    <span class="md-ellipsis">
      val_epsilon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.val_every" class="md-nav__link">
    <span class="md-ellipsis">
      val_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.validation_criterion" class="md-nav__link">
    <span class="md-ellipsis">
      validation_criterion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.verbose" class="md-nav__link">
    <span class="md-ellipsis">
      verbose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.write_every" class="md-nav__link">
    <span class="md-ellipsis">
      write_every
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.parameters.get_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.parameters.num_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      num_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.parameters.set_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      set_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.optimize_step.optimize_step" class="md-nav__link">
    <span class="md-ellipsis">
      optimize_step
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.optimize_step.update_ng_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      update_ng_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.DictDataLoader" class="md-nav__link">
    <span class="md-ellipsis">
      DictDataLoader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.InfiniteTensorDataset" class="md-nav__link">
    <span class="md-ellipsis">
      InfiniteTensorDataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult" class="md-nav__link">
    <span class="md-ellipsis">
      OptimizeResult
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OptimizeResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.device" class="md-nav__link">
    <span class="md-ellipsis">
      device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.extra" class="md-nav__link">
    <span class="md-ellipsis">
      extra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.iteration" class="md-nav__link">
    <span class="md-ellipsis">
      iteration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.loss" class="md-nav__link">
    <span class="md-ellipsis">
      loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      optimizer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.rank" class="md-nav__link">
    <span class="md-ellipsis">
      rank
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.data_to_device" class="md-nav__link">
    <span class="md-ellipsis">
      data_to_device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.to_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      to_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN" class="md-nav__link">
    <span class="md-ellipsis">
      QNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN.from_configs" class="md-nav__link">
    <span class="md-ellipsis">
      from_configs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.derivative" class="md-nav__link">
    <span class="md-ellipsis">
      derivative
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.format_to_dict_fn" class="md-nav__link">
    <span class="md-ellipsis">
      format_to_dict_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback" class="md-nav__link">
    <span class="md-ellipsis">
      Callback
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Callback">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback.on" class="md-nav__link">
    <span class="md-ellipsis">
      on
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.EarlyStopping" class="md-nav__link">
    <span class="md-ellipsis">
      EarlyStopping
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EarlyStopping">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.EarlyStopping.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.GradientMonitoring" class="md-nav__link">
    <span class="md-ellipsis">
      GradientMonitoring
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GradientMonitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.GradientMonitoring.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCosineAnnealing" class="md-nav__link">
    <span class="md-ellipsis">
      LRSchedulerCosineAnnealing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LRSchedulerCosineAnnealing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCosineAnnealing.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCyclic" class="md-nav__link">
    <span class="md-ellipsis">
      LRSchedulerCyclic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LRSchedulerCyclic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCyclic.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerStepDecay" class="md-nav__link">
    <span class="md-ellipsis">
      LRSchedulerStepDecay
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LRSchedulerStepDecay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerStepDecay.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LoadCheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      LoadCheckpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LoadCheckpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LoadCheckpoint.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogHyperparameters" class="md-nav__link">
    <span class="md-ellipsis">
      LogHyperparameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LogHyperparameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogHyperparameters.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogModelTracker" class="md-nav__link">
    <span class="md-ellipsis">
      LogModelTracker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LogModelTracker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogModelTracker.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PlotMetrics" class="md-nav__link">
    <span class="md-ellipsis">
      PlotMetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PlotMetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PlotMetrics.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PrintMetrics" class="md-nav__link">
    <span class="md-ellipsis">
      PrintMetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PrintMetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PrintMetrics.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveBestCheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      SaveBestCheckpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SaveBestCheckpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveBestCheckpoint.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveCheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      SaveCheckpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SaveCheckpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveCheckpoint.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.WriteMetrics" class="md-nav__link">
    <span class="md-ellipsis">
      WriteMetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WriteMetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.WriteMetrics.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer" class="md-nav__link">
    <span class="md-ellipsis">
      BaseTrainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseTrainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      optimizer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.test_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      test_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.train_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      train_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.use_grad" class="md-nav__link">
    <span class="md-ellipsis">
      use_grad
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.val_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      val_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.callback" class="md-nav__link">
    <span class="md-ellipsis">
      callback
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.disable_grad_opt" class="md-nav__link">
    <span class="md-ellipsis">
      disable_grad_opt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.enable_grad_opt" class="md-nav__link">
    <span class="md-ellipsis">
      enable_grad_opt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_test_batch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_test_batch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_test_batch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_test_batch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_batch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_batch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_batch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_batch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_epoch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_epoch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_epoch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_epoch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_batch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_batch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_batch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_batch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_epoch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_epoch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_epoch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_epoch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.set_use_grad" class="md-nav__link">
    <span class="md-ellipsis">
      set_use_grad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter" class="md-nav__link">
    <span class="md-ellipsis">
      BaseWriter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      log_hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.print_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      print_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter" class="md-nav__link">
    <span class="md-ellipsis">
      MLFlowWriter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MLFlowWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.get_signature_from_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      get_signature_from_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.log_hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      log_hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter" class="md-nav__link">
    <span class="md-ellipsis">
      TensorBoardWriter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TensorBoardWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.log_hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      log_hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.get_writer" class="md-nav__link">
    <span class="md-ellipsis">
      get_writer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent" class="md-nav__link">
    <span class="md-ellipsis">
      InformationContent
    </span>
  </a>
  
    <nav class="md-nav" aria-label="InformationContent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.calculate_IC" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_IC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.batched_loss" class="md-nav__link">
    <span class="md-ellipsis">
      batched_loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.calculate_transition_probabilities_batch" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_transition_probabilities_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.discretize_derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      discretize_derivatives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.get_grad_norm_bounds_max_IC" class="md-nav__link">
    <span class="md-ellipsis">
      get_grad_norm_bounds_max_IC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.get_grad_norm_bounds_sensitivity_IC" class="md-nav__link">
    <span class="md-ellipsis">
      get_grad_norm_bounds_sensitivity_IC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.max_IC" class="md-nav__link">
    <span class="md-ellipsis">
      max_IC
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.q_value" class="md-nav__link">
    <span class="md-ellipsis">
      q_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.randomized_finite_der" class="md-nav__link">
    <span class="md-ellipsis">
      randomized_finite_der
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.reshape_param_variations" class="md-nav__link">
    <span class="md-ellipsis">
      reshape_param_variations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.information.information_content.InformationContent.sensitivity_IC" class="md-nav__link">
    <span class="md-ellipsis">
      sensitivity_IC
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator" class="md-nav__link">
    <span class="md-ellipsis">
      Accelerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accelerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.all_reduce_dict" class="md-nav__link">
    <span class="md-ellipsis">
      all_reduce_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.broadcast" class="md-nav__link">
    <span class="md-ellipsis">
      broadcast
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.distribute" class="md-nav__link">
    <span class="md-ellipsis">
      distribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.is_class_method" class="md-nav__link">
    <span class="md-ellipsis">
      is_class_method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.prepare" class="md-nav__link">
    <span class="md-ellipsis">
      prepare
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.prepare_batch" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.accelerator.Accelerator.worker" class="md-nav__link">
    <span class="md-ellipsis">
      worker
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>QML tools</h1>

<h2 id="ml-tools">ML Tools</h2>
<p>This module implements a <code>Trainer</code> class for torch <code>Modules</code> and <code>QuantumModel</code>. It also implements the <code>QNN</code> class and callbacks that can be used with the trainer module.</p>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.trainer.Trainer" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Trainer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">loss_fn</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">train_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optimize_step</span><span class="o">=</span><span class="n">optimize_step</span><span class="p">,</span> <span class="n">max_batches</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseTrainer(model, optimizer, config, loss_fn='mse', optimize_step=optimize_step, train_dataloader=None, val_dataloader=None, test_dataloader=None, max_batches=None) (qadence.ml_tools.train_utils.base_trainer.BaseTrainer)" href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer">BaseTrainer</a></code></p>


        <p>Trainer class to manage and execute training, validation, and testing loops for a model (eg.</p>
<p>QNN).</p>
<p>This class handles the overall training process, including:
- Managing epochs and steps
- Handling data loading and batching
- Computing and updating gradients
- Logging and monitoring training metrics</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.trainer.Trainer.current_epoch">current_epoch</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The current epoch number.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.trainer.Trainer.global_step">global_step</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The global step across all epochs.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="inherited-attributes" open>
  <summary>Inherited Attributes</summary>
  <p>use_grad (bool): Indicates if gradients are used for optimization. Default is True.</p>
<p>model (nn.Module): The neural network model.
optimizer (optim.Optimizer | NGOptimizer | None): The optimizer for training.
config (TrainConfig): The configuration settings for training.
train_dataloader (DataLoader | DictDataLoader |  None): DataLoader for training data.
val_dataloader (DataLoader | DictDataLoader |  None): DataLoader for validation data.
test_dataloader (DataLoader | DictDataLoader |  None): DataLoader for testing data.</p>
<p>optimize_step (Callable): Function for performing an optimization step.
loss_fn (Callable): loss function to use.</p>
<p>num_training_batches (int): Number of training batches.
num_validation_batches (int): Number of validation batches.
num_test_batches (int): Number of test batches.</p>
<p>state (str): Current state in the training process</p>
</details>        <p>Default training routine
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>for epoch in max_iter + 1:
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    # Training
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    for batch in train_batches:
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        train model
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    # Validation
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    if val_every % epoch == 0:
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        for batch in val_batches:
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>            train model
</code></pre></div></p>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>In case of InfiniteTensorDataset, number of batches = 1.</li>
<li>In case of TensorDataset, number of batches are default.</li>
<li>Training is run for max_iter + 1 epochs. Epoch 0 logs untrained model.</li>
<li>Please look at the CallbackManager initialize_callbacks method to review the default
    logging behavior.</li>
</ul>
</details>        <p>Examples:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">torch.optim</span><span class="w"> </span><span class="kn">import</span> <span class="n">SGD</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">feature_map</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">hamiltonian_factory</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">hea</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">QNN</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">QuantumCircuit</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">TrainConfig</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">Z</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.trainer</span><span class="w"> </span><span class="kn">import</span> <span class="n">Trainer</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.optimize_step</span><span class="w"> </span><span class="kn">import</span> <span class="n">optimize_step</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_dataloader</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="c1"># Initialize the model</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="n">fm</span> <span class="o">=</span> <span class="n">feature_map</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">ansatz</span> <span class="o">=</span> <span class="n">hea</span><span class="p">(</span><span class="n">n_qubits</span><span class="o">=</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="n">observable</span> <span class="o">=</span> <span class="n">hamiltonian_factory</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">detuning</span><span class="o">=</span><span class="n">Z</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">ansatz</span><span class="p">)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="n">model</span> <span class="o">=</span> <span class="n">QNN</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">observable</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;pyqtorch&quot;</span><span class="p">,</span> <span class="n">diff_mode</span><span class="o">=</span><span class="s2">&quot;ad&quot;</span><span class="p">)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="c1"># Set up the optimizer</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="n">optimizer</span> <span class="o">=</span> <span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="c1"># Use TrainConfig for configuring the training process</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    <span class="n">write_every</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>    <span class="n">checkpoint_every</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    <span class="n">val_every</span><span class="o">=</span><span class="mi">10</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="c1"># Create the Trainer instance with TrainConfig</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span><span class="p">,</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>    <span class="n">optimize_step</span><span class="o">=</span><span class="n">optimize_step</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">25</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="n">train_loader</span> <span class="o">=</span> <span class="n">to_dataloader</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">infinite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="n">val_loader</span> <span class="o">=</span> <span class="n">to_dataloader</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">infinite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="c1"># Train the model</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">)</span>
</code></pre></div>
<p>This also supports both gradient based and gradient free optimization.
The default support is for gradient based optimization.</p>
<p>Notes:</p>
<ul>
<li><strong>set_use_grad()</strong> (<em>class level</em>):This method is used to set the global <code>use_grad</code> flag,
    controlling whether the trainer uses gradient-based optimization.
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># gradient based</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">Trainer</span><span class="o">.</span><span class="n">set_use_grad</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># gradient free</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">Trainer</span><span class="o">.</span><span class="n">set_use_grad</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></li>
<li><strong>Context Managers</strong> (<em>instance level</em>):  <code>enable_grad_opt()</code> and <code>disable_grad_opt()</code> are
    context managers that temporarily switch the optimization mode for specific code blocks.
    This is useful when you want to mix gradient-based and gradient-free optimization
    in the same training process.
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># gradient based</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="k">with</span> <span class="n">trainer</span><span class="o">.</span><span class="n">enable_grad_opt</span><span class="p">(</span><span class="n">optimizer</span><span class="p">):</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c1"># gradient free</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="k">with</span> <span class="n">trainer</span><span class="o">.</span><span class="n">disable_grad_opt</span><span class="p">(</span><span class="n">ng_optimizer</span><span class="p">):</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div></li>
</ul>
<p>Examples</p>
<p><em>Gradient based optimization example Usage</em>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">optim</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">Trainer</span><span class="o">.</span><span class="n">set_use_grad</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="p">)</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">)</span>
</code></pre></div>
or
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="p">)</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="k">with</span> <span class="n">trainer</span><span class="o">.</span><span class="n">enable_grad_opt</span><span class="p">(</span><span class="n">optimizer</span><span class="p">):</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">)</span>
</code></pre></div></p>
<p><em>Gradient free optimization example Usage</em>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">nevergrad</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ng</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.parameters</span><span class="w"> </span><span class="kn">import</span> <span class="n">num_parameters</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">ng_optimizer</span> <span class="o">=</span> <span class="n">ng</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">NGOpt</span><span class="p">(</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>                <span class="n">budget</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">parametrization</span><span class="o">=</span> <span class="n">num_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>                <span class="p">)</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="n">Trainer</span><span class="o">.</span><span class="n">set_use_grad</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>    <span class="n">optimizer</span><span class="o">=</span><span class="n">ng_optimizer</span><span class="p">,</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="p">)</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">)</span>
</code></pre></div>
or
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">nevergrad</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ng</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.parameters</span><span class="w"> </span><span class="kn">import</span> <span class="n">num_parameters</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">ng_optimizer</span> <span class="o">=</span> <span class="n">ng</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">NGOpt</span><span class="p">(</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>        <span class="n">budget</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">parametrization</span><span class="o">=</span> <span class="n">num_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>        <span class="p">)</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="p">)</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="k">with</span> <span class="n">trainer</span><span class="o">.</span><span class="n">disable_grad_opt</span><span class="p">(</span><span class="n">ng_optimizer</span><span class="p">):</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>    <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">)</span>
</code></pre></div></p>

        <p>Initializes the Trainer class.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The PyTorch model to train.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The optimizer for training.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.optim.Optimizer">Optimizer</span> | <span title="nevergrad.optimization.base.Optimizer">Optimizer</span> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Training configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_fn</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Loss function used for training.
If not specified, default mse loss will be used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="typing.Callable">Callable</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;mse&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>train_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>val_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for test data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimize_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Function to execute an optimization step.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Callable">Callable</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="optimize_step(model, optimizer, loss_fn, xs, device=None, dtype=None) (qadence.ml_tools.optimize_step.optimize_step)" href="#qadence.ml_tools.optimize_step.optimize_step">optimize_step</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_batches</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum number of batches to process per epoch.
This is only valid in case of finite TensorDataset dataloaders.
if max_batches is not None, the maximum number of batches used will
be min(max_batches, len(dataloader.dataset))
In case of InfiniteTensorDataset only 1 batch per epoch is used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="n">optimizer</span><span class="p">:</span> <span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span> <span class="o">|</span> <span class="n">NGOptimizer</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="n">loss_fn</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="s2">&quot;mse&quot;</span><span class="p">,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="n">train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="n">val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="n">optimize_step</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">optimize_step</span><span class="p">,</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="n">max_batches</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="p">):</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    Initializes the Trainer class.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        model (nn.Module): The PyTorch model to train.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        optimizer (optim.Optimizer | NGOptimizer | None): The optimizer for training.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        config (TrainConfig): Training configuration object.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        loss_fn (str | Callable ): Loss function used for training.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            If not specified, default mse loss will be used.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        train_dataloader (DataLoader | DictDataLoader |  None): DataLoader for training data.</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        val_dataloader (DataLoader | DictDataLoader |  None): DataLoader for validation data.</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        test_dataloader (DataLoader | DictDataLoader |  None): DataLoader for test data.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        optimize_step (Callable): Function to execute an optimization step.</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        max_batches (int | None): Maximum number of batches to process per epoch.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            This is only valid in case of finite TensorDataset dataloaders.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">            if max_batches is not None, the maximum number of batches used will</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">            be min(max_batches, len(dataloader.dataset))</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            In case of InfiniteTensorDataset only 1 batch per epoch is used.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="n">loss_fn</span><span class="o">=</span><span class="n">loss_fn</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="n">optimize_step</span><span class="o">=</span><span class="n">optimize_step</span><span class="p">,</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">train_dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="n">val_dataloader</span><span class="o">=</span><span class="n">val_dataloader</span><span class="p">,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="n">test_dataloader</span><span class="o">=</span><span class="n">test_dataloader</span><span class="p">,</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="n">max_batches</span><span class="o">=</span><span class="n">max_batches</span><span class="p">,</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="p">)</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">current_epoch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">global_step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_stop_training</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">progress</span><span class="p">:</span> <span class="n">Progress</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="c1"># Integration with Accelerator:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">accelerator</span> <span class="o">=</span> <span class="n">Accelerator</span><span class="p">(</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">backend</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="n">nprocs</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">nprocs</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="n">compute_setup</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">compute_setup</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="n">dtype</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="n">log_setup</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">log_setup</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="p">)</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="c1"># Decorate the unbound Trainer.fit method with accelerator.distribute.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="c1"># We use __get__ to bind the decorated method to the current instance,</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="c1"># ensuring that &#39;self&#39; is passed only once when self.fit is called.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">distribute</span><span class="p">(</span><span class="n">Trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">)</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Trainer</span><span class="p">)</span>  <span class="c1"># type: ignore[method-assign]</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.build_optimize_result" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_optimize_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Builds and stores the optimization result by calculating the average loss and metrics.</p>
<p>Result (or loss_metrics) can have multiple formats:
- <code>None</code> Indicates no loss or metrics data is provided.
- <code>tuple[torch.Tensor, dict[str, Any]]</code> A single tuple containing the loss tensor
    and metrics dictionary - at the end of batch.
- <code>list[tuple[torch.Tensor, dict[str, Any]]]</code> A list of tuples for
    multiple batches.
- <code>list[list[tuple[torch.Tensor, dict[str, Any]]]]</code> A list of lists of tuples,
where each inner list represents metrics across multiple batches within an epoch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>result</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>(None |
    tuple[torch.Tensor, dict[Any, Any]] |
    list[tuple[torch.Tensor, dict[Any, Any]]] |
    list[list[tuple[torch.Tensor, dict[Any, Any]]]])
        The loss and metrics data, which can have multiple formats</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>None | <span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="dict">dict</span>[<span title="typing.Any">Any</span>, <span title="typing.Any">Any</span>]] | <span title="list">list</span>[<span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="dict">dict</span>[<span title="typing.Any">Any</span>, <span title="typing.Any">Any</span>]]] | <span title="list">list</span>[<span title="list">list</span>[<span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="dict">dict</span>[<span title="typing.Any">Any</span>, <span title="typing.Any">Any</span>]]]]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>None</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>This method does not return anything. It sets <code>self.opt_result</code> with</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code>None</code>
                  </span>
                </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>the computed average loss and metrics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="k">def</span><span class="w"> </span><span class="nf">build_optimize_result</span><span class="p">(</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>    <span class="n">result</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>        <span class="kc">None</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>        <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>        <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]]</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="p">),</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a><span class="sd">    Builds and stores the optimization result by calculating the average loss and metrics.</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a><span class="sd">    Result (or loss_metrics) can have multiple formats:</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">    - `None` Indicates no loss or metrics data is provided.</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><span class="sd">    - `tuple[torch.Tensor, dict[str, Any]]` A single tuple containing the loss tensor</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">        and metrics dictionary - at the end of batch.</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">    - `list[tuple[torch.Tensor, dict[str, Any]]]` A list of tuples for</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="sd">        multiple batches.</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a><span class="sd">    - `list[list[tuple[torch.Tensor, dict[str, Any]]]]` A list of lists of tuples,</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a><span class="sd">    where each inner list represents metrics across multiple batches within an epoch.</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="sd">        result: (None |</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a><span class="sd">                tuple[torch.Tensor, dict[Any, Any]] |</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="sd">                list[tuple[torch.Tensor, dict[Any, Any]]] |</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a><span class="sd">                list[list[tuple[torch.Tensor, dict[Any, Any]]]])</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a><span class="sd">                    The loss and metrics data, which can have multiple formats</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">        None: This method does not return anything. It sets `self.opt_result` with</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">        the computed average loss and metrics.</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>    <span class="n">loss_metrics</span> <span class="o">=</span> <span class="n">result</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>    <span class="k">if</span> <span class="n">loss_metrics</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>        <span class="n">loss</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>        <span class="n">metrics</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>        <span class="c1"># Single tuple case</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>        <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">loss_metrics</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>        <span class="n">last_epoch</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>            <span class="c1"># Check if it&#39;s a list of tuples</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">loss_metrics</span><span class="p">):</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>                <span class="n">last_epoch</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="n">loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>            <span class="c1"># Check if it&#39;s a list of lists of tuples</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>            <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">loss_metrics</span><span class="p">):</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>                <span class="n">last_epoch</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>                    <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>                    <span class="n">loss_metrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">loss_metrics</span> <span class="k">else</span> <span class="p">[],</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>                <span class="p">)</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>                    <span class="s2">&quot;Invalid format for result: Expected None, tuple, list of tuples,&quot;</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>                    <span class="s2">&quot; or list of lists of tuples.&quot;</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>                <span class="p">)</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">last_epoch</span><span class="p">:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>            <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{}</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>            <span class="c1"># Compute the average loss over the batches</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>            <span class="n">loss_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">loss_batch</span> <span class="k">for</span> <span class="n">loss_batch</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">last_epoch</span><span class="p">])</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>            <span class="n">avg_loss</span> <span class="o">=</span> <span class="n">loss_tensor</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>            <span class="c1"># Collect and average metrics for all batches</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>            <span class="n">metric_keys</span> <span class="o">=</span> <span class="n">last_epoch</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>            <span class="n">metrics_stacked</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">metric_keys</span><span class="p">}</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">metrics_batch</span> <span class="ow">in</span> <span class="n">last_epoch</span><span class="p">:</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">metric_keys</span><span class="p">:</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>                    <span class="n">value</span> <span class="o">=</span> <span class="n">metrics_batch</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>                    <span class="n">metrics_stacked</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>            <span class="n">avg_metrics</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">metrics_stacked</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">metric_keys</span><span class="p">}</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>            <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">avg_loss</span><span class="p">,</span> <span class="n">avg_metrics</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>    <span class="c1"># Store the optimization result</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">opt_result</span> <span class="o">=</span> <span class="n">OptimizeResult</span><span class="p">(</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_epoch</span><span class="p">,</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>        <span class="n">loss</span><span class="p">,</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>        <span class="n">metrics</span><span class="p">,</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>        <span class="n">rank</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">rank</span><span class="p">,</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>        <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">train_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Fits the model using the specified training configuration.</p>
<p>The dataloaders can be provided to train on new datasets, or the default dataloaders
provided in the trainer will be used.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>train_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>val_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span>[<span title="torch.nn.Module">Module</span>, <span title="torch.optim.Optimizer">Optimizer</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[nn.Module, optim.Optimizer]: The trained model and optimizer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="n">val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">]:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">    Fits the model using the specified training configuration.</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    The dataloaders can be provided to train on new datasets, or the default dataloaders</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    provided in the trainer will be used.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        train_dataloader (DataLoader | DictDataLoader |  None): DataLoader for training data.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        val_dataloader (DataLoader | DictDataLoader |  None): DataLoader for validation data.</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        tuple[nn.Module, optim.Optimizer]: The trained model and optimizer.</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="k">if</span> <span class="n">train_dataloader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader</span> <span class="o">=</span> <span class="n">train_dataloader</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="k">if</span> <span class="n">val_dataloader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">val_dataloader</span> <span class="o">=</span> <span class="n">val_dataloader</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_fit_setup</span><span class="p">()</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_train</span><span class="p">()</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_fit_end</span><span class="p">()</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">training_stage</span> <span class="o">=</span> <span class="n">TrainingStage</span><span class="p">(</span><span class="s2">&quot;idle&quot;</span><span class="p">)</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.get_ic_grad_bounds" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_ic_grad_bounds</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span> <span class="n">epsilons</span><span class="p">,</span> <span class="n">variation_multiple</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate the bounds on the gradient norm of the loss using Information Content.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>eta</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The sensitivity IC.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>epsilons</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The epsilons to use for thresholds to for discretization of the
finite derivatives.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.Tensor">Tensor</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variation_multiple</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The number of sets of variational parameters to generate per
each variational parameter. The number of variational parameters required for the
statisctiacal analysis scales linearly with the amount of them present in the
model. This is that linear factor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>20</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The dataloader for training data. A
new dataloader can be provided, or the dataloader provided in the trinaer will be
used. In case no dataloaders are provided at either places, it assumes that the
model does not require any input data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[float, float, float]: The max IC lower bound, max IC upper bound, and sensitivity
IC upper bound.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">torch.optim.adam</span><span class="w"> </span><span class="kn">import</span> <span class="n">Adam</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.constructors</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObservableConfig</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">AnsatzConfig</span><span class="p">,</span> <span class="n">FeatureMapConfig</span><span class="p">,</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_dataloader</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">QNN</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.optimize_step</span><span class="w"> </span><span class="kn">import</span> <span class="n">optimize_step</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.trainer</span><span class="w"> </span><span class="kn">import</span> <span class="n">Trainer</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.operations.primitive</span><span class="w"> </span><span class="kn">import</span> <span class="n">Z</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">fm_config</span> <span class="o">=</span> <span class="n">FeatureMapConfig</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">ansatz_config</span> <span class="o">=</span> <span class="n">AnsatzConfig</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">obs_config</span> <span class="o">=</span> <span class="n">ObservableConfig</span><span class="p">(</span><span class="n">detuning</span><span class="o">=</span><span class="n">Z</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">qnn</span> <span class="o">=</span> <span class="n">QNN</span><span class="o">.</span><span class="n">from_configs</span><span class="p">(</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="n">register</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">obs_config</span><span class="o">=</span><span class="n">obs_config</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">fm_config</span><span class="o">=</span><span class="n">fm_config</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="n">ansatz_config</span><span class="o">=</span><span class="n">ansatz_config</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="n">optimizer</span> <span class="o">=</span> <span class="n">Adam</span><span class="p">(</span><span class="n">qnn</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">25</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="n">train_loader</span> <span class="o">=</span> <span class="n">to_dataloader</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">infinite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="n">train_config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>    <span class="n">model</span><span class="o">=</span><span class="n">qnn</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>    <span class="n">config</span><span class="o">=</span><span class="n">train_config</span><span class="p">,</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>    <span class="n">train_dataloader</span><span class="o">=</span><span class="n">train_loader</span><span class="p">,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>    <span class="n">optimize_step</span><span class="o">=</span><span class="n">optimize_step</span><span class="p">,</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="p">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="c1"># Perform exploratory landscape analysis with Information Content</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="n">ic_sensitivity_threshold</span> <span class="o">=</span> <span class="mf">1e-4</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="n">epsilons</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="n">max_ic_lower_bound</span><span class="p">,</span> <span class="n">max_ic_upper_bound</span><span class="p">,</span> <span class="n">sensitivity_ic_upper_bound</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>    <span class="n">trainer</span><span class="o">.</span><span class="n">get_ic_grad_bounds</span><span class="p">(</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>        <span class="n">eta</span><span class="o">=</span><span class="n">ic_sensitivity_threshold</span><span class="p">,</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>        <span class="n">epsilons</span><span class="o">=</span><span class="n">epsilons</span><span class="p">,</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>    <span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="c1"># Resume training as usual...</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a><span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_ic_grad_bounds</span><span class="p">(</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>    <span class="n">eta</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>    <span class="n">epsilons</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>    <span class="n">variation_multiple</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>    <span class="n">dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">    Calculate the bounds on the gradient norm of the loss using Information Content.</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">        eta (float): The sensitivity IC.</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">        epsilons (torch.Tensor): The epsilons to use for thresholds to for discretization of the</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">            finite derivatives.</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">        variation_multiple (int): The number of sets of variational parameters to generate per</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">            each variational parameter. The number of variational parameters required for the</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">            statisctiacal analysis scales linearly with the amount of them present in the</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">            model. This is that linear factor.</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">        dataloader (DataLoader | DictDataLoader | None): The dataloader for training data. A</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">            new dataloader can be provided, or the dataloader provided in the trinaer will be</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">            used. In case no dataloaders are provided at either places, it assumes that the</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">            model does not require any input data.</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">        tuple[float, float, float]: The max IC lower bound, max IC upper bound, and sensitivity</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">            IC upper bound.</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">        import torch</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">        from torch.optim.adam import Adam</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">        from qadence.constructors import ObservableConfig</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">        from qadence.ml_tools.config import AnsatzConfig, FeatureMapConfig, TrainConfig</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">        from qadence.ml_tools.data import to_dataloader</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">        from qadence.ml_tools.models import QNN</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">        from qadence.ml_tools.optimize_step import optimize_step</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">        from qadence.ml_tools.trainer import Trainer</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">        from qadence.operations.primitive import Z</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">        fm_config = FeatureMapConfig(num_features=1)</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">        ansatz_config = AnsatzConfig(depth=4)</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">        obs_config = ObservableConfig(detuning=Z)</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">        qnn = QNN.from_configs(</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">            register=4,</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">            obs_config=obs_config,</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">            fm_config=fm_config,</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">            ansatz_config=ansatz_config,</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a><span class="sd">        )</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a><span class="sd">        optimizer = Adam(qnn.parameters(), lr=0.001)</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="sd">        batch_size = 25</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a><span class="sd">        x = torch.linspace(0, 1, 32).reshape(-1, 1)</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="sd">        y = torch.sin(x)</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="sd">        train_loader = to_dataloader(x, y, batch_size=batch_size, infinite=True)</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">        train_config = TrainConfig(max_iter=100)</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">        trainer = Trainer(</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">            model=qnn,</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">            optimizer=optimizer,</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">            config=train_config,</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">            loss_fn=&quot;mse&quot;,</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">            train_dataloader=train_loader,</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">            optimize_step=optimize_step,</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">        )</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">        # Perform exploratory landscape analysis with Information Content</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">        ic_sensitivity_threshold = 1e-4</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">        epsilons = torch.logspace(-2, 2, 10)</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">        max_ic_lower_bound, max_ic_upper_bound, sensitivity_ic_upper_bound = (</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">            trainer.get_ic_grad_bounds(</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">                eta=ic_sensitivity_threshold,</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">                epsilons=epsilons,</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">            )</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">        )</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">        # Resume training as usual...</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">        trainer.fit(train_loader)</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">        ```</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_grad</span><span class="p">:</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>            <span class="s2">&quot;Gradient norm bounds are only relevant when using a gradient based optimizer. </span><span class="se">\</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="s2">                Currently the trainer is set to use a gradient-free optimizer.&quot;</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>        <span class="p">)</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>    <span class="n">dataloader</span> <span class="o">=</span> <span class="n">dataloader</span> <span class="k">if</span> <span class="n">dataloader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>    <span class="n">batch</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_batch_iter</span><span class="p">(</span><span class="n">dataloader</span><span class="p">,</span> <span class="n">num_batches</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>    <span class="n">ic</span> <span class="o">=</span> <span class="n">InformationContent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">epsilons</span><span class="p">)</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>    <span class="n">max_ic_lower_bound</span><span class="p">,</span> <span class="n">max_ic_upper_bound</span> <span class="o">=</span> <span class="n">ic</span><span class="o">.</span><span class="n">get_grad_norm_bounds_max_IC</span><span class="p">()</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>    <span class="n">sensitivity_ic_upper_bound</span> <span class="o">=</span> <span class="n">ic</span><span class="o">.</span><span class="n">get_grad_norm_bounds_sensitivity_IC</span><span class="p">(</span><span class="n">eta</span><span class="p">)</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>    <span class="k">return</span> <span class="n">max_ic_lower_bound</span><span class="p">,</span> <span class="n">max_ic_upper_bound</span><span class="p">,</span> <span class="n">sensitivity_ic_upper_bound</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.run_test_batch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_test_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Runs a single test batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch of data from the DataLoader.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, ...]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[torch.Tensor, dict[str, Any]]: Loss and metrics for the batch.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="nd">@BaseTrainer</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s2">&quot;test_batch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_test_batch</span><span class="p">(</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">    Runs a single test batch.</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">        batch (tuple[torch.Tensor, ...]): Batch of data from the DataLoader.</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">        tuple[torch.Tensor, dict[str, Any]]: Loss and metrics for the batch.</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>        <span class="n">loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modify_batch_end_loss_metrics</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.run_train_batch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_train_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Runs a single training batch, performing optimization.</p>
<p>We use the step function to optimize the model based on use_grad.
    use_grad = True entails gradient based optimization, for which we use
    optimize_step function.
    use_grad = False entails gradient free optimization, for which we use
    update_ng_parameters function.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch of data from the DataLoader.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, ...]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[torch.Tensor, dict[str, Any]]: Loss and metrics for the batch.
tuple of (loss, metrics)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="nd">@BaseTrainer</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s2">&quot;train_batch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_train_batch</span><span class="p">(</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">    Runs a single training batch, performing optimization.</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">    We use the step function to optimize the model based on use_grad.</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">        use_grad = True entails gradient based optimization, for which we use</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">        optimize_step function.</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">        use_grad = False entails gradient free optimization, for which we use</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">        update_ng_parameters function.</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        batch (tuple[torch.Tensor, ...]): Batch of data from the DataLoader.</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">        tuple[torch.Tensor, dict[str, Any]]: Loss and metrics for the batch.</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">            tuple of (loss, metrics)</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span><span class="p">:</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="c1"># Perform gradient-based optimization</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>        <span class="n">loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimize_step</span><span class="p">(</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>            <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>            <span class="n">optimizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>            <span class="n">loss_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">,</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>            <span class="n">xs</span><span class="o">=</span><span class="n">batch</span><span class="p">,</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>            <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>            <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">data_dtype</span><span class="p">,</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>        <span class="p">)</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="c1"># Perform optimization using Nevergrad</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>        <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">ng_params</span> <span class="o">=</span> <span class="n">update_ng_parameters</span><span class="p">(</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="n">optimizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="n">loss_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">,</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>            <span class="n">data</span><span class="o">=</span><span class="n">batch</span><span class="p">,</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>            <span class="n">ng_params</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ng_params</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="p">)</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ng_params</span> <span class="o">=</span> <span class="n">ng_params</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>        <span class="n">loss_metrics</span> <span class="o">=</span> <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modify_batch_end_loss_metrics</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.run_training" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_training</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Runs the training for a single epoch, iterating over multiple batches.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>list[tuple[torch.Tensor, dict[str, Any]]]: Loss and metrics for each batch.
list                  -&gt; tuples
Training Batches      -&gt; (loss, metrics)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="nd">@BaseTrainer</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s2">&quot;train_epoch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_training</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">    Runs the training for a single epoch, iterating over multiple batches.</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">        dataloader (DataLoader): DataLoader for training data.</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        list[tuple[torch.Tensor, dict[str, Any]]]: Loss and metrics for each batch.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">            list                  -&gt; tuples</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">            Training Batches      -&gt; (loss, metrics)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="n">train_epoch_loss_metrics</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch_iter</span><span class="p">(</span><span class="n">dataloader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_training_batches</span><span class="p">):</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_train_batch_start</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="n">train_batch_loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_train_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">all_reduce_metrics</span><span class="p">:</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="n">train_batch_loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_result</span><span class="p">(</span><span class="n">train_batch_loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="n">train_epoch_loss_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_batch_loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_train_batch_end</span><span class="p">(</span><span class="n">train_batch_loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>    <span class="k">return</span> <span class="n">train_epoch_loss_metrics</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.run_val_batch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_val_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Runs a single validation batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch of data from the DataLoader.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, ...]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[torch.Tensor, dict[str, Any]]: Loss and metrics for the batch.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="nd">@BaseTrainer</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s2">&quot;val_batch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_val_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">    Runs a single validation batch.</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">        batch (tuple[torch.Tensor, ...]): Batch of data from the DataLoader.</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">        tuple[torch.Tensor, dict[str, Any]]: Loss and metrics for the batch.</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="n">loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modify_batch_end_loss_metrics</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.run_validation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_validation</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Runs the validation loop for a single epoch, iterating over multiple batches.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>list[tuple[torch.Tensor, dict[str, Any]]]: Loss and metrics for each batch.
list                  -&gt; tuples
Validation Batches      -&gt; (loss, metrics)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="nd">@BaseTrainer</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s2">&quot;val_epoch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">    Runs the validation loop for a single epoch, iterating over multiple batches.</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">        dataloader (DataLoader): DataLoader for validation data.</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">        list[tuple[torch.Tensor, dict[str, Any]]]: Loss and metrics for each batch.</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">            list                  -&gt; tuples</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">            Validation Batches      -&gt; (loss, metrics)</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>    <span class="n">val_epoch_loss_metrics</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch_iter</span><span class="p">(</span><span class="n">dataloader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_validation_batches</span><span class="p">):</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_val_batch_start</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>        <span class="n">val_batch_loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_val_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">all_reduce_metrics</span><span class="p">:</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>            <span class="n">val_batch_loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregate_result</span><span class="p">(</span><span class="n">val_batch_loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="n">val_epoch_loss_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val_batch_loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_val_batch_end</span><span class="p">(</span><span class="n">val_batch_loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>    <span class="k">return</span> <span class="n">val_epoch_loss_metrics</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.stop_training" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stop_training</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Helper function to indicate if the training should be stopped.</p>
<p>We all_reduce the indicator across all processes to ensure all processes are stopped.</p>


<details class="notes" open>
  <summary>Notes</summary>
  <p>self._stop_training indicator indicates if the training should be stopped.
0 is continue. 1 is stop.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="k">def</span><span class="w"> </span><span class="nf">stop_training</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">    Helper function to indicate if the training should be stopped.</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="sd">    We all_reduce the indicator across all processes to ensure all processes are stopped.</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">        self._stop_training indicator indicates if the training should be stopped.</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="sd">        0 is continue. 1 is stop.</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="n">_stop_training</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">all_reduce_dict</span><span class="p">(</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>        <span class="p">{</span><span class="s2">&quot;indicator&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_training</span><span class="p">},</span> <span class="n">op</span><span class="o">=</span><span class="s2">&quot;max&quot;</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>    <span class="p">)</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">_stop_training</span><span class="p">[</span><span class="s2">&quot;indicator&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.test" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">test</span><span class="p">(</span><span class="n">test_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Runs the testing loop if a test DataLoader is provided.</p>
<p>if the test_dataloader is not provided, default test_dataloader defined
in the Trainer class is used.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>test_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for test data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>list[tuple[torch.Tensor, dict[str, Any]]]: Loss and metrics for each batch.
list                    -&gt; tuples
Test Batches            -&gt; (loss, metrics)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="k">def</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">    Runs the testing loop if a test DataLoader is provided.</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">    if the test_dataloader is not provided, default test_dataloader defined</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">    in the Trainer class is used.</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">        test_dataloader (DataLoader): DataLoader for test data.</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">        list[tuple[torch.Tensor, dict[str, Any]]]: Loss and metrics for each batch.</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">            list                    -&gt; tuples</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">            Test Batches            -&gt; (loss, metrics)</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>    <span class="k">if</span> <span class="n">test_dataloader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">test_dataloader</span> <span class="o">=</span> <span class="n">test_dataloader</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>    <span class="n">test_loss_metrics</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch_iter</span><span class="p">(</span><span class="n">test_dataloader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_training_batches</span><span class="p">):</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_test_batch_start</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="n">loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_test_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="n">test_loss_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_test_batch_end</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>    <span class="k">return</span> <span class="n">test_loss_metrics</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.config.AnsatzConfig" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">AnsatzConfig</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ansatz_type</span><span class="o">=</span><span class="n">AnsatzType</span><span class="o">.</span><span class="n">HEA</span><span class="p">,</span> <span class="n">ansatz_strategy</span><span class="o">=</span><span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span><span class="p">,</span> <span class="n">strategy_args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="n">m_block_qubits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">param_prefix</span><span class="o">=</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">











  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.AnsatzConfig.ansatz_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ansatz_strategy</span> <span class="o">=</span> <span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Ansatz strategy.</p>
<p><code>Strategy.DIGITAL</code> for fully digital ansatz. Required if <code>ansatz_type</code> is <code>AnsatzType.ALA</code>.
<code>Strategy.SDAQC</code> for analog entangling block. Only available for <code>AnsatzType.HEA</code> or
<code>AnsatzType.ALA</code>.
<code>Strategy.RYDBERG</code> for fully rydberg hea ansatz. Only available for <code>AnsatzType.HEA</code>.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.AnsatzConfig.ansatz_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ansatz_type</span> <span class="o">=</span> <span class="n">AnsatzType</span><span class="o">.</span><span class="n">HEA</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>What type of ansatz.</p>
<p><code>AnsatzType.HEA</code> for Hardware Efficient Ansatz.
<code>AnsatzType.IIA</code> for Identity Intialized Ansatz.
<code>AnsatzType.ALA</code> for Alternating Layer Ansatz.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.AnsatzConfig.depth" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">depth</span> <span class="o">=</span> <span class="mi">1</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Number of layers of the ansatz.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.AnsatzConfig.m_block_qubits" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">m_block_qubits</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The number of qubits in the local entangling block of an Alternating Layer Ansatz (ALA).</p>
<p>Only used when <code>ansatz_type</code> is <code>AnsatzType.ALA</code>.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.AnsatzConfig.param_prefix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">param_prefix</span> <span class="o">=</span> <span class="s1">&#39;theta&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The base bame of the variational parameter.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.AnsatzConfig.strategy_args" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">strategy_args</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A dictionary containing keyword arguments to the function creating the ansatz.</p>
<p>Details about each below.</p>
<p>For <code>Strategy.DIGITAL</code> strategy, accepts the following:
    periodic (bool): if the qubits should be linked periodically.
        periodic=False is not supported in emu-c.
    operations (list): list of operations to cycle through in the
        digital single-qubit rotations of each layer.
        Defaults to  [RX, RY, RX] for hea and [RX, RY] for iia.
    entangler (AbstractBlock): 2-qubit entangling operation.
        Supports CNOT, CZ, CRX, CRY, CRZ, CPHASE. Controlld rotations
        will have variational parameters on the rotation angles.
        Defaults to CNOT</p>
<p>For <code>Strategy.SDAQC</code> strategy, accepts the following:
    operations (list): list of operations to cycle through in the
        digital single-qubit rotations of each layer.
        Defaults to  [RX, RY, RX] for hea and [RX, RY] for iia.
    entangler (AbstractBlock): Hamiltonian generator for the
        analog entangling layer. Time parameter is considered variational.
        Defaults to NN interaction.</p>
<p>For <code>Strategy.RYDBERG</code> strategy, accepts the following:
    addressable_detuning: whether to turn on the trainable semi-local addressing pattern
        on the detuning (n_i terms in the Hamiltonian).
        Defaults to True.
    addressable_drive: whether to turn on the trainable semi-local addressing pattern
        on the drive (sigma_i^x terms in the Hamiltonian).
        Defaults to False.
    tunable_phase: whether to have a tunable phase to get both sigma^x and sigma^y rotations
        in the drive term. If False, only a sigma^x term will be included in the drive part
        of the Hamiltonian generator.
        Defaults to False.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.AnsatzConfig.tag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tag</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>String to indicate the name tag of the ansatz.</p>
<p>Defaults to None, in which case no tag will be applied.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.config.FeatureMapConfig" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">FeatureMapConfig</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span><span class="p">,</span> <span class="n">reupload_scaling</span><span class="o">=</span><span class="n">ReuploadScaling</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">,</span> <span class="n">feature_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">multivariate_strategy</span><span class="o">=</span><span class="n">MultivariateStrategy</span><span class="o">.</span><span class="n">PARALLEL</span><span class="p">,</span> <span class="n">feature_map_strategy</span><span class="o">=</span><span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span><span class="p">,</span> <span class="n">param_prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_repeats</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">











  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.basis_set" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basis_set</span> <span class="o">=</span> <span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Basis set for feature encoding.</p>
<p>Takes qadence.BasisSet.
Give a single BasisSet to use the same for all features.
Give a dict of (str, BasisSet) where the key is the name of the variable and the
value is the BasisSet to use for encoding that feature.
BasisSet.FOURIER for Fourier encoding.
BasisSet.CHEBYSHEV for Chebyshev encoding.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.feature_map_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_map_strategy</span> <span class="o">=</span> <span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Strategy for feature map.</p>
<p>Accepts DIGITAL, ANALOG or RYDBERG. Defaults to DIGITAL.
If the strategy is incompatible with the <code>operation</code> chosen, then <code>operation</code>
gets preference and the given strategy is ignored.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.feature_range" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_range</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Range of data that the input data is assumed to come from.</p>
<p>Give a single tuple to use the same range for all features.
Give a dict of (str, tuple) where the key is the name of the variable and the
value is the feature range to use for that feature.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.inputs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">inputs</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>List that indicates the order of variables of the tensors that are passed.</p>
<p>Optional if a single feature is being encoded, required otherwise. Given input tensors
<code>xs = torch.rand(batch_size, input_size:=2)</code> a QNN with <code>inputs=["t", "x"]</code> will
assign <code>t, x = xs[:,0], xs[:,1]</code>.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.multivariate_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">multivariate_strategy</span> <span class="o">=</span> <span class="n">MultivariateStrategy</span><span class="o">.</span><span class="n">PARALLEL</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The encoding strategy in case of multi-variate function.</p>
<p>Takes qadence.MultivariateStrategy.
If PARALLEL, the features are encoded in one block of rotation gates
with the register being split in sub-registers for each feature.
If SERIES, the features are encoded sequentially using the full register for each feature, with
an ansatz block between them. PARALLEL is allowed only for DIGITAL <code>feature_map_strategy</code>.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.num_features" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_features</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Number of feature parameters to be encoded.</p>
<p>Defaults to 0. Thus, no feature parameters are encoded.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.num_repeats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_repeats</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Number of feature map layers repeated in the data reuploading step.</p>
<p>If all features are to be repeated the same number of times, then can give a single
<code>int</code>. For different number of repetitions for each feature, provide a dict
of (str, int) where the key is the name of the variable and the value is the
number of repetitions for that feature.
This amounts to the number of additional reuploads. So if <code>num_repeats</code> is N,
the data gets uploaded N+1 times. Defaults to no repetition.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.operation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">operation</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Type of operation.</p>
<p>Choose among the analog or digital rotations or a custom
callable function returning an AnalogBlock instance. If the type of operation is
incompatible with the <code>strategy</code> chosen, then <code>operation</code> gets preference and
the given strategy is ignored.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.param_prefix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">param_prefix</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>String prefix to create trainable parameters in Feature Map.</p>
<p>A string prefix to create trainable parameters multiplying the feature parameter
inside the feature-encoding function. Note that currently this does not take into
account the domain of the feature-encoding function.
Defaults to <code>None</code> and thus, the feature map is not trainable.
Note that this is separate from the name of the parameter.
The user can provide a single prefix for all features, and it will be appended
by appropriate feature name automatically.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.reupload_scaling" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reupload_scaling</span> <span class="o">=</span> <span class="n">ReuploadScaling</span><span class="o">.</span><span class="n">CONSTANT</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Scaling for encoding the same feature on different qubits.</p>
<p>Scaling used to encode the same feature on different qubits in the
same layer of the feature maps. Takes qadence.ReuploadScaling.
Give a single ReuploadScaling to use the same for all features.
Give a dict of (str, ReuploadScaling) where the key is the name of the variable and the
value is the ReuploadScaling to use for encoding that feature.
ReuploadScaling.CONSTANT for constant scaling.
ReuploadScaling.TOWER for linearly increasing scaling.
ReuploadScaling.EXP for exponentially increasing scaling.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.tag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tag</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>String to indicate the name tag of the feature map.</p>
<p>Defaults to None, in which case no tag will be applied.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.target_range" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">target_range</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Range of data the data encoder assumes as natural range.</p>
<p>Give a single tuple to use the same range for all features.
Give a dict of (str, tuple) where the key is the name of the variable and the
value is the target range to use for that feature.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.config.TrainConfig" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">TrainConfig</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">print_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">write_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">checkpoint_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">plot_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">list</span><span class="p">()(),</span> <span class="n">log_model</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">root_folder</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./qml_logs&#39;</span><span class="p">),</span> <span class="n">create_subfolder_per_run</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_folder</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">),</span> <span class="n">checkpoint_best_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">val_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">val_epsilon</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">validation_criterion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trainstop_criterion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tracking_tool</span><span class="o">=</span><span class="n">ExperimentTrackingTool</span><span class="o">.</span><span class="n">TENSORBOARD</span><span class="p">,</span> <span class="n">hyperparams</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="n">plotting_functions</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(),</span> <span class="n">_subfolders</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span> <span class="n">nprocs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">compute_setup</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;gloo&#39;</span><span class="p">,</span> <span class="n">log_setup</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">all_reduce_metrics</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Default configuration for the training process.</p>
<p>This class provides default settings for various aspects of the training loop,
such as logging, checkpointing, and validation. The default values for these
fields can be customized when an instance of <code>TrainConfig</code> is created.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">c</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span><span class="n">root_folder</span><span class="o">=</span><span class="s2">&quot;/tmp/train&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="err">Trai</span><span class="kc">n</span><span class="err">Co</span><span class="kc">nf</span><span class="err">ig(max_i</span><span class="kc">ter</span><span class="err">=</span><span class="mi">10000</span><span class="p">,</span><span class="w"> </span><span class="err">pri</span><span class="kc">nt</span><span class="err">_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">wri</span><span class="kc">te</span><span class="err">_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">checkpoi</span><span class="kc">nt</span><span class="err">_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">plo</span><span class="kc">t</span><span class="err">_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">callbacks=</span><span class="p">[],</span><span class="w"> </span><span class="err">log_model=False</span><span class="p">,</span><span class="w"> </span><span class="err">roo</span><span class="kc">t</span><span class="err">_</span><span class="kc">f</span><span class="err">older=&#39;/</span><span class="kc">t</span><span class="err">mp/</span><span class="kc">tra</span><span class="err">i</span><span class="kc">n</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">crea</span><span class="kc">te</span><span class="err">_sub</span><span class="kc">f</span><span class="err">older_per_ru</span><span class="kc">n</span><span class="err">=False</span><span class="p">,</span><span class="w"> </span><span class="err">log_</span><span class="kc">f</span><span class="err">older=PosixPa</span><span class="kc">t</span><span class="err">h(&#39;.&#39;)</span><span class="p">,</span><span class="w"> </span><span class="err">checkpoi</span><span class="kc">nt</span><span class="err">_bes</span><span class="kc">t</span><span class="err">_o</span><span class="kc">nl</span><span class="err">y=False</span><span class="p">,</span><span class="w"> </span><span class="err">val_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">val_epsilo</span><span class="kc">n</span><span class="err">=</span><span class="mf">1e-05</span><span class="p">,</span><span class="w"> </span><span class="err">valida</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">_cri</span><span class="kc">ter</span><span class="err">io</span><span class="kc">n</span><span class="err">=No</span><span class="kc">ne</span><span class="p">,</span><span class="w"> </span><span class="kc">tra</span><span class="err">i</span><span class="kc">nst</span><span class="err">op_cri</span><span class="kc">ter</span><span class="err">io</span><span class="kc">n</span><span class="err">=No</span><span class="kc">ne</span><span class="p">,</span><span class="w"> </span><span class="err">ba</span><span class="kc">t</span><span class="err">ch_size=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">verbose=True</span><span class="p">,</span><span class="w"> </span><span class="kc">tra</span><span class="err">cki</span><span class="kc">n</span><span class="err">g_</span><span class="kc">t</span><span class="err">ool=&lt;Experime</span><span class="kc">nt</span><span class="err">Tracki</span><span class="kc">n</span><span class="err">gTool.TENSORBOARD</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="kc">tens</span><span class="err">orboard&#39;&gt;</span><span class="p">,</span><span class="w"> </span><span class="err">hyperparams=</span><span class="p">{},</span><span class="w"> </span><span class="err">plo</span><span class="kc">tt</span><span class="err">i</span><span class="kc">n</span><span class="err">g_</span><span class="kc">fun</span><span class="err">c</span><span class="kc">t</span><span class="err">io</span><span class="kc">ns</span><span class="err">=()</span><span class="p">,</span><span class="w"> </span><span class="err">_sub</span><span class="kc">f</span><span class="err">olders=</span><span class="p">[],</span><span class="w"> </span><span class="kc">n</span><span class="err">procs=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">compu</span><span class="kc">te</span><span class="err">_se</span><span class="kc">tu</span><span class="err">p=&#39;cpu&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">backe</span><span class="kc">n</span><span class="err">d=&#39;gloo&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">log_se</span><span class="kc">tu</span><span class="err">p=&#39;cpu&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">d</span><span class="kc">t</span><span class="err">ype=No</span><span class="kc">ne</span><span class="p">,</span><span class="w"> </span><span class="err">all_reduce_me</span><span class="kc">tr</span><span class="err">ics=False)</span>
</code></pre></div>

</div></p>










  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.all_reduce_metrics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">all_reduce_metrics</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Whether to aggregate metrics (e.g., loss, accuracy) across processes.</p>
<p>When True, metrics from different training processes are averaged to provide a consolidated metrics.
Note: Since aggregation requires synchronization/all_reduce operation, this can increase the
 computation time significantly.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.backend" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">backend</span> <span class="o">=</span> <span class="s1">&#39;gloo&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Backend used for distributed training communication.</p>
<p>The default is "gloo". Other options may include "nccl" - which is optimized for GPU-based training or "mpi",
depending on your system and requirements.
It should be one of the backends supported by <code>torch.distributed</code>. For further details, please look at
<a href="https://pytorch.org/docs/stable/distributed.html#torch.distributed.Backend">torch backends</a></p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.batch_size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The batch size to use when processing a list or tuple of torch.Tensors.</p>
<p>This specifies how many samples are processed in each training iteration.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.callbacks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">callbacks</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">list</span><span class="p">())</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>List of callbacks to execute during training.</p>
<p>Callbacks can be used for
custom behaviors, such as early stopping, custom logging, or other actions
triggered at specific events.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.checkpoint_best_only" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">checkpoint_best_only</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>If <code>True</code>, checkpoints are only saved if there is an improvement in the.</p>
<p>validation metric. This conserves storage by only keeping the best models.</p>
<p>validation_criterion is required when this is set to True.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.checkpoint_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">checkpoint_every</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Frequency (in epochs) for saving model and optimizer checkpoints during training.</p>
<p>Set to 0 to disable checkpointing. This helps in resuming training or recovering
models.
Note that setting checkpoint_best_only = True will disable this and only best checkpoints will
be saved.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.compute_setup" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_setup</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Compute device setup; options are "auto", "gpu", or "cpu".</p>
<ul>
<li>"auto": Automatically uses GPU if available; otherwise, falls back to CPU.</li>
<li>"gpu": Forces GPU usage, raising an error if no CUDA device is available.</li>
<li>"cpu": Forces the use of CPU regardless of GPU availability.</li>
</ul>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.create_subfolder_per_run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_subfolder_per_run</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Whether to create a subfolder for each run, named <code>&lt;id&gt;_&lt;timestamp&gt;_&lt;PID&gt;</code>.</p>
<p>This ensures logs and checkpoints from different runs do not overwrite each other,
which is helpful for rapid prototyping. If <code>False</code>, training will resume from
the latest checkpoint if one exists in the specified log folder.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.dtype" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Data type (precision) for computations.</p>
<p>Both model parameters, and dataset will be of the provided precision.</p>
<p>If not specified or None, the default torch precision (usually torch.float32) is used.
If provided dtype is torch.complex128, model parameters will be torch.complex128, and data parameters will be torch.float64</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.hyperparams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hyperparams</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A dictionary of hyperparameters to be tracked.</p>
<p>This can include learning rates,
regularization parameters, or any other training-related configurations.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.log_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The log folder for saving checkpoints and tensorboard logs.</p>
<p>This stores the path where all logs and checkpoints are being saved
for this training session. <code>log_folder</code> takes precedence over <code>root_folder</code>,
but it is ignored if <code>create_subfolders_per_run=True</code> (in which case, subfolders
will be spawned in the root folder).</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.log_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_model</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Whether to log a serialized version of the model.</p>
<p>When set to <code>True</code>, the
model's state will be logged, useful for model versioning and reproducibility.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.log_setup" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_setup</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Logging device setup; options are "auto" or "cpu".</p>
<ul>
<li>"auto": Uses the same device for logging as for computation.</li>
<li>"cpu": Forces logging to occur on the CPU. This can be useful to avoid potential conflicts with GPU processes.</li>
</ul>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.max_iter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">10000</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Number of training iterations (epochs) to perform.</p>
<p>This defines the total number
of times the model will be updated.</p>
<p>In case of InfiniteTensorDataset, each epoch will have 1 batch.
In case of TensorDataset, each epoch will have len(dataloader) batches.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.nprocs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nprocs</span> <span class="o">=</span> <span class="mi">1</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The number of processes to use for training when spawning subprocesses.</p>
<p>For effective parallel processing, set this to a value greater than 1.
- In case of Multi-GPU or Multi-Node-Multi-GPU setups, nprocs should be equal to
the total number of GPUs across all nodes (world size), or total number of GPU to be used.</p>
<p>If nprocs &gt; 1, multiple processes will be spawned for training. The training framework will launch
additional processes (e.g., for distributed or parallel training).
- For CPU setup, this will launch a true parallel processes
- For GPU setup, this will launch a distributed training routine.
This uses the DistributedDataParallel framework from PyTorch.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.plot_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_every</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Frequency (in epochs) for generating and saving figures during training.</p>
<p>Set to 0 to disable plotting.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.plotting_functions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plotting_functions</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">tuple</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Functions used for in-training plotting.</p>
<p>These are called to generate
plots that are logged or saved at specified intervals.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.print_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_every</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Frequency (in epochs) for printing loss and metrics to the console during training.</p>
<p>Set to 0 to disable this output, meaning that metrics and loss will not be printed
during training.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.root_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">root_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./qml_logs&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The root folder for saving checkpoints and tensorboard logs.</p>
<p>The default path is "./qml_logs"</p>
<p>This can be set to a specific directory where training artifacts are to be stored.
Checkpoints will be saved inside a subfolder in this directory. Subfolders will be
created based on <code>create_subfolder_per_run</code> argument.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.tracking_tool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tracking_tool</span> <span class="o">=</span> <span class="n">ExperimentTrackingTool</span><span class="o">.</span><span class="n">TENSORBOARD</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The tool used for tracking training progress and logging metrics.</p>
<p>Options include tools like TensorBoard, which help visualize and monitor
model training.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.trainstop_criterion" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trainstop_criterion</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A function to determine if the training process should stop based on a.</p>
<p>specific stopping metric. If <code>None</code>, training continues until <code>max_iter</code> is reached.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.val_epsilon" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">val_epsilon</span> <span class="o">=</span> <span class="mf">1e-05</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A small safety margin used to compare the current validation loss with the.</p>
<p>best previous validation loss. This is used to determine improvements in metrics.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.val_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">val_every</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Frequency (in epochs) for performing validation.</p>
<p>If set to 0, validation is not performed.
Note that metrics from validation are always written, regardless of the <code>write_every</code> setting.
Note that initial validation happens at the start of training (when val_every &gt; 0)
    For initial validation  - initial metrics are written.
                            - checkpoint is saved (when checkpoint_best_only = False)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.validation_criterion" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validation_criterion</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A function to evaluate whether a given validation metric meets a desired condition.</p>
<p>The validation_criterion has the following format:
def validation_criterion(val_loss: float, best_val_loss: float, val_epsilon: float) -&gt; bool:
    # process</p>
<p>If <code>None</code>, no custom validation criterion is applied.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.verbose" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Whether to print metrics and status messages during training.</p>
<p>If <code>True</code>, detailed metrics and status updates will be displayed in the console.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.write_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_every</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Frequency (in epochs) for writing loss and metrics using the tracking tool during training.</p>
<p>Set to 0 to disable this logging, which prevents metrics from being logged to the tracking tool.
Note that the metrics will always be written at the end of training regardless of this setting.</p>

    </div>

</div>





  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.parameters.get_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve all trainable model parameters in a single vector.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>the input PyTorch model</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Tensor</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>a 1-dimensional tensor with the parameters</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.Tensor">Tensor</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/parameters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve all trainable model parameters in a single vector.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        model (Module): the input PyTorch model</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        Tensor: a 1-dimensional tensor with the parameters</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">]</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.parameters.num_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the total number of parameters of the given model.</p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/parameters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="k">def</span><span class="w"> </span><span class="nf">num_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the total number of parameters of the given model.&quot;&quot;&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.parameters.set_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set all trainable parameters of a model from a single vector.</p>
<p>Notice that this function assumes prior knowledge of right number
of parameters in the model</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>the input PyTorch model</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>theta</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>the parameters to assign</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.Tensor">Tensor</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/parameters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set all trainable parameters of a model from a single vector.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Notice that this function assumes prior knowledge of right number</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    of parameters in the model</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        model (Module): the input PyTorch model</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        theta (Tensor): the parameters to assign</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="k">for</span> <span class="n">ps</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>            <span class="k">if</span> <span class="n">ps</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>                <span class="n">n</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">numel</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>                <span class="k">if</span> <span class="n">ps</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>                    <span class="n">ps</span><span class="p">[()]</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">idx</span> <span class="p">:</span> <span class="n">idx</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>                    <span class="n">ps</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">idx</span> <span class="p">:</span> <span class="n">idx</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ps</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>                <span class="n">idx</span> <span class="o">+=</span> <span class="n">n</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.optimize_step.optimize_step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimize_step</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Default Torch optimize step with closure.</p>
<p>This is the default optimization step.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The input model to be optimized.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The chosen Torch optimizer.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.optim.Optimizer">Optimizer</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_fn</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A custom loss function
that returns the loss value and a dictionary of metrics.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Callable">Callable</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The input data. If None, it means
the given model does not require any input data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span> | <span title="list">list</span> | <span title="qadence.backend.Tensor">Tensor</span> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A target device to run computations on.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.device">device</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Data type for <code>xs</code> conversion.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.dtype">dtype</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span> | <span title="float">float</span>, <span title="dict">dict</span> | None]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[Tensor | float, dict | None]: A tuple containing the computed loss value
and a dictionary with collected metrics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/optimize_step.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">optimize_step</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">optimizer</span><span class="p">:</span> <span class="n">Optimizer</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">loss_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">xs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Default Torch optimize step with closure.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    This is the default optimization step.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        model (Module): The input model to be optimized.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        optimizer (Optimizer): The chosen Torch optimizer.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        loss_fn (Callable): A custom loss function</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">            that returns the loss value and a dictionary of metrics.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        xs (dict | list | Tensor | None): The input data. If None, it means</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">            the given model does not require any input data.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        device (torch.device): A target device to run computations on.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        dtype (torch.dtype): Data type for `xs` conversion.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        tuple[Tensor | float, dict | None]: A tuple containing the computed loss value</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            and a dictionary with collected metrics.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{}</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">closure</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="c1"># NOTE: We need the nonlocal as we can&#39;t return a metric dict and</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="c1"># because e.g. LBFGS calls this closure multiple times but for some</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="c1"># reason the returned loss is always the first one...</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="k">nonlocal</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">loss</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">retain_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="k">return</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">closure</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="c1"># return the loss/metrics that are being mutated inside the closure...</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.optimize_step.update_ng_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_ng_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ng_params</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Update the model parameters using Nevergrad.</p>
<p>This function integrates Nevergrad for derivative-free optimization.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The PyTorch model to be optimized.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A Nevergrad optimizer instance.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="nevergrad.optimizers.Optimizer">Optimizer</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_fn</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A custom loss function
that returns the loss value and a dictionary of metrics.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Callable">Callable</span>[[<span title="torch.nn.Module">Module</span>, <span title="qadence.backend.Tensor">Tensor</span> | None], <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="dict">dict</span>]]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Input data for the model. If None, it means the model does
not require input data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="qadence.backend.Tensor">Tensor</span> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ng_params</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current set of parameters managed by Nevergrad.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="nevergrad.p.Array">Array</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="dict">dict</span>, <span title="nevergrad.p.Array">Array</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[float, dict, ng.p.Array]: A tuple containing the computed loss value,
a dictionary of metrics, and the updated Nevergrad parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/optimize_step.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_ng_parameters</span><span class="p">(</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">optimizer</span><span class="p">:</span> <span class="n">ng</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">loss_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Module</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]],</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">ng_params</span><span class="p">:</span> <span class="n">ng</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">ng</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Array</span><span class="p">]:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the model parameters using Nevergrad.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    This function integrates Nevergrad for derivative-free optimization.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        model (Module): The PyTorch model to be optimized.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        optimizer (ng.optimizers.Optimizer): A Nevergrad optimizer instance.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        loss_fn (Callable[[Module, Tensor | None], tuple[float, dict]]): A custom loss function</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            that returns the loss value and a dictionary of metrics.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        data (Tensor | None): Input data for the model. If None, it means the model does</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            not require input data.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        ng_params (ng.p.Array): The current set of parameters managed by Nevergrad.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        tuple[float, dict, ng.p.Array]: A tuple containing the computed loss value,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">            a dictionary of metrics, and the updated Nevergrad parameters.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">optimizer</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">ng_params</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">loss</span><span class="p">))</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">ng_params</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">ask</span><span class="p">()</span>  <span class="c1"># type: ignore[assignment]</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">params</span> <span class="o">=</span> <span class="n">promote_to_tensor</span><span class="p">(</span><span class="n">ng_params</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">set_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">ng_params</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.data.DictDataLoader" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">DictDataLoader</span><span class="p">(</span><span class="n">dataloaders</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>This class only holds a dictionary of <code>DataLoader</code>s and samples from them.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.data.InfiniteTensorDataset" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">InfiniteTensorDataset</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.utils.data.IterableDataset">IterableDataset</span></code></p>


        <p>Randomly sample points from the first dimension of the given tensors.</p>
<p>Behaves like a normal torch <code>Dataset</code> just that we can sample from it as
many times as we want.</p>
<p>Examples:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">InfiniteTensorDataset</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># The dataset accepts any number of tensors with the same batch dimension</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">ds</span> <span class="o">=</span> <span class="n">InfiniteTensorDataset</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1"># call `next` to get one sample from each tensor:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">xs</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ds</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="err">(</span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.9750</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7602</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">1.</span><span class="p">]</span><span class="err">))</span>
</code></pre></div></p>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/data.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">tensors</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Randomly sample points from the first dimension of the given tensors.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    Behaves like a normal torch `Dataset` just that we can sample from it as</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    many times as we want.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    ```python exec=&quot;on&quot; source=&quot;above&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    from qadence.ml_tools.data import InfiniteTensorDataset</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    x_data, y_data = torch.rand(5,2), torch.ones(5,1)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    # The dataset accepts any number of tensors with the same batch dimension</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    ds = InfiniteTensorDataset(x_data, y_data)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    # call `next` to get one sample from each tensor:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    xs = next(iter(ds))</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    print(str(xs)) # markdown-exec: hide</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    ```</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tensors</span> <span class="o">=</span> <span class="n">tensors</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tensors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.data.OptimizeResult" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">OptimizeResult</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">()(),</span> <span class="n">extra</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">()(),</span> <span class="n">rank</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>OptimizeResult stores many optimization intermediate values.</p>
<p>We store at a current iteration,
the model, optimizer, loss values, metrics. An extra dict
can be used for saving other information to be used for callbacks.</p>










  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.device" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Device on which this result for calculated.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.extra" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extra</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">())</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Extra dict for saving anything else to be used in callbacks.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.iteration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">iteration</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Current iteration number.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.loss" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">loss</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Loss value.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.metrics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">metrics</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">())</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Metrics that can be saved during training.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Model at iteration.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.optimizer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimizer</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Optimizer at iteration.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.rank" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rank</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Rank of the process for which this result was generated.</p>

    </div>

</div>





  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.data.data_to_device" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">data_to_device</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Utility method to move arbitrary data to 'device'.</p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="nd">@singledispatch</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="k">def</span><span class="w"> </span><span class="nf">data_to_device</span><span class="p">(</span><span class="n">xs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Utility method to move arbitrary data to &#39;device&#39;.&quot;&quot;&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unable to move </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="si">}</span><span class="s2"> with input args: </span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2"> and kwargs: </span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.data.to_dataloader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dataloader</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">infinite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert torch tensors an (infinite) Dataloader.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*tensors</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Torch tensors to use in the dataloader.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.Tensor">Tensor</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>()</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>batch size of sampled tensors</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>infinite</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>if <code>True</code>, the dataloader will keep sampling indefinitely even after the whole
dataset was sampled once</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Examples:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_dataloader</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">loader</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">to_dataloader</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">infinite</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">loader</span><span class="p">))</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">loader</span><span class="p">))</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">loader</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">[</span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.8499</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7041</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0603</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5398</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2357</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.2391</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2211</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3944</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5225</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5483</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.1385</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9408</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9767</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1692</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4859</span><span class="p">]</span><span class="err">)</span><span class="p">]</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="p">[</span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.0267</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1633</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4347</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6979</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8541</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.2087</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4923</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2158</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0043</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1754</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.2473</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0796</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8167</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8581</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9829</span><span class="p">]</span><span class="err">)</span><span class="p">]</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="p">[</span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.8499</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7041</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0603</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5398</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2357</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.2391</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2211</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3944</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5225</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5483</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.1385</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9408</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9767</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1692</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4859</span><span class="p">]</span><span class="err">)</span><span class="p">]</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_dataloader</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">infinite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert torch tensors an (infinite) Dataloader.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        *tensors: Torch tensors to use in the dataloader.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        batch_size: batch size of sampled tensors</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        infinite: if `True`, the dataloader will keep sampling indefinitely even after the whole</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            dataset was sampled once</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    ```python exec=&quot;on&quot; source=&quot;above&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    from qadence.ml_tools import to_dataloader</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">    (x, y, z) = [torch.rand(10) for _ in range(3)]</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    loader = iter(to_dataloader(x, y, z, batch_size=5, infinite=True))</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    print(next(loader))</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    print(next(loader))</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    print(next(loader))</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    ```</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">ds</span> <span class="o">=</span> <span class="n">InfiniteTensorDataset</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">)</span> <span class="k">if</span> <span class="n">infinite</span> <span class="k">else</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">return</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.models.QNN" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">QNN</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">observable</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">BackendName</span><span class="o">.</span><span class="n">PYQTORCH</span><span class="p">,</span> <span class="n">diff_mode</span><span class="o">=</span><span class="n">DiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">,</span> <span class="n">measurement</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">configuration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">input_diff_mode</span><span class="o">=</span><span class="n">InputDiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="QuantumModel(circuit, observable=None, backend=BackendName.PYQTORCH, diff_mode=DiffMode.AD, measurement=None, noise=None, mitigation=None, configuration=None) (qadence.model.QuantumModel)" href="../models/#qadence.model.QuantumModel">QuantumModel</a></code></p>


        <p>Quantum neural network model for n-dimensional inputs.</p>
<p>Examples:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">QNN</span><span class="p">,</span> <span class="n">Z</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="n">hea</span><span class="p">,</span> <span class="n">feature_map</span><span class="p">,</span> <span class="n">hamiltonian_factory</span><span class="p">,</span> <span class="n">kron</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># create the circuit</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">n_qubits</span><span class="p">,</span> <span class="n">depth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">fm</span> <span class="o">=</span> <span class="n">kron</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">feature_map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">param</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">feature_map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">param</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">ansatz</span> <span class="o">=</span> <span class="n">hea</span><span class="p">(</span><span class="n">n_qubits</span><span class="o">=</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">ansatz</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">obs_base</span> <span class="o">=</span> <span class="n">hamiltonian_factory</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">detuning</span><span class="o">=</span><span class="n">Z</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="c1"># the QNN will yield two outputs</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">obs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">obs_base</span><span class="p">,</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">obs_base</span><span class="p">]</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="c1"># initialize and use the model</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="n">qnn</span> <span class="o">=</span> <span class="n">QNN</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">])</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">y</span> <span class="o">=</span> <span class="n">qnn</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kc">tens</span><span class="err">or(</span><span class="p">[[</span><span class="mf">1.5648</span><span class="p">,</span><span class="w"> </span><span class="mf">3.1296</span><span class="p">],</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">        </span><span class="p">[</span><span class="mf">1.7350</span><span class="p">,</span><span class="w"> </span><span class="mf">3.4700</span><span class="p">],</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">        </span><span class="p">[</span><span class="mf">1.7590</span><span class="p">,</span><span class="w"> </span><span class="mf">3.5180</span><span class="p">]],</span><span class="w"> </span><span class="err">grad_</span><span class="kc">fn</span><span class="err">=&lt;Ca</span><span class="kc">t</span><span class="err">Backward</span><span class="mi">0</span><span class="err">&gt;)</span>
</code></pre></div>

</div></p>

        <p>Initialize the QNN.</p>
<p>The number of inputs is determined by the feature parameters in the input
quantum circuit while the number of outputs is determined by how many
observables are provided as input</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>circuit</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The quantum circuit to use for the QNN.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="QuantumCircuit(support, *blocks)

  
      dataclass
   (qadence.circuit.QuantumCircuit)" href="../quantumcircuit/#qadence.circuit.QuantumCircuit">QuantumCircuit</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>observable</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The observable.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="AbstractBlock(tag=None, __array_priority__=1000)

  
      dataclass
   (qadence.blocks.abstract.AbstractBlock)" href="../blocks/#qadence.blocks.abstract.AbstractBlock">AbstractBlock</a>] | <a class="autorefs autorefs-internal" title="AbstractBlock(tag=None, __array_priority__=1000)

  
      dataclass
   (qadence.blocks.abstract.AbstractBlock)" href="../blocks/#qadence.blocks.abstract.AbstractBlock">AbstractBlock</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>backend</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The chosen quantum backend.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="qadence.types.BackendName">BackendName</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="qadence.types.BackendName.PYQTORCH">PYQTORCH</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>diff_mode</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The differentiation engine to use. Choices 'gpsr' or 'ad'.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="DiffMode (qadence.types.DiffMode)" href="../types/#qadence.types.DiffMode">DiffMode</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="AD = 'ad'

  
      class-attribute
      instance-attribute
   (qadence.types.DiffMode.AD)" href="../types/#qadence.types.DiffMode.AD">AD</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>measurement</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>optional measurement protocol. If None,
use exact expectation value with a statevector simulator</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="qadence.measurements.Measurements">Measurements</span> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>noise</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A noise model to use.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="NoiseHandler(protocol, options=dict()) (qadence.noise.NoiseHandler)" href="../noise/#qadence.noise.protocols.NoiseHandler">NoiseHandler</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>configuration</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>optional configuration for the backend</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BackendConfiguration(_use_gate_params=True, use_sparse_observable=False, use_gradient_checkpointing=False, use_single_qubit_composition=False, transpilation_passes=None)

  
      dataclass
   (qadence.backend.BackendConfiguration)" href="../backends/backend/#qadence.backend.BackendConfiguration">BackendConfiguration</a> | <span title="dict">dict</span> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>inputs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List that indicates the order of variables of the tensors that are passed
to the model. Given input tensors <code>xs = torch.rand(batch_size, input_size:=2)</code> a QNN
with <code>inputs=["t", "x"]</code> will assign <code>t, x = xs[:,0], xs[:,1]</code>.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="sympy.Basic">Basic</span> | <span title="str">str</span>] | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_diff_mode</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The differentiation mode for the input tensor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="InputDiffMode (qadence.types.InputDiffMode)" href="../types/#qadence.types.InputDiffMode">InputDiffMode</a> | <span title="str">str</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="AD = 'ad'

  
      class-attribute
      instance-attribute
   (qadence.types.InputDiffMode.AD)" href="../types/#qadence.types.InputDiffMode.AD">AD</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/models.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">circuit</span><span class="p">:</span> <span class="n">QuantumCircuit</span><span class="p">,</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="n">observable</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AbstractBlock</span><span class="p">]</span> <span class="o">|</span> <span class="n">AbstractBlock</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">backend</span><span class="p">:</span> <span class="n">BackendName</span> <span class="o">=</span> <span class="n">BackendName</span><span class="o">.</span><span class="n">PYQTORCH</span><span class="p">,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">diff_mode</span><span class="p">:</span> <span class="n">DiffMode</span> <span class="o">=</span> <span class="n">DiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="n">measurement</span><span class="p">:</span> <span class="n">Measurements</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="n">noise</span><span class="p">:</span> <span class="n">NoiseHandler</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">configuration</span><span class="p">:</span> <span class="n">BackendConfiguration</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">inputs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">Basic</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">input_diff_mode</span><span class="p">:</span> <span class="n">InputDiffMode</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">InputDiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="p">):</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the QNN.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    The number of inputs is determined by the feature parameters in the input</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    quantum circuit while the number of outputs is determined by how many</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    observables are provided as input</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        circuit: The quantum circuit to use for the QNN.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        observable: The observable.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        backend: The chosen quantum backend.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        diff_mode: The differentiation engine to use. Choices &#39;gpsr&#39; or &#39;ad&#39;.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        measurement: optional measurement protocol. If None,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            use exact expectation value with a statevector simulator</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        noise: A noise model to use.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        configuration: optional configuration for the backend</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        inputs: List that indicates the order of variables of the tensors that are passed</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            to the model. Given input tensors `xs = torch.rand(batch_size, input_size:=2)` a QNN</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            with `inputs=[&quot;t&quot;, &quot;x&quot;]` will assign `t, x = xs[:,0], xs[:,1]`.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        input_diff_mode: The differentiation mode for the input tensor.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">circuit</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">observable</span><span class="o">=</span><span class="n">observable</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">diff_mode</span><span class="o">=</span><span class="n">diff_mode</span><span class="p">,</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">measurement</span><span class="o">=</span><span class="n">measurement</span><span class="p">,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">configuration</span><span class="o">=</span><span class="n">configuration</span><span class="p">,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You need to provide at least one observable in the QNN constructor&quot;</span><span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">inputs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)):</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">]</span>  <span class="c1"># type: ignore[union-attr]</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">elif</span> <span class="p">(</span><span class="n">inputs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">]</span>  <span class="c1"># type: ignore[union-attr]</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            Your QNN has more than one input. Please provide a list of inputs in the order of</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            your tensor domain. For example, if you want to pass</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            `xs = torch.rand(batch_size, input_size:=3)` to you QNN, where</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            ```</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            t = x[:,0]</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            x = x[:,1]</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">            y = x[:,2]</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">            ```</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            you have to specify</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">            ```</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">            QNN(circuit, observable, inputs=[&quot;t&quot;, &quot;x&quot;, &quot;y&quot;])</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            ```</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">            You can also pass a list of sympy symbols.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">format_to_dict</span> <span class="o">=</span> <span class="n">format_to_dict_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">input_diff_mode</span> <span class="o">=</span> <span class="n">InputDiffMode</span><span class="p">(</span><span class="n">input_diff_mode</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_diff_mode</span> <span class="o">==</span> <span class="n">InputDiffMode</span><span class="o">.</span><span class="n">FD</span><span class="p">:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">qadence.backends.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">finitediff</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__derivative</span> <span class="o">=</span> <span class="n">finitediff</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_diff_mode</span> <span class="o">==</span> <span class="n">InputDiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">:</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__derivative</span> <span class="o">=</span> <span class="n">_torch_derivative</span>  <span class="c1"># type: ignore[assignment]</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unkown forward diff mode: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_diff_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_model_configs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.models.QNN.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a string representation of a QNN.</p>
<p>When creating a QNN from a set of configurations,
we print the configurations used. Otherwise, we use the default printing.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="str">str</span> | <span title="typing.Any">Any</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>str | Any: A string representation of a QNN.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="n">QNN</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.constructors.hamiltonians</span><span class="w"> </span><span class="kn">import</span> <span class="n">Interaction</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">AnsatzConfig</span><span class="p">,</span> <span class="n">FeatureMapConfig</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.constructors</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">ObservableConfig</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.operations</span><span class="w"> </span><span class="kn">import</span> <span class="n">Z</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">BackendName</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">backend</span> <span class="o">=</span> <span class="n">BackendName</span><span class="o">.</span><span class="n">PYQTORCH</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">fm_config</span> <span class="o">=</span> <span class="n">FeatureMapConfig</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">ansatz_config</span> <span class="o">=</span> <span class="n">AnsatzConfig</span><span class="p">()</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">observable_config</span> <span class="o">=</span> <span class="n">ObservableConfig</span><span class="p">(</span><span class="n">detuning</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span> <span class="n">interaction</span><span class="o">=</span><span class="n">Interaction</span><span class="o">.</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">qnn</span> <span class="o">=</span> <span class="n">QNN</span><span class="o">.</span><span class="n">from_configs</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">register</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="n">obs_config</span><span class="o">=</span><span class="n">observable_config</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">fm_config</span><span class="o">=</span><span class="n">fm_config</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">ansatz_config</span><span class="o">=</span><span class="n">ansatz_config</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="err">QNN(</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="err">a</span><span class="kc">nsat</span><span class="err">z_co</span><span class="kc">nf</span><span class="err">ig</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">A</span><span class="kc">nsat</span><span class="err">zCo</span><span class="kc">nf</span><span class="err">ig(dep</span><span class="kc">t</span><span class="err">h=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">a</span><span class="kc">nsat</span><span class="err">z_</span><span class="kc">t</span><span class="err">ype=&lt;A</span><span class="kc">nsat</span><span class="err">zType.HEA</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;hea&#39;&gt;</span><span class="p">,</span><span class="w"> </span><span class="err">a</span><span class="kc">nsat</span><span class="err">z_s</span><span class="kc">trate</span><span class="err">gy=&lt;S</span><span class="kc">trate</span><span class="err">gy.DIGITAL</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;Digi</span><span class="kc">tal</span><span class="err">&#39;&gt;</span><span class="p">,</span><span class="w"> </span><span class="err">s</span><span class="kc">trate</span><span class="err">gy_args=</span><span class="p">{},</span><span class="w"> </span><span class="err">m_block_qubi</span><span class="kc">ts</span><span class="err">=No</span><span class="kc">ne</span><span class="p">,</span><span class="w"> </span><span class="err">param_pre</span><span class="kc">f</span><span class="err">ix=&#39;</span><span class="kc">t</span><span class="err">he</span><span class="kc">ta</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">ta</span><span class="err">g=No</span><span class="kc">ne</span><span class="err">)</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kc">f</span><span class="err">m_co</span><span class="kc">nf</span><span class="err">ig</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">Fea</span><span class="kc">ture</span><span class="err">MapCo</span><span class="kc">nf</span><span class="err">ig(</span><span class="kc">nu</span><span class="err">m_</span><span class="kc">features</span><span class="err">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">basis_se</span><span class="kc">t</span><span class="err">=</span><span class="p">{</span><span class="err">&#39;x&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;BasisSe</span><span class="kc">t</span><span class="err">.FOURIER</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;Fourier&#39;&gt;</span><span class="p">},</span><span class="w"> </span><span class="err">reupload_scali</span><span class="kc">n</span><span class="err">g=</span><span class="p">{</span><span class="err">&#39;x&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;ReuploadScali</span><span class="kc">n</span><span class="err">g.CONSTANT</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;Co</span><span class="kc">nstant</span><span class="err">&#39;&gt;</span><span class="p">},</span><span class="w"> </span><span class="kc">feature</span><span class="err">_ra</span><span class="kc">n</span><span class="err">ge=</span><span class="p">{</span><span class="err">&#39;x&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">No</span><span class="kc">ne</span><span class="p">},</span><span class="w"> </span><span class="kc">tar</span><span class="err">ge</span><span class="kc">t</span><span class="err">_ra</span><span class="kc">n</span><span class="err">ge=</span><span class="p">{</span><span class="err">&#39;x&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">No</span><span class="kc">ne</span><span class="p">},</span><span class="w"> </span><span class="err">mul</span><span class="kc">t</span><span class="err">ivaria</span><span class="kc">te</span><span class="err">_s</span><span class="kc">trate</span><span class="err">gy=&lt;Mul</span><span class="kc">t</span><span class="err">ivaria</span><span class="kc">te</span><span class="err">S</span><span class="kc">trate</span><span class="err">gy.PARALLEL</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;Parallel&#39;&gt;</span><span class="p">,</span><span class="w"> </span><span class="kc">feature</span><span class="err">_map_s</span><span class="kc">trate</span><span class="err">gy=&lt;S</span><span class="kc">trate</span><span class="err">gy.DIGITAL</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;Digi</span><span class="kc">tal</span><span class="err">&#39;&gt;</span><span class="p">,</span><span class="w"> </span><span class="err">param_pre</span><span class="kc">f</span><span class="err">ix=No</span><span class="kc">ne</span><span class="p">,</span><span class="w"> </span><span class="kc">nu</span><span class="err">m_repea</span><span class="kc">ts</span><span class="err">=</span><span class="p">{</span><span class="err">&#39;x&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="err">opera</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">=&lt;class</span><span class="w"> </span><span class="err">&#39;qade</span><span class="kc">n</span><span class="err">ce.opera</span><span class="kc">t</span><span class="err">io</span><span class="kc">ns</span><span class="err">.parame</span><span class="kc">tr</span><span class="err">ic.RX&#39;&gt;</span><span class="p">,</span><span class="w"> </span><span class="err">i</span><span class="kc">n</span><span class="err">pu</span><span class="kc">ts</span><span class="err">=</span><span class="p">[</span><span class="err">&#39;x&#39;</span><span class="p">],</span><span class="w"> </span><span class="kc">ta</span><span class="err">g=No</span><span class="kc">ne</span><span class="err">)</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="err">regis</span><span class="kc">ter</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">2</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="err">observable_co</span><span class="kc">nf</span><span class="err">ig</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="err">&#39;Obs.&#39;</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;(</span><span class="mi">2</span><span class="w"> </span><span class="err">*</span><span class="w"> </span><span class="err">(Z(</span><span class="mi">0</span><span class="err">)</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">Z(</span><span class="mi">1</span><span class="err">)</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="err">(Z(</span><span class="mi">0</span><span class="err">)</span><span class="w"> </span><span class="err"></span><span class="w"> </span><span class="err">Z(</span><span class="mi">1</span><span class="err">))))&#39;</span><span class="p">}</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="err">)</span>
</code></pre></div>

</div></p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of a QNN.</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">    When creating a QNN from a set of configurations,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">    we print the configurations used. Otherwise, we use the default printing.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        str | Any: A string representation of a QNN.</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    ```python exec=&quot;on&quot; source=&quot;material-block&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">    from qadence import QNN</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    from qadence.constructors.hamiltonians import Interaction</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">    from qadence.ml_tools.config import AnsatzConfig, FeatureMapConfig</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    from qadence.ml_tools.constructors import (</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        ObservableConfig,</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    )</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    from qadence.operations import Z</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">    from qadence.types import BackendName</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">    backend = BackendName.PYQTORCH</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">    fm_config = FeatureMapConfig(num_features=1)</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">    ansatz_config = AnsatzConfig()</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">    observable_config = ObservableConfig(detuning=Z, interaction=Interaction.ZZ, scale=2)</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">    qnn = QNN.from_configs(</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        register=2,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        obs_config=observable_config,</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        fm_config=fm_config,</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        ansatz_config=ansatz_config,</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        backend=backend,</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">    )</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">    print(qnn) # markdown-exec: hide</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">    ```</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_model_configs</span><span class="p">):</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="n">configs_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="p">(</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>                <span class="n">k</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_model_configs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_model_configs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>                <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;observable_config&quot;</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>            <span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="p">)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="n">observable_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observable</span><span class="p">:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="n">observable_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;observable_config = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">observables_to_expression</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="se">\n</span><span class="si">{</span><span class="n">configs_str</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">observable_str</span><span class="si">}</span><span class="se">\n</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.models.QNN.forward" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">measurement</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endianness</span><span class="o">=</span><span class="n">Endianness</span><span class="o">.</span><span class="n">BIG</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Forward pass of the model.</p>
<p>This returns the (differentiable) expectation value of the given observable
operator defined in the constructor. Differently from the base QuantumModel
class, the QNN accepts also a tensor as input for the forward pass. The
tensor is expected to have shape: <code>n_batches x in_features</code> where <code>n_batches</code>
is the number of data points and <code>in_features</code> is the dimensionality of the problem</p>
<p>The output of the forward pass is the expectation value of the input
observable(s). If a single observable is given, the output shape is
<code>n_batches</code> while if multiple observables are given the output shape
is instead <code>n_batches x n_observables</code></p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>the values of the feature parameters</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="torch.Tensor">Tensor</span>] | <span title="torch.Tensor">Tensor</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Initial state.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.Tensor">Tensor</span> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>measurement</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>optional measurement protocol. If None,
use exact expectation value with a statevector simulator</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="qadence.measurements.Measurements">Measurements</span> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>noise</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A noise model to use.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="NoiseHandler(protocol, options=dict()) (qadence.noise.NoiseHandler)" href="../noise/#qadence.noise.protocols.NoiseHandler">NoiseHandler</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>endianness</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Endianness of the resulting bit strings.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="Endianness (qadence.types.Endianness)" href="../types/#qadence.types.Endianness">Endianness</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="BIG = 'Big'

  
      class-attribute
      instance-attribute
   (qadence.types.Endianness.BIG)" href="../types/#qadence.types.Endianness.BIG">BIG</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Tensor</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>a tensor with the expectation value of the observables passed
in the constructor of the model</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.Tensor">Tensor</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]</span> <span class="o">|</span> <span class="n">Tensor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="n">state</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="n">measurement</span><span class="p">:</span> <span class="n">Measurements</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="n">noise</span><span class="p">:</span> <span class="n">NoiseHandler</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="n">endianness</span><span class="p">:</span> <span class="n">Endianness</span> <span class="o">=</span> <span class="n">Endianness</span><span class="o">.</span><span class="n">BIG</span><span class="p">,</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Forward pass of the model.</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    This returns the (differentiable) expectation value of the given observable</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">    operator defined in the constructor. Differently from the base QuantumModel</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">    class, the QNN accepts also a tensor as input for the forward pass. The</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">    tensor is expected to have shape: `n_batches x in_features` where `n_batches`</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    is the number of data points and `in_features` is the dimensionality of the problem</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">    The output of the forward pass is the expectation value of the input</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">    observable(s). If a single observable is given, the output shape is</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">    `n_batches` while if multiple observables are given the output shape</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">    is instead `n_batches x n_observables`</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        values: the values of the feature parameters</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">        state: Initial state.</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        measurement: optional measurement protocol. If None,</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">            use exact expectation value with a statevector simulator</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">        noise: A noise model to use.</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        endianness: Endianness of the resulting bit strings.</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">        Tensor: a tensor with the expectation value of the observables passed</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">            in the constructor of the model</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expectation</span><span class="p">(</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="n">values</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">measurement</span><span class="o">=</span><span class="n">measurement</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span> <span class="n">endianness</span><span class="o">=</span><span class="n">endianness</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.models.QNN.from_configs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_configs</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="n">obs_config</span><span class="p">,</span> <span class="n">fm_config</span><span class="o">=</span><span class="n">FeatureMapConfig</span><span class="p">(),</span> <span class="n">ansatz_config</span><span class="o">=</span><span class="n">AnsatzConfig</span><span class="p">(),</span> <span class="n">backend</span><span class="o">=</span><span class="n">BackendName</span><span class="o">.</span><span class="n">PYQTORCH</span><span class="p">,</span> <span class="n">diff_mode</span><span class="o">=</span><span class="n">DiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">,</span> <span class="n">measurement</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">configuration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">input_diff_mode</span><span class="o">=</span><span class="n">InputDiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Create a QNN from a set of configurations.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>register</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The number of qubits or a register object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span> | <a class="autorefs autorefs-internal" title="Register(support, spacing=1.0, device_specs=DEFAULT_DEVICE) (qadence.register.Register)" href="../register/#qadence.register.Register">Register</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obs_config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration(s)
for the observable(s).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="ObservableConfig(interaction=None, detuning=None, scale=1.0, shift=0.0, trainable_transform=None, tag=None)

  
      dataclass
   (qadence.constructors.ObservableConfig)" href="../constructors/#qadence.constructors.hamiltonians.ObservableConfig">ObservableConfig</a>] | <a class="autorefs autorefs-internal" title="ObservableConfig(interaction=None, detuning=None, scale=1.0, shift=0.0, trainable_transform=None, tag=None)

  
      dataclass
   (qadence.constructors.ObservableConfig)" href="../constructors/#qadence.constructors.hamiltonians.ObservableConfig">ObservableConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fm_config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration for the feature map.
Defaults to no feature encoding block.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="FeatureMapConfig(num_features=0, basis_set=BasisSet.FOURIER, reupload_scaling=ReuploadScaling.CONSTANT, feature_range=None, target_range=None, multivariate_strategy=MultivariateStrategy.PARALLEL, feature_map_strategy=Strategy.DIGITAL, param_prefix=None, num_repeats=0, operation=None, inputs=None, tag=None)

  
      dataclass
   (qadence.ml_tools.config.FeatureMapConfig)" href="#qadence.ml_tools.config.FeatureMapConfig">FeatureMapConfig</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="FeatureMapConfig(num_features=0, basis_set=BasisSet.FOURIER, reupload_scaling=ReuploadScaling.CONSTANT, feature_range=None, target_range=None, multivariate_strategy=MultivariateStrategy.PARALLEL, feature_map_strategy=Strategy.DIGITAL, param_prefix=None, num_repeats=0, operation=None, inputs=None, tag=None)

  
      dataclass
   (qadence.ml_tools.config.FeatureMapConfig)" href="#qadence.ml_tools.config.FeatureMapConfig">FeatureMapConfig</a>()</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ansatz_config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration for the ansatz.
Defaults to a single layer of hardware efficient ansatz.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="AnsatzConfig(depth=1, ansatz_type=AnsatzType.HEA, ansatz_strategy=Strategy.DIGITAL, strategy_args=dict(), m_block_qubits=None, param_prefix='theta', tag=None)

  
      dataclass
   (qadence.ml_tools.config.AnsatzConfig)" href="#qadence.ml_tools.config.AnsatzConfig">AnsatzConfig</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="AnsatzConfig(depth=1, ansatz_type=AnsatzType.HEA, ansatz_strategy=Strategy.DIGITAL, strategy_args=dict(), m_block_qubits=None, param_prefix='theta', tag=None)

  
      dataclass
   (qadence.ml_tools.config.AnsatzConfig)" href="#qadence.ml_tools.config.AnsatzConfig">AnsatzConfig</a>()</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>backend</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The chosen quantum backend.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="qadence.types.BackendName">BackendName</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="qadence.types.BackendName.PYQTORCH">PYQTORCH</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>diff_mode</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The differentiation engine to use. Choices are
'gpsr' or 'ad'.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="DiffMode (qadence.types.DiffMode)" href="../types/#qadence.types.DiffMode">DiffMode</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="AD = 'ad'

  
      class-attribute
      instance-attribute
   (qadence.types.DiffMode.AD)" href="../types/#qadence.types.DiffMode.AD">AD</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>measurement</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Optional measurement protocol. If None,
use exact expectation value with a statevector simulator.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="qadence.measurements.Measurements">Measurements</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>noise</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A noise model to use.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="Noise">Noise</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>configuration</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Optional backend configuration.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BackendConfiguration(_use_gate_params=True, use_sparse_observable=False, use_gradient_checkpointing=False, use_single_qubit_composition=False, transpilation_passes=None)

  
      dataclass
   (qadence.backend.BackendConfiguration)" href="../backends/backend/#qadence.backend.BackendConfiguration">BackendConfiguration</a> | <span title="dict">dict</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_diff_mode</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The differentiation mode for the input tensor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="InputDiffMode (qadence.types.InputDiffMode)" href="../types/#qadence.types.InputDiffMode">InputDiffMode</a></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><a class="autorefs autorefs-internal" title="AD = 'ad'

  
      class-attribute
      instance-attribute
   (qadence.types.InputDiffMode.AD)" href="../types/#qadence.types.InputDiffMode.AD">AD</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><a class="autorefs autorefs-internal" title="QNN(circuit, observable, backend=BackendName.PYQTORCH, diff_mode=DiffMode.AD, measurement=None, noise=None, configuration=None, inputs=None, input_diff_mode=InputDiffMode.AD) (qadence.ml_tools.models.QNN)" href="#qadence.ml_tools.models.QNN">QNN</a></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A QNN object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="ValueError">ValueError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the observable configuration is not provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">AnsatzConfig</span><span class="p">,</span> <span class="n">FeatureMapConfig</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">QNN</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.constructors</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObservableConfig</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.operations</span><span class="w"> </span><span class="kn">import</span> <span class="n">Z</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">AnsatzType</span><span class="p">,</span> <span class="n">BackendName</span><span class="p">,</span> <span class="n">BasisSet</span><span class="p">,</span> <span class="n">ReuploadScaling</span><span class="p">,</span> <span class="n">Strategy</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">register</span> <span class="o">=</span> <span class="mi">4</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">obs_config</span> <span class="o">=</span> <span class="n">ObservableConfig</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">detuning</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">scale</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">shift</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">trainable_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">fm_config</span> <span class="o">=</span> <span class="n">FeatureMapConfig</span><span class="p">(</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    <span class="n">num_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">],</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="n">basis_set</span><span class="o">=</span><span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="n">reupload_scaling</span><span class="o">=</span><span class="n">ReuploadScaling</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="n">feature_range</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>    <span class="p">},</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="n">ansatz_config</span> <span class="o">=</span> <span class="n">AnsatzConfig</span><span class="p">(</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    <span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    <span class="n">ansatz_type</span><span class="o">=</span><span class="n">AnsatzType</span><span class="o">.</span><span class="n">HEA</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    <span class="n">ansatz_strategy</span><span class="o">=</span><span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="n">qnn</span> <span class="o">=</span> <span class="n">QNN</span><span class="o">.</span><span class="n">from_configs</span><span class="p">(</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    <span class="n">register</span><span class="p">,</span> <span class="n">obs_config</span><span class="p">,</span> <span class="n">fm_config</span><span class="p">,</span> <span class="n">ansatz_config</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">BackendName</span><span class="o">.</span><span class="n">PYQTORCH</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="n">y</span> <span class="o">=</span> <span class="n">qnn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kc">tens</span><span class="err">or(</span><span class="p">[[</span><span class="mf">3.4509</span><span class="p">],</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">        </span><span class="p">[</span><span class="mf">3.5612</span><span class="p">]],</span><span class="w"> </span><span class="err">grad_</span><span class="kc">fn</span><span class="err">=&lt;Ca</span><span class="kc">t</span><span class="err">Backward</span><span class="mi">0</span><span class="err">&gt;)</span>
</code></pre></div>

</div></p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_configs</span><span class="p">(</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="bp">cls</span><span class="p">,</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">register</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Register</span><span class="p">,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">obs_config</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="n">fm_config</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">FeatureMapConfig</span><span class="p">(),</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="n">ansatz_config</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">AnsatzConfig</span><span class="p">(),</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="n">backend</span><span class="p">:</span> <span class="n">BackendName</span> <span class="o">=</span> <span class="n">BackendName</span><span class="o">.</span><span class="n">PYQTORCH</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">diff_mode</span><span class="p">:</span> <span class="n">DiffMode</span> <span class="o">=</span> <span class="n">DiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">measurement</span><span class="p">:</span> <span class="n">Measurements</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">noise</span><span class="p">:</span> <span class="n">NoiseHandler</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">configuration</span><span class="p">:</span> <span class="n">BackendConfiguration</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="n">input_diff_mode</span><span class="p">:</span> <span class="n">InputDiffMode</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">InputDiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QNN</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a QNN from a set of configurations.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        register (int | Register): The number of qubits or a register object.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        obs_config (list[ObservableConfig] | ObservableConfig): The configuration(s)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">            for the observable(s).</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        fm_config (FeatureMapConfig): The configuration for the feature map.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            Defaults to no feature encoding block.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        ansatz_config (AnsatzConfig): The configuration for the ansatz.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">            Defaults to a single layer of hardware efficient ansatz.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        backend (BackendName): The chosen quantum backend.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        diff_mode (DiffMode): The differentiation engine to use. Choices are</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">            &#39;gpsr&#39; or &#39;ad&#39;.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        measurement (Measurements): Optional measurement protocol. If None,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">            use exact expectation value with a statevector simulator.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        noise (Noise): A noise model to use.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        configuration (BackendConfiguration | dict): Optional backend configuration.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        input_diff_mode (InputDiffMode): The differentiation mode for the input tensor.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        A QNN object.</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        ValueError: If the observable configuration is not provided.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    ```python exec=&quot;on&quot; source=&quot;material-block&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">    from qadence.ml_tools.config import AnsatzConfig, FeatureMapConfig</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">    from qadence.ml_tools import QNN</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">    from qadence.constructors import ObservableConfig</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">    from qadence.operations import Z</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    from qadence.types import (</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        AnsatzType, BackendName, BasisSet, ReuploadScaling, Strategy</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    )</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    register = 4</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    obs_config = ObservableConfig(</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        detuning=Z,</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        scale=5.0,</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">        shift=0.0,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        trainable_transform=None,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">    )</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">    fm_config = FeatureMapConfig(</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        num_features=2,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        inputs=[&quot;x&quot;, &quot;y&quot;],</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        basis_set=BasisSet.FOURIER,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        reupload_scaling=ReuploadScaling.CONSTANT,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        feature_range={</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">            &quot;x&quot;: (-1.0, 1.0),</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">            &quot;y&quot;: (0.0, 1.0),</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        },</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">    )</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    ansatz_config = AnsatzConfig(</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        depth=2,</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        ansatz_type=AnsatzType.HEA,</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        ansatz_strategy=Strategy.DIGITAL,</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    )</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">    qnn = QNN.from_configs(</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        register, obs_config, fm_config, ansatz_config, backend=BackendName.PYQTORCH</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    )</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    x = torch.rand(2, 2)</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">    y = qnn(x)</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">    print(str(y)) # markdown-exec: hide</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    ```</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.constructors</span><span class="w"> </span><span class="kn">import</span> <span class="n">build_qnn_from_configs</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="n">qnn</span> <span class="o">=</span> <span class="n">build_qnn_from_configs</span><span class="p">(</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="n">register</span><span class="o">=</span><span class="n">register</span><span class="p">,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="n">observable_config</span><span class="o">=</span><span class="n">obs_config</span><span class="p">,</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="n">fm_config</span><span class="o">=</span><span class="n">fm_config</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="n">ansatz_config</span><span class="o">=</span><span class="n">ansatz_config</span><span class="p">,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="n">diff_mode</span><span class="o">=</span><span class="n">diff_mode</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="n">measurement</span><span class="o">=</span><span class="n">measurement</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="n">configuration</span><span class="o">=</span><span class="n">configuration</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="n">input_diff_mode</span><span class="o">=</span><span class="n">input_diff_mode</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="p">)</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">qnn</span><span class="o">.</span><span class="n">_model_configs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="s2">&quot;register&quot;</span><span class="p">:</span> <span class="n">register</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="s2">&quot;observable_config&quot;</span><span class="p">:</span> <span class="n">obs_config</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="s2">&quot;fm_config&quot;</span><span class="p">:</span> <span class="n">fm_config</span><span class="p">,</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="s2">&quot;ansatz_config&quot;</span><span class="p">:</span> <span class="n">ansatz_config</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="p">}</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="k">return</span> <span class="n">qnn</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.models.derivative" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">derivative</span><span class="p">(</span><span class="n">ufa</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">derivative_indices</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute derivatives w.r.t.</p>
<p>inputs of a UFA with a single output. The
<code>derivative_indices</code> specify which derivative(s) are computed.  E.g.
<code>derivative_indices=(1,2)</code> would compute the a second order derivative w.r.t
to the indices <code>1</code> and <code>2</code> of the input tensor.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ufa</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model for which we want to compute the derivative.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>(batch_size, input_size) input tensor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.Tensor">Tensor</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>derivative_indices</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Define which derivatives to compute.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Examples:
If we create a UFA with three inputs and denote the first, second, and third
input with <code>x</code>, <code>y</code>, and <code>z</code> we can compute the following derivatives w.r.t
to those inputs:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">derivative</span><span class="p">,</span> <span class="n">QNN</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureMapConfig</span><span class="p">,</span> <span class="n">AnsatzConfig</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.constructors.hamiltonians</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObservableConfig</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.operations</span><span class="w"> </span><span class="kn">import</span> <span class="n">Z</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">fm_config</span> <span class="o">=</span> <span class="n">FeatureMapConfig</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">])</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">ansatz_config</span> <span class="o">=</span> <span class="n">AnsatzConfig</span><span class="p">()</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">obs_config</span> <span class="o">=</span> <span class="n">ObservableConfig</span><span class="p">(</span><span class="n">detuning</span><span class="o">=</span><span class="n">Z</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">f</span> <span class="o">=</span> <span class="n">QNN</span><span class="o">.</span><span class="n">from_configs</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">register</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">obs_config</span><span class="o">=</span><span class="n">obs_config</span><span class="p">,</span> <span class="n">fm_config</span><span class="o">=</span><span class="n">fm_config</span><span class="p">,</span> <span class="n">ansatz_config</span><span class="o">=</span><span class="n">ansatz_config</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c1"># df_dx</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="c1"># d2f_dydz</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="c1"># d3fdy2dx</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="n">derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div>
<div class="result" markdown="1" >



</div></p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="k">def</span><span class="w"> </span><span class="nf">derivative</span><span class="p">(</span><span class="n">ufa</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">derivative_indices</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute derivatives w.r.t.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    inputs of a UFA with a single output. The</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    `derivative_indices` specify which derivative(s) are computed.  E.g.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    `derivative_indices=(1,2)` would compute the a second order derivative w.r.t</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    to the indices `1` and `2` of the input tensor.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        ufa: The model for which we want to compute the derivative.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        x (Tensor): (batch_size, input_size) input tensor.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        derivative_indices (tuple): Define which derivatives to compute.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    If we create a UFA with three inputs and denote the first, second, and third</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    input with `x`, `y`, and `z` we can compute the following derivatives w.r.t</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    to those inputs:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    ```py exec=&quot;on&quot; source=&quot;material-block&quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    from qadence.ml_tools.models import derivative, QNN</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    from qadence.ml_tools.config import FeatureMapConfig, AnsatzConfig</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    from qadence.constructors.hamiltonians import ObservableConfig</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    from qadence.operations import Z</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    fm_config = FeatureMapConfig(num_features=3, inputs=[&quot;x&quot;, &quot;y&quot;, &quot;z&quot;])</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    ansatz_config = AnsatzConfig()</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    obs_config = ObservableConfig(detuning=Z)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    f = QNN.from_configs(</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        register=3, obs_config=obs_config, fm_config=fm_config, ansatz_config=ansatz_config,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    )</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    inputs = torch.rand(5,3,requires_grad=True)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    # df_dx</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    derivative(f, inputs, (0,))</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    # d2f_dydz</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    derivative(f, inputs, (1,2))</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    # d3fdy2dx</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    derivative(f, inputs, (1,1,0))</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    ```</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="k">assert</span> <span class="n">ufa</span><span class="o">.</span><span class="n">out_features</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Can only call `derivative` on models with 1D output.&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="k">return</span> <span class="n">ufa</span><span class="o">.</span><span class="n">_derivative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">derivative_indices</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.models.format_to_dict_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">format_to_dict_fn</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="p">[])</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Format an input tensor into the format required by the forward pass.</p>
<p>The tensor is assumed to have dimensions: n_batches x in_features where in_features
corresponds to the number of input features of the QNN</p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="nf">format_to_dict_fn</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">inputs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">ParamDictType</span><span class="p">],</span> <span class="n">ParamDictType</span><span class="p">]:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Format an input tensor into the format required by the forward pass.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    The tensor is assumed to have dimensions: n_batches x in_features where in_features</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    corresponds to the number of input features of the QNN</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">in_features</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">tensor_to_dict</span><span class="p">(</span><span class="n">values</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="n">ParamDictType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParamDictType</span><span class="p">:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">size</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">values</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">in_features</span><span class="p">:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>                    <span class="sa">f</span><span class="s2">&quot;Model expects in_features=</span><span class="si">{</span><span class="n">in_features</span><span class="si">}</span><span class="s2"> but got </span><span class="si">{</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>                <span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">{</span><span class="n">fparam</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">values</span><span class="p">[:,</span> <span class="n">inputs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">fparam</span><span class="p">)]</span> <span class="k">for</span> <span class="n">fparam</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">}</span>  <span class="c1"># type: ignore[union-attr]</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="k">return</span> <span class="n">values</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">return</span> <span class="n">tensor_to_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.Callback" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Callback</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


        <p>Base class for defining various training callbacks.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="on

  
      property
      writable
   (qadence.ml_tools.callbacks.callback.Callback.on)" href="#qadence.ml_tools.callbacks.callback.Callback.on">on</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The event on which to trigger the callback.
Must be a valid on value from: ["train_start", "train_end",
    "train_epoch_start", "train_epoch_end", "train_batch_start",
    "train_batch_end","val_epoch_start", "val_epoch_end",
    "val_batch_start", "val_batch_end", "test_batch_start",
    "test_batch_end"]</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.callbacks.callback.Callback.called_every">called_every</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.callbacks.callback.Callback.callback">callback</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The function to call if the condition is met.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="qadence.ml_tools.callbacks.callback.CallbackFunction">CallbackFunction</span> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.callbacks.callback.Callback.callback_condition">callback_condition</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Condition to check before calling.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="qadence.ml_tools.callbacks.callback.CallbackConditionFunction">CallbackConditionFunction</span> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.callbacks.callback.Callback.modify_optimize_result">modify_optimize_result</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Function to modify <code>OptimizeResult</code>.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="qadence.ml_tools.callbacks.callback.CallbackFunction">CallbackFunction</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>
        <p>A callback can be defined in two ways:</p>
<ol>
<li><strong>By providing a callback function directly in the base class</strong>:
   This is useful for simple callbacks that don't require subclassing.</li>
</ol>
<p>Example:
   <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callback</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">custom_callback_function</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Custom callback executed.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">custom_callback</span> <span class="o">=</span> <span class="n">Callback</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;train_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">called_every</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">callback</span><span class="o">=</span><span class="n">custom_callback_function</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>
<ol>
<li><strong>By inheriting and implementing the <code>run_callback</code> method</strong>:
   This is suitable for more complex callbacks that require customization.</li>
</ol>
<p>Example:
   <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callback</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomCallback</span><span class="p">(</span><span class="n">Callback</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Custom behavior in the inherited run_callback method.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">custom_callback</span> <span class="o">=</span> <span class="n">CustomCallback</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;train_end&quot;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">callback_condition</span> <span class="k">if</span> <span class="n">callback_condition</span> <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">default_callback</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_dict</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="n">opt_res</span><span class="p">,</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="k">if</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_default</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.callbacks.callback.Callback.on" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the TrainingStage.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>TrainingStage</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>TrainingStage for the callback</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="qadence.ml_tools.stages.TrainingStage">TrainingStage</span> | <span title="str">str</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.Callback.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">when</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Executes the callback if conditions are met.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>when</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event when the callback is triggered.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Any</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Result of the callback function if executed.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">when</span><span class="p">:</span> <span class="n">TrainingStage</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Executes the callback if conditions are met.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        when (str): The event when the callback is triggered.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        Any: Result of the callback function if executed.</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on</span> <span class="o">==</span> <span class="n">when</span><span class="p">:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="k">if</span> <span class="n">opt_result</span><span class="p">:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="n">opt_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span><span class="p">(</span><span class="n">opt_result</span><span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_should_call</span><span class="p">(</span><span class="n">when</span><span class="p">,</span> <span class="n">opt_result</span><span class="p">):</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.Callback.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Executes the defined callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Any</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Result of the callback execution.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If not implemented in subclasses.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Executes the defined callback.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        Any: Result of the callback execution.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        NotImplementedError: If not implemented in subclasses.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Subclasses should override the run_callback method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.EarlyStopping" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="p">,</span> <span class="n">monitor</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Callback(on='idle', called_every=1, callback=None, callback_condition=None, modify_optimize_result=None) (qadence.ml_tools.callbacks.callback.Callback)" href="#qadence.ml_tools.callbacks.callback.Callback">Callback</a></code></p>


        <p>Stops training when a monitored metric has not improved for a specified number of epochs.</p>
<p>This callback monitors a specified metric (e.g., validation loss or accuracy). If the metric
does not improve for a given patience period, training is stopped.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>EarlyStopping</code>, include it in the <code>callbacks</code> list when setting up your <code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">EarlyStopping</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the EarlyStopping callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">early_stopping</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;val_epoch_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>                               <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>                               <span class="n">monitor</span><span class="o">=</span><span class="s2">&quot;val_loss&quot;</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>                               <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>                               <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stopping</span><span class="p">]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

        <p>Initializes the EarlyStopping callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>on</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event to trigger the callback (e.g., "val_epoch_end").</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>called_every</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>monitor</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The metric to monitor (e.g., "val_loss" or "train_loss").
All metrics returned by optimize step are available to monitor.
Please add "val_" and "train_" strings at the start of the metric name.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>patience</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Number of iterations to wait for improvement. Default is 5.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>5</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mode</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to minimize ("min") or maximize ("max") the metric.
Default is "min".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;min&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">monitor</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">patience</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;min&quot;</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a><span class="p">):</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the EarlyStopping callback.</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="sd">        on (str): The event to trigger the callback (e.g., &quot;val_epoch_end&quot;).</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="sd">        called_every (int): Frequency of callback calls in terms of iterations.</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">        monitor (str): The metric to monitor (e.g., &quot;val_loss&quot; or &quot;train_loss&quot;).</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">            All metrics returned by optimize step are available to monitor.</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">            Please add &quot;val_&quot; and &quot;train_&quot; strings at the start of the metric name.</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">        patience (int, optional): Number of iterations to wait for improvement. Default is 5.</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">        mode (str, optional): Whether to minimize (&quot;min&quot;) or maximize (&quot;max&quot;) the metric.</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">            Default is &quot;min&quot;.</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="n">called_every</span><span class="p">)</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span> <span class="o">=</span> <span class="n">monitor</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">patience</span> <span class="o">=</span> <span class="n">patience</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">best_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span> <span class="k">else</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.EarlyStopping.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Monitors the metric and stops training if no improvement is observed.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a><span class="sd">    Monitors the metric and stops training if no improvement is observed.</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a><span class="sd">        writer (BaseWriter): The writer object for logging.</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>    <span class="n">current_value</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="p">)</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>    <span class="k">if</span> <span class="n">current_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Metric &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="si">}</span><span class="s2">&#39; is not available in the trainer&#39;s metrics.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span> <span class="ow">and</span> <span class="n">current_value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_value</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span> <span class="ow">and</span> <span class="n">current_value</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_value</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>    <span class="p">):</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">best_value</span> <span class="o">=</span> <span class="n">current_value</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">patience</span><span class="p">:</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>            <span class="sa">f</span><span class="s2">&quot;EarlyStopping: No improvement in &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="si">}</span><span class="s2">&#39; for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">patience</span><span class="si">}</span><span class="s2"> epochs. &quot;</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>            <span class="s2">&quot;Stopping training.&quot;</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>        <span class="p">)</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>        <span class="n">trainer</span><span class="o">.</span><span class="n">_stop_training</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.GradientMonitoring" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">GradientMonitoring</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Callback(on='idle', called_every=1, callback=None, callback_condition=None, modify_optimize_result=None) (qadence.ml_tools.callbacks.callback.Callback)" href="#qadence.ml_tools.callbacks.callback.Callback">Callback</a></code></p>


        <p>Logs gradient statistics (e.g., mean, standard deviation, max) during training.</p>
<p>This callback monitors and logs statistics about the gradients of the model parameters
to help debug or optimize the training process.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>GradientMonitoring</code>, include it in the <code>callbacks</code> list when
setting up your <code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">GradientMonitoring</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the GradientMonitoring callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">gradient_monitoring</span> <span class="o">=</span> <span class="n">GradientMonitoring</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;train_batch_end&quot;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">gradient_monitoring</span><span class="p">]</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

        <p>Initializes the GradientMonitoring callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>on</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event to trigger the callback (e.g., "train_batch_end").</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>called_every</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the GradientMonitoring callback.</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">        on (str): The event to trigger the callback (e.g., &quot;train_batch_end&quot;).</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">        called_every (int): Frequency of callback calls in terms of iterations.</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="n">called_every</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.GradientMonitoring.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Logs gradient statistics.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-782" name="__codelineno-0-782"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a><span class="sd">    Logs gradient statistics.</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">        writer (BaseWriter): The writer object for logging.</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>    <span class="k">if</span> <span class="n">trainer</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>        <span class="n">gradient_stats</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">trainer</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>            <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">grad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>                <span class="n">grad</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">grad</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>                <span class="n">gradient_stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>                    <span class="p">{</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>                        <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_mean&quot;</span><span class="p">:</span> <span class="n">grad</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>                        <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_std&quot;</span><span class="p">:</span> <span class="n">grad</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>                        <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_max&quot;</span><span class="p">:</span> <span class="n">grad</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>                        <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_min&quot;</span><span class="p">:</span> <span class="n">grad</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>                    <span class="p">}</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>                <span class="p">)</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>        <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span><span class="p">,</span> <span class="n">gradient_stats</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.LRSchedulerCosineAnnealing" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LRSchedulerCosineAnnealing</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">min_lr</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Callback(on='idle', called_every=1, callback=None, callback_condition=None, modify_optimize_result=None) (qadence.ml_tools.callbacks.callback.Callback)" href="#qadence.ml_tools.callbacks.callback.Callback">Callback</a></code></p>


        <p>Applies cosine annealing to the learning rate during training.</p>
<p>This callback decreases the learning rate following a cosine curve,
starting from the initial learning rate and annealing to a minimum (min_lr).</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>LRSchedulerCosineAnnealing</code>, include it in the <code>callbacks</code> list
when setting up your <code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">LRSchedulerCosineAnnealing</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the LRSchedulerCosineAnnealing callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">lr_cosine</span> <span class="o">=</span> <span class="n">LRSchedulerCosineAnnealing</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;train_batch_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>                                       <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>                                       <span class="n">t_max</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>                                       <span class="n">min_lr</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="c1"># Add the custom callback</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">lr_cosine</span><span class="p">]</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

        <p>Initializes the LRSchedulerCosineAnnealing callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>on</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event to trigger the callback.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>called_every</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_max</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The total number of iterations for one annealing cycle.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_lr</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The minimum learning rate. Default is 0.0.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0.0</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">t_max</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">min_lr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">):</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the LRSchedulerCosineAnnealing callback.</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">        on (str): The event to trigger the callback.</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">        called_every (int): Frequency of callback calls in terms of iterations.</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">        t_max (int): The total number of iterations for one annealing cycle.</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">        min_lr (float, optional): The minimum learning rate. Default is 0.0.</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="n">called_every</span><span class="p">)</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">t_max</span> <span class="o">=</span> <span class="n">t_max</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">min_lr</span> <span class="o">=</span> <span class="n">min_lr</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.LRSchedulerCosineAnnealing.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Adjusts the learning rate using cosine annealing.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">    Adjusts the learning rate using cosine annealing.</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">        writer (BaseWriter): The writer object for logging.</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>    <span class="k">for</span> <span class="n">param_group</span> <span class="ow">in</span> <span class="n">trainer</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">param_groups</span><span class="p">:</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>        <span class="n">max_lr</span> <span class="o">=</span> <span class="n">param_group</span><span class="p">[</span><span class="s2">&quot;lr&quot;</span><span class="p">]</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>        <span class="n">new_lr</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">min_lr</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>            <span class="o">+</span> <span class="p">(</span><span class="n">max_lr</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_lr</span><span class="p">)</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_max</span><span class="p">))</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="p">)</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="n">param_group</span><span class="p">[</span><span class="s2">&quot;lr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_lr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.LRSchedulerCyclic" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LRSchedulerCyclic</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="p">,</span> <span class="n">base_lr</span><span class="p">,</span> <span class="n">max_lr</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Callback(on='idle', called_every=1, callback=None, callback_condition=None, modify_optimize_result=None) (qadence.ml_tools.callbacks.callback.Callback)" href="#qadence.ml_tools.callbacks.callback.Callback">Callback</a></code></p>


        <p>Applies a cyclic learning rate schedule during training.</p>
<p>This callback oscillates the learning rate between a minimum (base_lr)
and a maximum (max_lr) over a defined cycle length (step_size). The learning
rate follows a triangular wave pattern.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>LRSchedulerCyclic</code>, include it in the <code>callbacks</code> list when setting
up your <code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">LRSchedulerCyclic</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the LRSchedulerCyclic callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">lr_cyclic</span> <span class="o">=</span> <span class="n">LRSchedulerCyclic</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;train_batch_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>                              <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>                              <span class="n">base_lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>                              <span class="n">max_lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>                              <span class="n">step_size</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="c1"># Add the custom callback</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">lr_cyclic</span><span class="p">]</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

        <p>Initializes the LRSchedulerCyclic callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>on</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event to trigger the callback.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>called_every</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_lr</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The minimum learning rate.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_lr</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The maximum learning rate.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>step_size</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Number of iterations for half a cycle.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">base_lr</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">max_lr</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the LRSchedulerCyclic callback.</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">        on (str): The event to trigger the callback.</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">        called_every (int): Frequency of callback calls in terms of iterations.</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">        base_lr (float): The minimum learning rate.</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">        max_lr (float): The maximum learning rate.</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">        step_size (int): Number of iterations for half a cycle.</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="n">called_every</span><span class="p">)</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">base_lr</span> <span class="o">=</span> <span class="n">base_lr</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_lr</span> <span class="o">=</span> <span class="n">max_lr</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span> <span class="o">=</span> <span class="n">step_size</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.LRSchedulerCyclic.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Adjusts the learning rate cyclically.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">    Adjusts the learning rate cyclically.</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">        writer (BaseWriter): The writer object for logging.</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>    <span class="n">cycle</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span> <span class="o">//</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span><span class="p">)</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>    <span class="n">x</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cycle</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>    <span class="n">scale</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>    <span class="n">new_lr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_lr</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_lr</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_lr</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>    <span class="k">for</span> <span class="n">param_group</span> <span class="ow">in</span> <span class="n">trainer</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">param_groups</span><span class="p">:</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="n">param_group</span><span class="p">[</span><span class="s2">&quot;lr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_lr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.LRSchedulerStepDecay" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LRSchedulerStepDecay</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Callback(on='idle', called_every=1, callback=None, callback_condition=None, modify_optimize_result=None) (qadence.ml_tools.callbacks.callback.Callback)" href="#qadence.ml_tools.callbacks.callback.Callback">Callback</a></code></p>


        <p>Reduces the learning rate by a factor at regular intervals.</p>
<p>This callback adjusts the learning rate by multiplying it with a decay factor
after a specified number of iterations. The learning rate is updated as:
    lr = lr * gamma</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>LRSchedulerStepDecay</code>, include it in the <code>callbacks</code> list when setting
up your <code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">LRSchedulerStepDecay</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the LRSchedulerStepDecay callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">lr_step_decay</span> <span class="o">=</span> <span class="n">LRSchedulerStepDecay</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;train_epoch_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>                                     <span class="n">called_every</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>                                     <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="c1"># Add the custom callback</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">lr_step_decay</span><span class="p">]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

        <p>Initializes the LRSchedulerStepDecay callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>on</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event to trigger the callback.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>called_every</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gamma</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The decay factor applied to the learning rate.
A value &lt; 1 reduces the learning rate over time. Default is 0.5.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0.5</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">):</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the LRSchedulerStepDecay callback.</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        on (str): The event to trigger the callback.</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        called_every (int): Frequency of callback calls in terms of iterations.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        gamma (float, optional): The decay factor applied to the learning rate.</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">            A value &lt; 1 reduces the learning rate over time. Default is 0.5.</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="n">called_every</span><span class="p">)</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.LRSchedulerStepDecay.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Runs the callback to apply step decay to the learning rate.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">    Runs the callback to apply step decay to the learning rate.</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        writer (BaseWriter): The writer object for logging.</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="k">for</span> <span class="n">param_group</span> <span class="ow">in</span> <span class="n">trainer</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">param_groups</span><span class="p">:</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="n">param_group</span><span class="p">[</span><span class="s2">&quot;lr&quot;</span><span class="p">]</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.LoadCheckpoint" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LoadCheckpoint</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Callback(on='idle', called_every=1, callback=None, callback_condition=None, modify_optimize_result=None) (qadence.ml_tools.callbacks.callback.Callback)" href="#qadence.ml_tools.callbacks.callback.Callback">Callback</a></code></p>


        <p>Callback to load a model checkpoint.</p>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">callback_condition</span> <span class="k">if</span> <span class="n">callback_condition</span> <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">default_callback</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_dict</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="n">opt_res</span><span class="p">,</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="k">if</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_default</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.LoadCheckpoint.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Loads a model checkpoint.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Any</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The result of loading the checkpoint.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads a model checkpoint.</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        Any: The result of loading the checkpoint.</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="k">if</span> <span class="n">trainer</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="n">folder</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">log_folder</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">model</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">optimizer</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="n">device</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">log_device</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="k">return</span> <span class="n">load_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.LogHyperparameters" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LogHyperparameters</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Callback(on='idle', called_every=1, callback=None, callback_condition=None, modify_optimize_result=None) (qadence.ml_tools.callbacks.callback.Callback)" href="#qadence.ml_tools.callbacks.callback.Callback">Callback</a></code></p>


        <p>Callback to log hyperparameters using the writer.</p>
<p>The <code>LogHyperparameters</code> callback can be added to the <code>TrainConfig</code> callbacks
as a custom user defined callback.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>LogHyperparameters</code>, include it in the <code>callbacks</code> list when setting up your
<code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogHyperparameters</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the LogHyperparameters callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">log_hyper_callback</span> <span class="o">=</span> <span class="n">LogHyperparameters</span><span class="p">(</span><span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;val_batch_end&quot;</span><span class="p">,</span> <span class="n">called_every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="c1"># Add the custom callback that runs every 100 val_batch_end</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">log_hyper_callback</span><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">callback_condition</span> <span class="k">if</span> <span class="n">callback_condition</span> <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">default_callback</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_dict</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="n">opt_res</span><span class="p">,</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="k">if</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_default</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.LogHyperparameters.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Logs hyperparameters using the writer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Logs hyperparameters using the writer.</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="k">if</span> <span class="n">trainer</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="n">hyperparams</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">hyperparams</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="n">writer</span><span class="o">.</span><span class="n">log_hyperparams</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.LogModelTracker" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LogModelTracker</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Callback(on='idle', called_every=1, callback=None, callback_condition=None, modify_optimize_result=None) (qadence.ml_tools.callbacks.callback.Callback)" href="#qadence.ml_tools.callbacks.callback.Callback">Callback</a></code></p>


        <p>Callback to log the model using the writer.</p>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">callback_condition</span> <span class="k">if</span> <span class="n">callback_condition</span> <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">default_callback</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_dict</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="n">opt_res</span><span class="p">,</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="k">if</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_default</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.LogModelTracker.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Logs the model using the writer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Logs the model using the writer.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="k">if</span> <span class="n">trainer</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">model</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="n">writer</span><span class="o">.</span><span class="n">log_model</span><span class="p">(</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="n">model</span><span class="p">,</span> <span class="n">trainer</span><span class="o">.</span><span class="n">train_dataloader</span><span class="p">,</span> <span class="n">trainer</span><span class="o">.</span><span class="n">val_dataloader</span><span class="p">,</span> <span class="n">trainer</span><span class="o">.</span><span class="n">test_dataloader</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.PlotMetrics" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">PlotMetrics</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Callback(on='idle', called_every=1, callback=None, callback_condition=None, modify_optimize_result=None) (qadence.ml_tools.callbacks.callback.Callback)" href="#qadence.ml_tools.callbacks.callback.Callback">Callback</a></code></p>


        <p>Callback to plot metrics using the writer.</p>
<p>The <code>PlotMetrics</code> callback can be added to the <code>TrainConfig</code> callbacks as
a custom user defined callback.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>PlotMetrics</code>, include it in the <code>callbacks</code> list when setting up your
<code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">PlotMetrics</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the PlotMetrics callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">plot_metrics_callback</span> <span class="o">=</span> <span class="n">PlotMetrics</span><span class="p">(</span><span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;val_batch_end&quot;</span><span class="p">,</span> <span class="n">called_every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="c1"># Add the custom callback that runs every 100 val_batch_end</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">plot_metrics_callback</span><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">callback_condition</span> <span class="k">if</span> <span class="n">callback_condition</span> <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">default_callback</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_dict</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="n">opt_res</span><span class="p">,</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="k">if</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_default</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.PlotMetrics.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Plots metrics using the writer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots metrics using the writer.</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="k">if</span> <span class="n">trainer</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="n">plotting_functions</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">plotting_functions</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="n">writer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span><span class="p">,</span> <span class="n">plotting_functions</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.PrintMetrics" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">PrintMetrics</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Callback(on='idle', called_every=1, callback=None, callback_condition=None, modify_optimize_result=None) (qadence.ml_tools.callbacks.callback.Callback)" href="#qadence.ml_tools.callbacks.callback.Callback">Callback</a></code></p>


        <p>Callback to print metrics using the writer.</p>
<p>The <code>PrintMetrics</code> callback can be added to the <code>TrainConfig</code>
callbacks as a custom user defined callback.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>PrintMetrics</code>, include it in the <code>callbacks</code> list when
setting up your <code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">PrintMetrics</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the PrintMetrics callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">print_metrics_callback</span> <span class="o">=</span> <span class="n">PrintMetrics</span><span class="p">(</span><span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;val_batch_end&quot;</span><span class="p">,</span> <span class="n">called_every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="c1"># Add the custom callback that runs every 100 val_batch_end</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">print_metrics_callback</span><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">callback_condition</span> <span class="k">if</span> <span class="n">callback_condition</span> <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">default_callback</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_dict</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="n">opt_res</span><span class="p">,</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="k">if</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_default</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.PrintMetrics.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Prints metrics using the writer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints metrics using the writer.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="n">writer</span><span class="o">.</span><span class="n">print_metrics</span><span class="p">(</span><span class="n">opt_result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.SaveBestCheckpoint" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">SaveBestCheckpoint</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="SaveCheckpoint(on='idle', called_every=1, callback=None, callback_condition=None, modify_optimize_result=None) (qadence.ml_tools.callbacks.callback.SaveCheckpoint)" href="#qadence.ml_tools.callbacks.callback.SaveCheckpoint">SaveCheckpoint</a></code></p>


        <p>Callback to save the best model checkpoint based on a validation criterion.</p>

        <p>Initializes the SaveBestCheckpoint callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>on</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event to trigger the callback.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>called_every</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the SaveBestCheckpoint callback.</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        on (str): The event to trigger the callback.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        called_every (int): Frequency of callback calls in terms of iterations.</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="n">called_every</span><span class="p">)</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">best_loss</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.SaveBestCheckpoint.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Saves the checkpoint if the current loss is better than the best loss.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves the checkpoint if the current loss is better than the best loss.</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="k">if</span> <span class="n">trainer</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">validation_criterion</span> <span class="ow">and</span> <span class="n">config</span><span class="o">.</span><span class="n">validation_criterion</span><span class="p">(</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>            <span class="n">opt_result</span><span class="o">.</span><span class="n">loss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_loss</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">val_epsilon</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="p">):</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">best_loss</span> <span class="o">=</span> <span class="n">opt_result</span><span class="o">.</span><span class="n">loss</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>            <span class="n">folder</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">log_folder</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">model</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="n">optimizer</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">optimizer</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>            <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>            <span class="n">write_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="s2">&quot;best&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.SaveCheckpoint" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">SaveCheckpoint</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Callback(on='idle', called_every=1, callback=None, callback_condition=None, modify_optimize_result=None) (qadence.ml_tools.callbacks.callback.Callback)" href="#qadence.ml_tools.callbacks.callback.Callback">Callback</a></code></p>


        <p>Callback to save a model checkpoint.</p>
<p>The <code>SaveCheckpoint</code> callback can be added to the <code>TrainConfig</code> callbacks
as a custom user defined callback.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>SaveCheckpoint</code>, include it in the <code>callbacks</code> list when setting up your
<code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">SaveCheckpoint</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the SaveCheckpoint callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">save_checkpoint_callback</span> <span class="o">=</span> <span class="n">SaveCheckpoint</span><span class="p">(</span><span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;val_batch_end&quot;</span><span class="p">,</span> <span class="n">called_every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="c1"># Add the custom callback that runs every 100 val_batch_end</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">save_checkpoint_callback</span><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">callback_condition</span> <span class="k">if</span> <span class="n">callback_condition</span> <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">default_callback</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_dict</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="n">opt_res</span><span class="p">,</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="k">if</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_default</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.SaveCheckpoint.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Saves a model checkpoint.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves a model checkpoint.</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="k">if</span> <span class="n">trainer</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="n">folder</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">log_folder</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">model</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">optimizer</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="n">write_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.WriteMetrics" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">WriteMetrics</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Callback(on='idle', called_every=1, callback=None, callback_condition=None, modify_optimize_result=None) (qadence.ml_tools.callbacks.callback.Callback)" href="#qadence.ml_tools.callbacks.callback.Callback">Callback</a></code></p>


        <p>Callback to write metrics using the writer.</p>
<p>The <code>WriteMetrics</code> callback can be added to the <code>TrainConfig</code> callbacks as
a custom user defined callback.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>WriteMetrics</code>, include it in the <code>callbacks</code> list when setting up your
<code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">WriteMetrics</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the WriteMetrics callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">write_metrics_callback</span> <span class="o">=</span> <span class="n">WriteMetrics</span><span class="p">(</span><span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;val_batch_end&quot;</span><span class="p">,</span> <span class="n">called_every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="c1"># Add the custom callback that runs every 100 val_batch_end</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">write_metrics_callback</span><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">callback_condition</span> <span class="k">if</span> <span class="n">callback_condition</span> <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">default_callback</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_dict</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="n">opt_res</span><span class="p">,</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="k">if</span> <span class="n">modify_optimize_result</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">else</span> <span class="n">Callback</span><span class="o">.</span><span class="n">modify_opt_res_default</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.WriteMetrics.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Writes metrics using the writer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>trainer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>writer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes metrics using the writer.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="k">if</span> <span class="n">trainer</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span><span class="p">,</span> <span class="n">opt_result</span><span class="o">.</span><span class="n">metrics</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">BaseTrainer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">loss_fn</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">optimize_step</span><span class="o">=</span><span class="n">optimize_step</span><span class="p">,</span> <span class="n">train_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_batches</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


        <p>Base class for training machine learning models using a given optimizer.</p>
<p>The base class implements contextmanager for gradient based/free optimization,
properties, property setters, input validations, callback decorator generator,
and empty hooks for different training steps.</p>


<details class="this-class-provides" open>
  <summary>This class provides</summary>
  <ul>
<li>Context managers for enabling/disabling gradient-based optimization</li>
<li>Properties for managing models, optimizers, and dataloaders</li>
<li>Input validations and a callback decorator generator</li>
<li>Config and callback managers using the provided <code>TrainConfig</code></li>
</ul>
</details>

<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="use_grad

  
      property
      writable
   (qadence.ml_tools.train_utils.base_trainer.BaseTrainer.use_grad)" href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.use_grad">use_grad</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Indicates if gradients are used for optimization. Default is True.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="model

  
      property
      writable
   (qadence.ml_tools.train_utils.base_trainer.BaseTrainer.model)" href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.model">model</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The neural network model.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="optimizer

  
      property
      writable
   (qadence.ml_tools.train_utils.base_trainer.BaseTrainer.optimizer)" href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.optimizer">optimizer</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The optimizer for training.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.optim.Optimizer">Optimizer</span> | <span title="nevergrad.optimization.base.Optimizer">Optimizer</span> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="config

  
      property
      writable
   (qadence.ml_tools.train_utils.base_trainer.BaseTrainer.config)" href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.config">config</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The configuration settings for training.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="train_dataloader

  
      property
      writable
   (qadence.ml_tools.train_utils.base_trainer.BaseTrainer.train_dataloader)" href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.train_dataloader">train_dataloader</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="Dataloader">Dataloader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="val_dataloader

  
      property
      writable
   (qadence.ml_tools.train_utils.base_trainer.BaseTrainer.val_dataloader)" href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.val_dataloader">val_dataloader</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="Dataloader">Dataloader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="test_dataloader

  
      property
      writable
   (qadence.ml_tools.train_utils.base_trainer.BaseTrainer.test_dataloader)" href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.test_dataloader">test_dataloader</a></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>DataLoader for testing data.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="Dataloader">Dataloader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.optimize_step">optimize_step</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Function for performing an optimization step.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Callable">Callable</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.loss_fn">loss_fn</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>loss function to use. Default loss function
used is 'mse'</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code>Callable | str ]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.num_training_batches">num_training_batches</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Number of training batches. In case of
InfiniteTensorDataset only 1 batch per epoch is used.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.num_validation_batches">num_validation_batches</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Number of validation batches. In case of
InfiniteTensorDataset only 1 batch per epoch is used.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.num_test_batches">num_test_batches</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Number of test batches. In case of
InfiniteTensorDataset only 1 batch per epoch is used.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.state">state</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Current state in the training process</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

        <p>Initializes the BaseTrainer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to train.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The optimizer
for training.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.optim.Optimizer">Optimizer</span> | <span title="nevergrad.optimization.base.Optimizer">Optimizer</span> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The TrainConfig settings for training.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_fn</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The loss function to use.
str input to be specified to use a default loss function.
currently supported loss functions: 'mse', 'cross_entropy'.
If not specified, default mse loss will be used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span> | <span title="typing.Callable">Callable</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;mse&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>train_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.
If the model does not need data to evaluate loss, no dataset
should be provided.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="Dataloader">Dataloader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>val_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="Dataloader">Dataloader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for testing data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="Dataloader">Dataloader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_batches</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum number of batches to process per epoch.
This is only valid in case of finite TensorDataset dataloaders.
if max_batches is not None, the maximum number of batches used will
be min(max_batches, len(dataloader.dataset))
In case of InfiniteTensorDataset only 1 batch per epoch is used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">optimizer</span><span class="p">:</span> <span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span> <span class="o">|</span> <span class="n">NGOptimizer</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">loss_fn</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="s2">&quot;mse&quot;</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">optimize_step</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">optimize_step</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">max_batches</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="p">):</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    Initializes the BaseTrainer.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        model (nn.Module): The model to train.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        optimizer (optim.Optimizer | NGOptimizer | None): The optimizer</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            for training.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        config (TrainConfig): The TrainConfig settings for training.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        loss_fn (str | Callable): The loss function to use.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">            str input to be specified to use a default loss function.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">            currently supported loss functions: &#39;mse&#39;, &#39;cross_entropy&#39;.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            If not specified, default mse loss will be used.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        train_dataloader (Dataloader | DictDataLoader | None): DataLoader for training data.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            If the model does not need data to evaluate loss, no dataset</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            should be provided.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        val_dataloader (Dataloader | DictDataLoader | None): DataLoader for validation data.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        test_dataloader (Dataloader | DictDataLoader | None): DataLoader for testing data.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        max_batches (int | None): Maximum number of batches to process per epoch.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            This is only valid in case of finite TensorDataset dataloaders.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            if max_batches is not None, the maximum number of batches used will</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            be min(max_batches, len(dataloader.dataset))</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            In case of InfiniteTensorDataset only 1 batch per epoch is used.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer</span><span class="p">:</span> <span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span> <span class="o">|</span> <span class="n">NGOptimizer</span> <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">:</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_batches</span> <span class="o">=</span> <span class="n">max_batches</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">num_training_batches</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">num_validation_batches</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">num_test_batches</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader</span> <span class="o">=</span> <span class="n">train_dataloader</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">val_dataloader</span> <span class="o">=</span> <span class="n">val_dataloader</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">test_dataloader</span> <span class="o">=</span> <span class="n">test_dataloader</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">get_loss_fn</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">optimize_step</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">optimize_step</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ng_params</span><span class="p">:</span> <span class="n">ng</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Array</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">training_stage</span><span class="p">:</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">TrainingStage</span><span class="p">(</span><span class="s2">&quot;idle&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">config</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the training configuration.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>TrainConfig</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the model if set, otherwise raises an error.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="torch.nn.Module">Module</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>nn.Module: The model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.optimizer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimizer</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the optimizer if set, otherwise raises an error.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="torch.optim.Optimizer">Optimizer</span> | <span title="nevergrad.optimization.base.Optimizer">Optimizer</span> | None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>optim.Optimizer | NGOptimizer | None: The optimizer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.test_dataloader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">test_dataloader</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the test DataLoader, validating its type.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>DataLoader</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The DataLoader for testing data.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.train_dataloader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">train_dataloader</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the training DataLoader, validating its type.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>DataLoader</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The DataLoader for training data.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.use_grad" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">use_grad</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the optimization framework for the trainer.</p>
<p>use_grad = True : Gradient based optimization
use_grad = False : Gradient free optimization</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bool</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Bool value for using gradient.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.val_dataloader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">val_dataloader</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Returns the validation DataLoader, validating its type.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>DataLoader</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The DataLoader for validation data.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">callback</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Decorator for executing callbacks before and after a phase.</p>
<p>Phase are different hooks during the training. list of valid
phases is defined in Callbacks.
We also update the current state of the training process in
the callback decorator.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>phase</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The phase for which the callback is executed (e.g., "train",
"train_epoch", "train_batch").</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Callable</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The decorated function.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Callable">Callable</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="n">phase</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    Decorator for executing callbacks before and after a phase.</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">    Phase are different hooks during the training. list of valid</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">    phases is defined in Callbacks.</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">    We also update the current state of the training process in</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">    the callback decorator.</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        phase (str): The phase for which the callback is executed (e.g., &quot;train&quot;,</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">            &quot;train_epoch&quot;, &quot;train_batch&quot;).</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        Callable: The decorated function.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">method</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="n">start_event</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">phase</span><span class="si">}</span><span class="s2">_start&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="n">end_event</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">phase</span><span class="si">}</span><span class="s2">_end&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">training_stage</span> <span class="o">=</span> <span class="n">TrainingStage</span><span class="p">(</span><span class="n">start_event</span><span class="p">)</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">callback_manager</span><span class="o">.</span><span class="n">run_callbacks</span><span class="p">(</span><span class="n">trainer</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">training_stage</span> <span class="o">=</span> <span class="n">TrainingStage</span><span class="p">(</span><span class="n">end_event</span><span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="c1"># build_optimize_result method is defined in the trainer.</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">build_optimize_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">callback_manager</span><span class="o">.</span><span class="n">run_callbacks</span><span class="p">(</span><span class="n">trainer</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="k">return</span> <span class="n">wrapper</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="k">return</span> <span class="n">decorator</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.disable_grad_opt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">disable_grad_opt</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Context manager to temporarily disable gradient-based optimization.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The Nevergrad optimizer to use.
If no optimizer is provided, default optimizer for trainer
object will be used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="nevergrad.optimization.base.Optimizer">Optimizer</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="nd">@contextmanager</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="k">def</span><span class="w"> </span><span class="nf">disable_grad_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">:</span> <span class="n">NGOptimizer</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">    Context manager to temporarily disable gradient-based optimization.</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        optimizer (NGOptimizer): The Nevergrad optimizer to use.</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">            If no optimizer is provided, default optimizer for trainer</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">            object will be used.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="n">original_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="n">original_optimizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">callback_manager</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span> <span class="k">if</span> <span class="n">optimizer</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="k">yield</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="n">original_mode</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">callback_manager</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="n">original_mode</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">original_optimizer</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.enable_grad_opt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">enable_grad_opt</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Context manager to temporarily enable gradient-based optimization.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The PyTorch optimizer to use.
If no optimizer is provided, default optimizer for trainer
object will be used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.optim.Optimizer">Optimizer</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="nd">@contextmanager</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="k">def</span><span class="w"> </span><span class="nf">enable_grad_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">:</span> <span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">    Context manager to temporarily enable gradient-based optimization.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        optimizer (optim.Optimizer): The PyTorch optimizer to use.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">            If no optimizer is provided, default optimizer for trainer</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">            object will be used.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="n">original_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="n">original_optimizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">callback_manager</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span> <span class="k">if</span> <span class="n">optimizer</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="k">yield</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="n">original_mode</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">callback_manager</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="n">original_mode</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">original_optimizer</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_test_batch_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_test_batch_end</span><span class="p">(</span><span class="n">test_batch_loss_metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Called at the end of each testing batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>test_batch_loss_metrics</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the testing batch loss.
tuple of (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="typing.Any">Any</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_test_batch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_batch_loss_metrics</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">    Called at the end of each testing batch.</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">        test_batch_loss_metrics: Metrics for the testing batch loss.</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">            tuple of (loss, metrics)</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_test_batch_start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_test_batch_start</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Called at the start of each testing batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A batch of data from the DataLoader. Typically a tuple containing
input tensors and corresponding target tensors.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, ...] | None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_test_batch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">    Called at the start of each testing batch.</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">        batch: A batch of data from the DataLoader. Typically a tuple containing</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">            input tensors and corresponding target tensors.</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_batch_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_train_batch_end</span><span class="p">(</span><span class="n">train_batch_loss_metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Called at the end of each training batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>train_batch_loss_metrics</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the training batch loss.
tuple of (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="typing.Any">Any</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_train_batch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_batch_loss_metrics</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">    Called at the end of each training batch.</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        train_batch_loss_metrics: Metrics for the training batch loss.</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">            tuple of (loss, metrics)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_batch_start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_train_batch_start</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Called at the start of each training batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A batch of data from the DataLoader. Typically a tuple containing
input tensors and corresponding target tensors.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, ...] | None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_train_batch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">    Called at the start of each training batch.</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">        batch: A batch of data from the DataLoader. Typically a tuple containing</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">            input tensors and corresponding target tensors.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_train_end</span><span class="p">(</span><span class="n">train_losses</span><span class="p">,</span> <span class="n">val_losses</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Called at the end of training.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>train_losses</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the training losses.
list    -&gt; list                  -&gt; tuples
Epochs  -&gt; Training Batches      -&gt; (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="list">list</span>[<span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="typing.Any">Any</span>]]]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>val_losses</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the validation losses.
list    -&gt; list                  -&gt; tuples
Epochs  -&gt; Validation Batches    -&gt; (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="list">list</span>[<span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="typing.Any">Any</span>]]] | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_train_end</span><span class="p">(</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="n">train_losses</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="n">val_losses</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">    Called at the end of training.</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        train_losses (list[list[tuple[torch.Tensor, Any]]]):</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">            Metrics for the training losses.</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">            list    -&gt; list                  -&gt; tuples</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">            Epochs  -&gt; Training Batches      -&gt; (loss, metrics)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">        val_losses (list[list[tuple[torch.Tensor, Any]]] | None):</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">            Metrics for the validation losses.</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">            list    -&gt; list                  -&gt; tuples</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">            Epochs  -&gt; Validation Batches    -&gt; (loss, metrics)</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_epoch_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_train_epoch_end</span><span class="p">(</span><span class="n">train_epoch_loss_metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Called at the end of each training epoch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>train_epoch_loss_metrics</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the training epoch losses.
list                  -&gt; tuples
Training Batches      -&gt; (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="typing.Any">Any</span>]]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_train_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_epoch_loss_metrics</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    Called at the end of each training epoch.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">        train_epoch_loss_metrics: Metrics for the training epoch losses.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">            list                  -&gt; tuples</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">            Training Batches      -&gt; (loss, metrics)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_epoch_start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_train_epoch_start</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Called at the start of each training epoch.</p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_train_epoch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Called at the start of each training epoch.&quot;&quot;&quot;</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_train_start</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Called at the start of training.</p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_train_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Called at the start of training.&quot;&quot;&quot;</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_batch_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_val_batch_end</span><span class="p">(</span><span class="n">val_batch_loss_metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Called at the end of each validation batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>val_batch_loss_metrics</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the validation batch loss.
tuple of (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="typing.Any">Any</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_val_batch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val_batch_loss_metrics</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">    Called at the end of each validation batch.</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">        val_batch_loss_metrics: Metrics for the validation batch loss.</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">            tuple of (loss, metrics)</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_batch_start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_val_batch_start</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Called at the start of each validation batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A batch of data from the DataLoader. Typically a tuple containing
input tensors and corresponding target tensors.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, ...] | None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_val_batch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">    Called at the start of each validation batch.</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        batch: A batch of data from the DataLoader. Typically a tuple containing</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            input tensors and corresponding target tensors.</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_epoch_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_val_epoch_end</span><span class="p">(</span><span class="n">val_epoch_loss_metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Called at the end of each validation epoch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>val_epoch_loss_metrics</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the validation epoch loss.
list                    -&gt; tuples
Validation Batches      -&gt; (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span>, <span title="typing.Any">Any</span>]]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_val_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val_epoch_loss_metrics</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">    Called at the end of each validation epoch.</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">        val_epoch_loss_metrics: Metrics for the validation epoch loss.</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">            list                    -&gt; tuples</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">            Validation Batches      -&gt; (loss, metrics)</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_epoch_start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_val_epoch_start</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Called at the start of each validation epoch.</p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_val_epoch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Called at the start of each validation epoch.&quot;&quot;&quot;</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.set_use_grad" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_use_grad</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Sets the global use_grad flag.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to use gradient-based optimization.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_use_grad</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    Sets the global use_grad flag.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        value (bool): Whether to use gradient-based optimization.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;use_grad must be a boolean value.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="bp">cls</span><span class="o">.</span><span class="n">_use_grad</span> <span class="o">=</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter" class="doc doc-heading">
            <code>BaseWriter</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Abstract base class for experiment tracking writers.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">METHOD</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="open(config, iteration=None)

  
      abstractmethod
   (qadence.ml_tools.callbacks.writer_registry.BaseWriter.open)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.open">open</a></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Opens the writer and sets up the logging
environment.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="close()

  
      abstractmethod
   (qadence.ml_tools.callbacks.writer_registry.BaseWriter.close)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.close">close</a></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Closes the writer and finalizes any ongoing logging processes.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="print_metrics(result) (qadence.ml_tools.callbacks.writer_registry.BaseWriter.print_metrics)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.print_metrics">print_metrics</a></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Prints metrics and loss in a formatted manner.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="write(iteration, metrics)

  
      abstractmethod
   (qadence.ml_tools.callbacks.writer_registry.BaseWriter.write)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.write">write</a></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Writes the optimization results to the tracking tool.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="log_hyperparams(hyperparams)

  
      abstractmethod
   (qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_hyperparams)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_hyperparams">log_hyperparams</a></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Logs the hyperparameters to the tracking tool.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="plot(model, iteration, plotting_functions)

  
      abstractmethod
   (qadence.ml_tools.callbacks.writer_registry.BaseWriter.plot)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.plot">plot</a></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Logs model plots using provided
plotting functions.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="log_model(model, train_dataloader=None, val_dataloader=None, test_dataloader=None)

  
      abstractmethod
   (qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_model)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_model">log_model</a></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Logs the model and any relevant information.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.close" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Closes the writer and finalizes logging.</p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Closes the writer and finalizes logging.&quot;&quot;&quot;</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Writers must implement a close method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_hyperparams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_hyperparams</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Logs hyperparameters.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hyperparams</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary of hyperparameters to log.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="k">def</span><span class="w"> </span><span class="nf">log_hyperparams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyperparams</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    Logs hyperparameters.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        hyperparams (dict): A dictionary of hyperparameters to log.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Writers must implement a log_hyperparams method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Logs the model and associated data.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to log.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>train_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>val_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for testing data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="k">def</span><span class="w"> </span><span class="nf">log_model</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="n">train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    Logs the model and associated data.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        model (Module): The model to log.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        train_dataloader (DataLoader | DictDataLoader |  None): DataLoader for training data.</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        val_dataloader (DataLoader | DictDataLoader |  None): DataLoader for validation data.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        test_dataloader (DataLoader | DictDataLoader |  None): DataLoader for testing data.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Writers must implement a log_model method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.open" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">open</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">iteration</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Opens the writer and prepares it for logging.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Configuration object containing settings for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>iteration</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The iteration step to start logging from.
Defaults to None.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Opens the writer and prepares it for logging.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        config: Configuration object containing settings for logging.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        iteration (int, optional): The iteration step to start logging from.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Writers must implement an open method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">iteration</span><span class="p">,</span> <span class="n">plotting_functions</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Logs plots of the model using provided plotting functions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to plot.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>iteration</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current iteration number.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plotting_functions</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Functions used to
generate plots.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span>[<span title="qadence.ml_tools.callbacks.writer_registry.PlottingFunction">PlottingFunction</span>, ...]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">plotting_functions</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">PlottingFunction</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    Logs plots of the model using provided plotting functions.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        model (Module): The model to plot.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        iteration (int): The current iteration number.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        plotting_functions (tuple[PlottingFunction, ...]): Functions used to</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            generate plots.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Writers must implement a plot method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.print_metrics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_metrics</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Prints the metrics and loss in a readable format.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>result</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The optimization results to display.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="OptimizeResult(iteration, model, optimizer, loss=None, metrics=lambda: dict()(), extra=lambda: dict()(), rank=0, device='cpu')

  
      dataclass
   (qadence.ml_tools.data.OptimizeResult)" href="#qadence.ml_tools.data.OptimizeResult">OptimizeResult</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="k">def</span><span class="w"> </span><span class="nf">print_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="n">OptimizeResult</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints the metrics and loss in a readable format.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        result (OptimizeResult): The optimization results to display.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="c1"># Find the key in result.metrics that contains &quot;loss&quot; (case-insensitive)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">loss_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">metrics</span> <span class="k">if</span> <span class="s2">&quot;loss&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">()),</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="n">initial</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;P </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">rank</span><span class="si">:</span><span class="s2"> &gt;2</span><span class="si">}</span><span class="s2">|</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">device</span><span class="si">:</span><span class="s2"> &lt;7</span><span class="si">}</span><span class="s2">| Iteration </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">iteration</span><span class="si">:</span><span class="s2"> &gt;7</span><span class="si">}</span><span class="s2">| &quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">if</span> <span class="n">loss_key</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">loss_value</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="n">loss_key</span><span class="p">]</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="n">initial</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">loss_key</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">loss_value</span><span class="si">:</span><span class="s2">.7f</span><span class="si">}</span><span class="s2"> -&quot;</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="n">initial</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;Loss: None -&quot;</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.7f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">loss_key</span><span class="p">])</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.write" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Logs the results of the current iteration.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>iteration</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current training iteration.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metrics</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary of metrics to log, where keys are metric names
            and values are the corresponding metric values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="k">def</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">metrics</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    Logs the results of the current iteration.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        iteration (int): The current training iteration.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        metrics (dict): A dictionary of metrics to log, where keys are metric names</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">                        and values are the corresponding metric values.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Writers must implement a write method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">MLFlowWriter</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code></p>


        <p>Writer for logging to MLflow.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.run">run</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The active MLflow run.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="mlflow.entities.Run">Run</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.mlflow">mlflow</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The MLflow module.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="types.ModuleType">ModuleType</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">mlflow.entities</span><span class="w"> </span><span class="kn">import</span> <span class="n">Run</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="s2">&quot;mlflow is not installed. Please install qadence with the mlflow feature: &quot;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="s2">&quot;`pip install qadence[mlflow]`.&quot;</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="p">)</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">:</span> <span class="n">Run</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="p">:</span> <span class="n">ModuleType</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.close" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Closes the MLflow run.</p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Closes the MLflow run.&quot;&quot;&quot;</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">:</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">end_run</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.get_signature_from_dataloader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_signature_from_dataloader</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Infers the signature of the model based on the input data from the dataloader.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to use for inference.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for model inputs.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="typing.Any">Any</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Optional[Any]: The inferred signature, if available.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_signature_from_dataloader</span><span class="p">(</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    Infers the signature of the model based on the input data from the dataloader.</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        model (Module): The model to use for inference.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">        dataloader (DataLoader | DictDataLoader |  None): DataLoader for model inputs.</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">        Optional[Any]: The inferred signature, if available.</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">mlflow.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">infer_signature</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="k">if</span> <span class="n">dataloader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="n">xs</span><span class="p">:</span> <span class="n">InputData</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="n">xs</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">dataloader</span><span class="p">))</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">xs</span> <span class="o">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="n">preds</span> <span class="o">=</span> <span class="n">preds</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="k">return</span> <span class="n">infer_signature</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.log_hyperparams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_hyperparams</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Logs hyperparameters to MLflow.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hyperparams</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary of hyperparameters to log.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="k">def</span><span class="w"> </span><span class="nf">log_hyperparams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyperparams</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">    Logs hyperparameters to MLflow.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        hyperparams (dict): A dictionary of hyperparameters to log.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="p">:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">log_params</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing&quot;</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.log_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Logs the model and its signature to MLflow using the provided data loaders.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to log.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>train_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>val_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for testing data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="k">def</span><span class="w"> </span><span class="nf">log_model</span><span class="p">(</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="n">train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="n">val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="n">test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">    Logs the model and its signature to MLflow using the provided data loaders.</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        model (Module): The model to log.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">        train_dataloader (DataLoader | DictDataLoader |  None): DataLoader for training data.</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">        val_dataloader (DataLoader | DictDataLoader |  None): DataLoader for validation data.</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">        test_dataloader (DataLoader | DictDataLoader |  None): DataLoader for testing data.</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="p">:</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing&quot;</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="p">)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="n">signatures</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signature_from_dataloader</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_dataloader</span><span class="p">)</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">pytorch</span><span class="o">.</span><span class="n">log_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">artifact_path</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">signature</span><span class="o">=</span><span class="n">signatures</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.open" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">open</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">iteration</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Opens the MLflow writer and initializes an MLflow run.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Configuration object containing settings for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>iteration</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The iteration step to start logging from.
Defaults to None.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mlflow</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The MLflow module instance.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="types.ModuleType">ModuleType</span> | None</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModuleType</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">    Opens the MLflow writer and initializes an MLflow run.</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        config: Configuration object containing settings for logging.</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        iteration (int, optional): The iteration step to start logging from.</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        mlflow: The MLflow module instance.</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">mlflow</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span> <span class="o">=</span> <span class="n">mlflow</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="n">tracking_uri</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;MLFLOW_TRACKING_URI&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;MLFLOW_EXPERIMENT_NAME&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">()))</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="n">run_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;MLFLOW_RUN_NAME&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">()))</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="p">:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">set_tracking_uri</span><span class="p">(</span><span class="n">tracking_uri</span><span class="p">)</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="c1"># Create or get the experiment</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="n">exp_filter_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;name = &#39;</span><span class="si">{</span><span class="n">experiment_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="n">experiments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">search_experiments</span><span class="p">(</span><span class="n">filter_string</span><span class="o">=</span><span class="n">exp_filter_string</span><span class="p">)</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">experiments</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">create_experiment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">experiment_name</span><span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">set_experiment</span><span class="p">(</span><span class="n">experiment_name</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span><span class="n">run_name</span><span class="o">=</span><span class="n">run_name</span><span class="p">,</span> <span class="n">nested</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">iteration</span><span class="p">,</span> <span class="n">plotting_functions</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Logs plots of the model using provided plotting functions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to plot.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>iteration</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current iteration number.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plotting_functions</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Functions used
to generate plots.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span>[<span title="qadence.ml_tools.callbacks.writer_registry.PlottingFunction">PlottingFunction</span>, ...]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="n">plotting_functions</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">PlottingFunction</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">    Logs plots of the model using provided plotting functions.</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        model (Module): The model to plot.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        iteration (int): The current iteration number.</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        plotting_functions (tuple[PlottingFunction, ...]): Functions used</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">            to generate plots.</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">plotting_functions</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>            <span class="n">descr</span><span class="p">,</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">pf</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">iteration</span><span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">log_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">descr</span><span class="p">)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.write" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Logs the results of the current iteration to MLflow.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>iteration</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current training iteration.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metrics</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary of metrics to log, where keys are metric names
            and values are the corresponding metric values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="k">def</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">metrics</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    Logs the results of the current iteration to MLflow.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        iteration (int): The current training iteration.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        metrics (dict): A dictionary of metrics to log, where keys are metric names</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">                        and values are the corresponding metric values.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="p">:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">log_metrics</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">iteration</span><span class="p">)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing.&quot;</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">TensorBoardWriter</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code></p>


        <p>Writer for logging to TensorBoard.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.writer">writer</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The TensorBoard SummaryWriter instance.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.tensorboard.SummaryWriter">SummaryWriter</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.close" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Closes the TensorBoard writer.</p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Closes the TensorBoard writer.&quot;&quot;&quot;</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.log_hyperparams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_hyperparams</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Logs hyperparameters to TensorBoard.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hyperparams</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary of hyperparameters to log.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="k">def</span><span class="w"> </span><span class="nf">log_hyperparams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyperparams</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    Logs hyperparameters to TensorBoard.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        hyperparams (dict): A dictionary of hyperparameters to log.</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">:</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_hparams</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">,</span> <span class="p">{})</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing&quot;</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.log_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Logs the model.</p>
<p>Currently not supported by TensorBoard.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to log.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>train_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>val_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test_dataloader</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for testing data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.data.DataLoader">DataLoader</span> | <a class="autorefs autorefs-internal" title="DictDataLoader(dataloaders)

  
      dataclass
   (qadence.ml_tools.data.DictDataLoader)" href="#qadence.ml_tools.data.DictDataLoader">DictDataLoader</a> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="k">def</span><span class="w"> </span><span class="nf">log_model</span><span class="p">(</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="n">train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="n">test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    Logs the model.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    Currently not supported by TensorBoard.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        model (Module): The model to log.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        train_dataloader (DataLoader | DictDataLoader |  None): DataLoader for training data.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        val_dataloader (DataLoader | DictDataLoader |  None): DataLoader for validation data.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        test_dataloader (DataLoader | DictDataLoader |  None): DataLoader for testing data.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Model logging is not supported by tensorboard. No model will be logged.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.open" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">open</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">iteration</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Opens the TensorBoard writer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Configuration object containing settings for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="TrainConfig(max_iter=10000, print_every=0, write_every=0, checkpoint_every=0, plot_every=0, callbacks=lambda: list()(), log_model=False, root_folder=Path('./qml_logs'), create_subfolder_per_run=False, log_folder=Path('./'), checkpoint_best_only=False, val_every=0, val_epsilon=1e-05, validation_criterion=None, trainstop_criterion=None, batch_size=1, verbose=True, tracking_tool=ExperimentTrackingTool.TENSORBOARD, hyperparams=dict(), plotting_functions=tuple(), _subfolders=list(), nprocs=1, compute_setup='cpu', backend='gloo', log_setup='cpu', dtype=None, all_reduce_metrics=False)

  
      dataclass
   (qadence.ml_tools.config.TrainConfig)" href="#qadence.ml_tools.config.TrainConfig">TrainConfig</a></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>iteration</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The iteration step to start logging from.
Defaults to None.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>SummaryWriter</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The initialized TensorBoard writer.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.utils.tensorboard.SummaryWriter">SummaryWriter</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SummaryWriter</span><span class="p">:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Opens the TensorBoard writer.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        config: Configuration object containing settings for logging.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        iteration (int, optional): The iteration step to start logging from.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        SummaryWriter: The initialized TensorBoard writer.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="n">log_dir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">log_folder</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="n">purge_step</span> <span class="o">=</span> <span class="n">iteration</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="n">SummaryWriter</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">purge_step</span><span class="o">=</span><span class="n">purge_step</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">iteration</span><span class="p">,</span> <span class="n">plotting_functions</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Logs plots of the model using provided plotting functions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to plot.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>iteration</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current iteration number.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plotting_functions</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Functions used
to generate plots.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span>[<span title="qadence.ml_tools.callbacks.writer_registry.PlottingFunction">PlottingFunction</span>, ...]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="n">plotting_functions</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">PlottingFunction</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    Logs plots of the model using provided plotting functions.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        model (Module): The model to plot.</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        iteration (int): The current iteration number.</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        plotting_functions (tuple[PlottingFunction, ...]): Functions used</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">            to generate plots.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">plotting_functions</span><span class="p">:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="n">descr</span><span class="p">,</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">pf</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">iteration</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_figure</span><span class="p">(</span><span class="n">descr</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">iteration</span><span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing&quot;</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.write" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Logs the results of the current iteration to TensorBoard.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>iteration</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current training iteration.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metrics</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary of metrics to log, where keys are metric names
            and values are the corresponding metric values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="k">def</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">metrics</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    Logs the results of the current iteration to TensorBoard.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        iteration (int): The current training iteration.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        metrics (dict): A dictionary of metrics to log, where keys are metric names</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">                        and values are the corresponding metric values.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">iteration</span><span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing.&quot;</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.callbacks.writer_registry.get_writer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_writer</span><span class="p">(</span><span class="n">tracking_tool</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Factory method to get the appropriate writer based on the tracking tool.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tracking_tool</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The experiment tracking tool to use.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="ExperimentTrackingTool (qadence.types.ExperimentTrackingTool)" href="../types/#qadence.types.ExperimentTrackingTool">ExperimentTrackingTool</a></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>BaseWriter</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>An instance of the appropriate writer.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><a class="autorefs autorefs-internal" title="BaseWriter (qadence.ml_tools.callbacks.writer_registry.BaseWriter)" href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter">BaseWriter</a></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_writer</span><span class="p">(</span><span class="n">tracking_tool</span><span class="p">:</span> <span class="n">ExperimentTrackingTool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseWriter</span><span class="p">:</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Factory method to get the appropriate writer based on the tracking tool.</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">        tracking_tool (ExperimentTrackingTool): The experiment tracking tool to use.</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        BaseWriter: An instance of the appropriate writer.</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="n">writer_class</span> <span class="o">=</span> <span class="n">WRITER_REGISTRY</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tracking_tool</span><span class="p">)</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="k">if</span> <span class="n">writer_class</span><span class="p">:</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="k">return</span> <span class="n">writer_class</span><span class="p">()</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported tracking tool: </span><span class="si">{</span><span class="n">tracking_tool</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.information.information_content.InformationContent" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">InformationContent</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">epsilons</span><span class="p">,</span> <span class="n">variation_multiple</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


        <p>Information Landscape class.</p>
<p>This class handles the study of loss landscape from information theoretic
perspective and provides methods to get bounds on the norm of the
gradient from the Information Content of the loss landscape.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The quantum or classical model to analyze.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_fn</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Loss function that takes model output and calculates loss</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Callable">Callable</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Input data to evaluate the model on</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>epsilons</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The thresholds to use for discretization of the finite derivatives</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.Tensor">Tensor</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variation_multiple</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The number of sets of variational parameters to generate per each
variational parameter. The number of variational parameters required for the
statistical analysis scales linearly with the amount of them present in the
model. This is that linear factor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>20</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>This class provides flexibility in terms of what the model, the loss function,
and the xs are. The only requirement is that the loss_fn takes the model and xs as
arguments and returns the loss, and another dictionary of other metrics.</p>
<p>Thus, assumed structure:
    loss_fn(model, xs) -&gt; (loss, metrics, ...)</p>
<p>Example: A Classifier
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">loss_fn</span><span class="p">(</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">xs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">xs</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()}</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">xs</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">info_landscape</span> <span class="o">=</span> <span class="n">InfoLandscape</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
</code></pre></div>
    In this example, the model is a linear classifier, and the <code>xs</code> include both the
    inputs and the target labels. The logic for calculation of the loss from this lies
    entirely within the <code>loss_fn</code> function. This can then further be used to obtain the
    bounds on the average norm of the gradient of the loss function.</p>
<p>Example: A Physics Informed Neural Network
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">PhysicsInformedNN</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="o">//</span> <span class="o">&lt;</span><span class="n">Initialization</span> <span class="n">Logic</span><span class="o">&gt;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]):</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>            <span class="s2">&quot;pde_residual&quot;</span><span class="p">:</span> <span class="n">pde_residual</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="s2">&quot;pde&quot;</span><span class="p">]),</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>            <span class="s2">&quot;boundary_condition&quot;</span><span class="p">:</span> <span class="n">bc_term</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="s2">&quot;bc&quot;</span><span class="p">]),</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>        <span class="p">}</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="k">def</span><span class="w"> </span><span class="nf">loss_fn</span><span class="p">(</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">PhysicsInformedNN</span><span class="p">,</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    <span class="n">xs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    <span class="n">pde_residual</span><span class="p">,</span> <span class="n">bc_term</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>    <span class="n">loss</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pde_residual</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>        <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">bc_term</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>    <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;pde_residual&quot;</span><span class="p">:</span> <span class="n">pde_residual</span><span class="p">,</span> <span class="s2">&quot;bc_term&quot;</span><span class="p">:</span> <span class="n">bc_term</span><span class="p">}</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="n">xs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>    <span class="s2">&quot;pde&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>    <span class="s2">&quot;bc&quot;</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="p">}</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="n">info_landscape</span> <span class="o">=</span> <span class="n">InfoLandscape</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
</code></pre></div></p>
<div class="highlight"><pre><span></span><code>In this example, the model is a Physics Informed Neural Network, and the `xs`
are the inputs to the different residual components of the model. The logic
for calculation of the residuals lies within the PhysicsInformedNN class, and
the loss function is defined to calculate the loss that is to be optimized
from these residuals. This can then further be used to obtain the
bounds on the average norm of the gradient of the loss function.
</code></pre></div>
<p>The first value that the <code>loss_fn</code> returns is the loss value that is being optimized.
The function is also expected to return other value(s), often the metrics that are
used to calculate the loss. These values are ignored for the purpose of this class.</p>
</details>






                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/information/information_content.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">loss_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">xs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">epsilons</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">variation_multiple</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Information Landscape class.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    This class handles the study of loss landscape from information theoretic</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    perspective and provides methods to get bounds on the norm of the</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    gradient from the Information Content of the loss landscape.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        model: The quantum or classical model to analyze.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        loss_fn: Loss function that takes model output and calculates loss</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        xs: Input data to evaluate the model on</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        epsilons: The thresholds to use for discretization of the finite derivatives</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        variation_multiple: The number of sets of variational parameters to generate per each</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">            variational parameter. The number of variational parameters required for the</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">            statistical analysis scales linearly with the amount of them present in the</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            model. This is that linear factor.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        This class provides flexibility in terms of what the model, the loss function,</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        and the xs are. The only requirement is that the loss_fn takes the model and xs as</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        arguments and returns the loss, and another dictionary of other metrics.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        Thus, assumed structure:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            loss_fn(model, xs) -&gt; (loss, metrics, ...)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        Example: A Classifier</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            model = nn.Linear(10, 1)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">            def loss_fn(</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">                model: nn.Module,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">                xs: tuple[torch.Tensor, torch.Tensor]</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            ) -&gt; tuple[torch.Tensor, dict[str, float]:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">                criterion = nn.MSELoss()</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">                inputs, labels = xs</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">                outputs = model(inputs)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">                loss = criterion(outputs, labels)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">                metrics = {&quot;loss&quot;: loss.item()}</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">                return loss, metrics</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">            xs = (torch.randn(10, 10), torch.randn(10, 1))</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">            info_landscape = InfoLandscape(model, loss_fn, xs)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">            ```</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            In this example, the model is a linear classifier, and the `xs` include both the</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">            inputs and the target labels. The logic for calculation of the loss from this lies</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            entirely within the `loss_fn` function. This can then further be used to obtain the</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">            bounds on the average norm of the gradient of the loss function.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        Example: A Physics Informed Neural Network</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            class PhysicsInformedNN(nn.Module):</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">                // &lt;Initialization Logic&gt;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">                def forward(self, xs: dict[str, torch.Tensor]):</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">                    return {</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">                        &quot;pde_residual&quot;: pde_residual(xs[&quot;pde&quot;]),</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">                        &quot;boundary_condition&quot;: bc_term(xs[&quot;bc&quot;]),</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">                    }</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">            def loss_fn(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">                model: PhysicsInformedNN,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">                xs: dict[str, torch.Tensor]</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">            ) -&gt; tuple[torch.Tensor, dict[str, float]:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">                pde_residual, bc_term = model(xs)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">                loss = torch.mean(torch.sum(pde_residual**2, dim=1), dim=0)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">                    + torch.mean(torch.sum(bc_term**2, dim=1), dim=0)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">                return loss, {&quot;pde_residual&quot;: pde_residual, &quot;bc_term&quot;: bc_term}</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            xs = {</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">                &quot;pde&quot;: torch.linspace(0, 1, 10),</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">                &quot;bc&quot;: torch.tensor([0.0]),</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            }</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            info_landscape = InfoLandscape(model, loss_fn, xs)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">            ```</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            In this example, the model is a Physics Informed Neural Network, and the `xs`</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">            are the inputs to the different residual components of the model. The logic</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">            for calculation of the residuals lies within the PhysicsInformedNN class, and</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">            the loss function is defined to calculate the loss that is to be optimized</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">            from these residuals. This can then further be used to obtain the</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">            bounds on the average norm of the gradient of the loss function.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        The first value that the `loss_fn` returns is the loss value that is being optimized.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        The function is also expected to return other value(s), often the metrics that are</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        used to calculate the loss. These values are ignored for the purpose of this class.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span> <span class="o">=</span> <span class="n">loss_fn</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">xs</span> <span class="o">=</span> <span class="n">xs</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">epsilons</span> <span class="o">=</span> <span class="n">epsilons</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">param_shapes</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">total_params</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">param_shapes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">total_params</span> <span class="o">+=</span> <span class="n">param</span><span class="o">.</span><span class="n">numel</span><span class="p">()</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">n_variations</span> <span class="o">=</span> <span class="n">variation_multiple</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_params</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">all_variations</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_variations</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_params</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="p">)</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.information.information_content.InformationContent.calculate_IC" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_IC</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate Information Content for multiple epsilon values.</p>
<p>Returns: Tensor of IC values for each epsilon [n_epsilons]</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.information.information_content.InformationContent.batched_loss" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">batched_loss</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate loss for all parameter variations in a batched manner.</p>
<p>Returns: Tensor of loss values for each parameter variation</p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/information/information_content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="k">def</span><span class="w"> </span><span class="nf">batched_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate loss for all parameter variations in a batched manner.</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    Returns: Tensor of loss values for each parameter variation</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="n">param_variations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reshape_param_variations</span><span class="p">()</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="n">losses</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_variations</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_variations</span><span class="p">):</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">param</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">param_variations</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="n">current_model</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">functional_call</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,))</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="n">losses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">current_model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="k">return</span> <span class="n">losses</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.information.information_content.InformationContent.calculate_transition_probabilities_batch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_transition_probabilities_batch</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate transition probabilities for multiple epsilon values.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="torch.Tensor">Tensor</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Tensor of shape [n_epsilons, 6] containing probabilities for each transition type</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="torch.Tensor">Tensor</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Columns order: [+1to0, +1to-1, 0to+1, 0to-1, -1to0, -1to+1]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/information/information_content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="k">def</span><span class="w"> </span><span class="nf">calculate_transition_probabilities_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    Calculate transition probabilities for multiple epsilon values.</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        Tensor of shape [n_epsilons, 6] containing probabilities for each transition type</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        Columns order: [+1to0, +1to-1, 0to+1, 0to-1, -1to0, -1to+1]</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="n">discretized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">discretize_derivatives</span><span class="p">()</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="n">current</span> <span class="o">=</span> <span class="n">discretized</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="n">next_val</span> <span class="o">=</span> <span class="n">discretized</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="n">transitions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="p">[</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="p">((</span><span class="n">current</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">next_val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="p">((</span><span class="n">current</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">next_val</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="p">((</span><span class="n">current</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">next_val</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="p">((</span><span class="n">current</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">next_val</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="p">((</span><span class="n">current</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">next_val</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="p">((</span><span class="n">current</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">next_val</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="p">],</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">total_transitions</span> <span class="o">=</span> <span class="n">current</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">probabilities</span> <span class="o">=</span> <span class="n">transitions</span> <span class="o">/</span> <span class="n">total_transitions</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="k">return</span> <span class="n">probabilities</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.information.information_content.InformationContent.discretize_derivatives" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">discretize_derivatives</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Convert finite derivatives into discrete values.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="torch.Tensor">Tensor</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Tensor containing discretized derivatives with shape [n_epsilons, n_variations-2]</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="torch.Tensor">Tensor</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Each row contains {-1, 0, 1} values for that epsilon</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/information/information_content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="k">def</span><span class="w"> </span><span class="nf">discretize_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    Convert finite derivatives into discrete values.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        Tensor containing discretized derivatives with shape [n_epsilons, n_variations-2]</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        Each row contains {-1, 0, 1} values for that epsilon</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="n">derivatives</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">randomized_finite_der</span><span class="p">()</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="n">derivatives</span> <span class="o">=</span> <span class="n">derivatives</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="n">epsilons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilons</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="n">discretized</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">epsilons</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">derivatives</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="n">discretized</span><span class="p">[</span><span class="n">derivatives</span> <span class="o">&gt;</span> <span class="n">epsilons</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="n">discretized</span><span class="p">[</span><span class="n">derivatives</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">epsilons</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="k">return</span> <span class="n">discretized</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.information.information_content.InformationContent.get_grad_norm_bounds_max_IC" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_grad_norm_bounds_max_IC</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Compute the bounds on the average norm of the gradient.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[Tensor, Tensor]: The lower and upper bounds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/information/information_content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_grad_norm_bounds_max_IC</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    Compute the bounds on the average norm of the gradient.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        tuple[Tensor, Tensor]: The lower and upper bounds.</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="n">max_IC</span><span class="p">,</span> <span class="n">epsilon_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_IC</span><span class="p">()</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="n">lower_bound</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="n">epsilon_m</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_params</span><span class="p">)</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="o">/</span> <span class="p">(</span><span class="n">NormalDist</span><span class="p">()</span><span class="o">.</span><span class="n">inv_cdf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_value</span><span class="p">(</span><span class="n">max_IC</span><span class="p">)))</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">upper_bound</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="n">epsilon_m</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_params</span><span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="o">/</span> <span class="p">(</span><span class="n">NormalDist</span><span class="p">()</span><span class="o">.</span><span class="n">inv_cdf</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_value</span><span class="p">(</span><span class="n">max_IC</span><span class="p">))))</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="k">if</span> <span class="n">max_IC</span> <span class="o">&lt;</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="s2">&quot;Warning: The maximum IC is less than the required value. The bounds may be&quot;</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>            <span class="o">+</span> <span class="s2">&quot; inaccurate.&quot;</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="p">)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="k">return</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.information.information_content.InformationContent.get_grad_norm_bounds_sensitivity_IC" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_grad_norm_bounds_sensitivity_IC</span><span class="p">(</span><span class="n">eta</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Compute the bounds on the average norm of the gradient.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>eta</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The sensitivity IC.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Tensor</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The lower bound.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/information/information_content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_grad_norm_bounds_sensitivity_IC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eta</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    Compute the bounds on the average norm of the gradient.</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        eta (float): The sensitivity IC.</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        Tensor: The lower bound.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="n">epsilon_sensitivity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_IC</span><span class="p">(</span><span class="n">eta</span><span class="p">)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="n">upper_bound</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="n">epsilon_sensitivity</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_params</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">NormalDist</span><span class="p">()</span><span class="o">.</span><span class="n">inv_cdf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">eta</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="k">return</span> <span class="n">upper_bound</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.information.information_content.InformationContent.max_IC" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_IC</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Get the maximum Information Content and its corresponding epsilon.</p>
<p>Returns: Tuple of (maximum IC value, optimal epsilon)</p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/information/information_content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="k">def</span><span class="w"> </span><span class="nf">max_IC</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    Get the maximum Information Content and its corresponding epsilon.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    Returns: Tuple of (maximum IC value, optimal epsilon)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="n">max_ic</span><span class="p">,</span> <span class="n">max_idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculate_IC</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="n">max_epsilon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilons</span><span class="p">[</span><span class="n">max_idx</span><span class="p">]</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="k">return</span> <span class="n">max_ic</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">max_epsilon</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.information.information_content.InformationContent.q_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">q_value</span><span class="p">(</span><span class="n">H_value</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Compute the q value.</p>
<p>q is the solution to the equation:
H(x) = 4h(x) + 2h(1/2 - 2x)</p>
<p>It is the value of the probability of 4 of the 6 transitions such that
the IC is the same as the IC of our system.</p>
<p>This quantity is useful in calculating the bounds on the norms of the gradients.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>H_value</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The information content.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>float</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The q value</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/information/information_content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="k">def</span><span class="w"> </span><span class="nf">q_value</span><span class="p">(</span><span class="n">H_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">    Compute the q value.</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">    q is the solution to the equation:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">    H(x) = 4h(x) + 2h(1/2 - 2x)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">    It is the value of the probability of 4 of the 6 transitions such that</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    the IC is the same as the IC of our system.</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">    This quantity is useful in calculating the bounds on the norms of the gradients.</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        H_value (float): The information content.</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        float: The q value</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.16667</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="mf">0.5</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="p">)</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="n">err</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span> <span class="o">-</span> <span class="n">H_value</span><span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="n">idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.information.information_content.InformationContent.randomized_finite_der" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">randomized_finite_der</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate normalized finite difference of loss on doing random walk in the parameter space.</p>
<p>This serves as a proxy for the derivative of the loss with respect to parameters.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="torch.Tensor">Tensor</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Tensor containing normalized finite differences (approximate directional derivatives)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="torch.Tensor">Tensor</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>between consecutive points in the random walk. Shape: [n_variations - 1]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/information/information_content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="k">def</span><span class="w"> </span><span class="nf">randomized_finite_der</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    Calculate normalized finite difference of loss on doing random walk in the parameter space.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    This serves as a proxy for the derivative of the loss with respect to parameters.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        Tensor containing normalized finite differences (approximate directional derivatives)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        between consecutive points in the random walk. Shape: [n_variations - 1]</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="n">losses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batched_loss</span><span class="p">()</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">losses</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">losses</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_variations</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_variations</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-8</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.information.information_content.InformationContent.reshape_param_variations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reshape_param_variations</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Reshape variations of the model's variational parameters.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="torch.Tensor">Tensor</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dictionary of parameter tensors, each with shape [n_variations, *param_shape]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/information/information_content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="k">def</span><span class="w"> </span><span class="nf">reshape_param_variations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reshape variations of the model&#39;s variational parameters.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        Dictionary of parameter tensors, each with shape [n_variations, *param_shape]</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="n">param_variations</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="n">start_idx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">shape</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_shapes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="n">param_size</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">shape</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">param_variations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_variations</span><span class="p">[</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="p">:,</span> <span class="n">start_idx</span> <span class="p">:</span> <span class="n">start_idx</span> <span class="o">+</span> <span class="n">param_size</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_variations</span><span class="p">,</span> <span class="o">*</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">start_idx</span> <span class="o">+=</span> <span class="n">param_size</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="k">return</span> <span class="n">param_variations</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.information.information_content.InformationContent.sensitivity_IC" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sensitivity_IC</span><span class="p">(</span><span class="n">eta</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Find the minimum value of epsilon such that the information content is less than eta.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>eta</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Threshold value, the sensitivity IC.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns: The epsilon value that gives IC that is less than the sensitivity IC.</p>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/information/information_content.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="k">def</span><span class="w"> </span><span class="nf">sensitivity_IC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eta</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">    Find the minimum value of epsilon such that the information content is less than eta.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        eta: Threshold value, the sensitivity IC.</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">    Returns: The epsilon value that gives IC that is less than the sensitivity IC.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">ic_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_IC</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">mask</span> <span class="o">=</span> <span class="n">ic_values</span> <span class="o">&lt;</span> <span class="n">eta</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="n">epsilons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilons</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">epsilons</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.train_utils.accelerator.Accelerator" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Accelerator</span><span class="p">(</span><span class="n">nprocs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">compute_setup</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">log_setup</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;gloo&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="qadence.ml_tools.train_utils.distribution.Distributor">Distributor</span></code></p>


        <p>A class for handling distributed training.</p>
<p>This class extends <code>Distributor</code> to manage distributed training using PyTorch's
<code>torch.distributed</code> API. It supports spawning multiple processes and wrapping models with
<code>DistributedDataParallel</code> (DDP) when required.</p>
<p>This class is provides head level method - distribute() - which wraps a function at a head process level,
before launching <code>nprocs</code> processes as required. Furthermore, it provides processes level methods,
such as prepare(), and prepare_batch() which can be run inside each process for correct movement and
preparation of model, optimizers and datasets.</p>


<details class="inherited-attributes" open>
  <summary>Inherited Attributes</summary>
  <p>nprocs (int): Number of processes to launch for distributed training.
execution (BaseExecution): Detected execution instance for process launch (e.g., "torchrun","default").
execution_type (ExecutionType): Type of execution used.
rank (int): Global rank of the process (to be set during environment setup).
world_size (int): Total number of processes (to be set during environment setup).
local_rank (int | None): Local rank on the node (to be set during environment setup).
master_addr (str): Master node address (to be set during environment setup).
master_port (str): Master node port (to be set during environment setup).
node_rank (int): Rank of the node on the cluster setup.</p>
</details>

<details class="note" open>
  <summary>There are three different indicators for number of processes executed.</summary>
  <ul>
<li>
<ol>
<li>self._config_nprocs: Number of processes specified by the user.
Provided in the initilization of the Accelerator. (acc = Accelerator(nprocs = 2))</li>
</ol>
</li>
<li>
<ol>
<li>self.nprocs: Number of processes defined at the head level.</li>
<li>When accelerator is used to spawn processes (e.g., In case default, python execution),
nprocs = _config_nprocs.</li>
<li>When an external elastic method is used to spawn processes (e.g., In case of torchrun),
nprocs = 1. This is because the external launcher already spawns multiple processes,
and the accelerator <strong>init</strong> is called from each process.</li>
</ol>
</li>
<li>
<ol>
<li>self.world_size: Number of processes actually executed.</li>
</ol>
</li>
</ul>
</details>
        <p>Initializes the Accelerator class.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>nprocs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Number of processes to launch. Default is 1.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>compute_setup</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Compute device setup; options are "auto" (default), "gpu", or "cpu".
- "auto": Uses GPU if available, otherwise CPU.
- "gpu": Forces GPU usage, raising an error if no CUDA device is available.
- "cpu": Forces CPU usage.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;auto&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_setup</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Logging device setup; options are "auto", "cpu" (default).
- "auto": Uses same device to log as used for computation.
- "cpu": Forces CPU logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;cpu&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>backend</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The backend for distributed communication. Default is "gloo".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;gloo&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Data type for controlling numerical precision. Default is None.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.dtype">dtype</span> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/train_utils/accelerator.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">nprocs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">compute_setup</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">log_setup</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">backend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gloo&quot;</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">torch_dtype</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    Initializes the Accelerator class.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        nprocs (int): Number of processes to launch. Default is 1.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        compute_setup (str): Compute device setup; options are &quot;auto&quot; (default), &quot;gpu&quot;, or &quot;cpu&quot;.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            - &quot;auto&quot;: Uses GPU if available, otherwise CPU.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            - &quot;gpu&quot;: Forces GPU usage, raising an error if no CUDA device is available.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            - &quot;cpu&quot;: Forces CPU usage.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        log_setup (str): Logging device setup; options are &quot;auto&quot;, &quot;cpu&quot; (default).</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            - &quot;auto&quot;: Uses same device to log as used for computation.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">            - &quot;cpu&quot;: Forces CPU logging.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        backend (str): The backend for distributed communication. Default is &quot;gloo&quot;.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        dtype (torch.dtype | None): Data type for controlling numerical precision. Default is None.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">nprocs</span><span class="p">,</span> <span class="n">compute_setup</span><span class="p">,</span> <span class="n">log_setup</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="c1"># Default values</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">local_rank</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">world_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">get_world_size</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nprocs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.accelerator.Accelerator.all_reduce_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">all_reduce_dict</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Performs an all-reduce operation on a dictionary of tensors, averaging values across all processes.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>d</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary where values are tensors to be reduced across processes.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="torch.Tensor">Tensor</span>]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>op</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Operation method to all_reduce with. Available options include <code>sum</code>, <code>avg</code>, and <code>max</code>.
            Defaults to <code>avg</code></p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;mean&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="torch.Tensor">Tensor</span>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>dict[str, torch.Tensor]: A dictionary with the reduced tensors, averaged over the world size.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/accelerator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="k">def</span><span class="w"> </span><span class="nf">all_reduce_dict</span><span class="p">(</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">op</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">    Performs an all-reduce operation on a dictionary of tensors, averaging values across all processes.</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">        d (dict[str, torch.Tensor]): A dictionary where values are tensors to be reduced across processes.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">        op (str): Operation method to all_reduce with. Available options include `sum`, `avg`, and `max`.</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">                        Defaults to `avg`</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">        dict[str, torch.Tensor]: A dictionary with the reduced tensors, averaged over the world size.</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="k">if</span> <span class="n">dist</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>        <span class="n">world_size</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">get_world_size</span><span class="p">()</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="n">reduced</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">tensor</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>                <span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>                    <span class="n">tensor</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">data_dtype</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>                <span class="p">)</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>            <span class="n">tensor</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>            <span class="k">if</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>                <span class="n">dist</span><span class="o">.</span><span class="n">all_reduce</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">dist</span><span class="o">.</span><span class="n">ReduceOp</span><span class="o">.</span><span class="n">MAX</span><span class="p">)</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>            <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;sum&quot;</span><span class="p">:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>                <span class="n">dist</span><span class="o">.</span><span class="n">all_reduce</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">dist</span><span class="o">.</span><span class="n">ReduceOp</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                <span class="n">dist</span><span class="o">.</span><span class="n">all_reduce</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="n">dist</span><span class="o">.</span><span class="n">ReduceOp</span><span class="o">.</span><span class="n">SUM</span><span class="p">)</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                <span class="n">tensor</span> <span class="o">/=</span> <span class="n">world_size</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>            <span class="n">reduced</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">tensor</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="k">return</span> <span class="n">reduced</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="k">return</span> <span class="n">d</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.accelerator.Accelerator.broadcast" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">broadcast</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Broadcasts an object from the source process to all processes.</p>
<p>On non-source processes, this value is ignored.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The object to broadcast on the source process.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>src</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The source process rank.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Any</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The broadcasted object from the source process.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/accelerator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="k">def</span><span class="w"> </span><span class="nf">broadcast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">    Broadcasts an object from the source process to all processes.</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">    On non-source processes, this value is ignored.</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">        obj (Any): The object to broadcast on the source process.</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">        src (int): The source process rank.</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        Any : The broadcasted object from the source process.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="k">if</span> <span class="n">dist</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">():</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="n">obj_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rank</span> <span class="o">==</span> <span class="n">src</span> <span class="k">else</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="n">dist</span><span class="o">.</span><span class="n">broadcast_object_list</span><span class="p">(</span><span class="n">obj_list</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="k">return</span> <span class="n">obj_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="k">return</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.accelerator.Accelerator.distribute" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">distribute</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Decorator to distribute the fit function across multiple processes.</p>
<p>This function is generic and can work with other methods as well.
Weather it is bound or unbound.</p>
<p>When applied to a function (typically a fit function), this decorator
will execute the function in a distributed fashion using torch.multiprocessing.
The number of processes used is determined by <code>self.nprocs</code>,
and if multiple nodes are involved (<code>self.num_nodes &gt; 1</code>), the process count is
adjusted accordingly. In single process mode (<code>self.nporcs</code> is 1), the function
is executed directly in the current process.</p>
<p>After execution, the decorator returns the model stored in <code>instance.model</code>.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fun</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The function to be decorated. This function usually implements
            a model fitting or training routine.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="callable">callable</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>callable</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The wrapped function. When called, it will execute in distributed mode
      (if configured) and return the value of <code>instance.model</code>.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Callable">Callable</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/accelerator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="k">def</span><span class="w"> </span><span class="nf">distribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    Decorator to distribute the fit function across multiple processes.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    This function is generic and can work with other methods as well.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">    Weather it is bound or unbound.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">    When applied to a function (typically a fit function), this decorator</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    will execute the function in a distributed fashion using torch.multiprocessing.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    The number of processes used is determined by `self.nprocs`,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    and if multiple nodes are involved (`self.num_nodes &gt; 1`), the process count is</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    adjusted accordingly. In single process mode (`self.nporcs` is 1), the function</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    is executed directly in the current process.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    After execution, the decorator returns the model stored in `instance.model`.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">    Parameters:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        fun (callable): The function to be decorated. This function usually implements</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">                        a model fitting or training routine.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        callable: The wrapped function. When called, it will execute in distributed mode</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">                  (if configured) and return the value of `instance.model`.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="c1"># Get the original picklable function</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="c1"># for the case of bound class method</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="c1"># as well as a function</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_class_method</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="n">instance</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="n">method_name</span> <span class="o">=</span> <span class="n">fun</span><span class="o">.</span><span class="vm">__name__</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_spawn_method</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="n">instance</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="c1"># method_name = fun.__name__</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="c1"># module = inspect.getmodule(fun)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="c1"># method = getattr(module, method_name) if module else fun</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_spawn_method</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="k">if</span> <span class="n">instance</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="s2">&quot;accelerator&quot;</span><span class="p">):</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="n">instance</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="c1"># TODO: Return the original returns from fun</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="c1"># Currently it only returns the model and optimizer</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="c1"># similar to the fit method.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>            <span class="k">return</span> <span class="n">instance</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">optimizer</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="k">return</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.accelerator.Accelerator.is_class_method" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_class_method</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Determines if <code>fun</code> is a class method or a standalone function.</p>
<p>Frist argument of the args should be:
- An object and has <strong>dict</strong>: making it a class
- Has a method named fun: making it a class that has this method.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fun</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The function being checked.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Callable">Callable</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The arguments passed to the function.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bool</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>True if <code>fun</code> is a class method, False otherwise.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/accelerator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_class_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    Determines if `fun` is a class method or a standalone function.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    Frist argument of the args should be:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    - An object and has __dict__: making it a class</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    - Has a method named fun: making it a class that has this method.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        fun (Callable): The function being checked.</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        args (tuple): The arguments passed to the function.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        bool: True if `fun` is a class method, False otherwise.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="nb">bool</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">object</span><span class="p">)</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;__dict__&quot;</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fun</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.accelerator.Accelerator.prepare" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Prepares models, optimizers, and dataloaders for distributed training.</p>
<p>This method iterates over the provided objects and:
- Moves models to the specified device (e.g., GPU or CPU) and casts them to the
    desired precision (specified by <code>self.dtype</code>). It then wraps models in
    DistributedDataParallel (DDP) if more than one device is used.
- Passes through optimizers unchanged.
- For dataloaders, it adjusts them to use a distributed sampler (if applicable)
    by calling a helper method. Note that only the sampler is prepared; moving the
    actual batch data to the device is handled separately during training.
    Please use the <code>prepare_batch</code> method to move the batch to correct device/dtype.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A variable number of objects to be prepared. These can include:
- PyTorch models (<code>nn.Module</code>)
- Optimizers (<code>optim.Optimizer</code>)
- DataLoaders (or a dictionary-like <code>DictDataLoader</code> of dataloaders)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>()</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span>[<span title="typing.Any">Any</span>, ...]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[Any, ...]: A tuple containing the prepared objects, where each object has been
            modified as needed to support distributed training.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/accelerator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="k">def</span><span class="w"> </span><span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    Prepares models, optimizers, and dataloaders for distributed training.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    This method iterates over the provided objects and:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    - Moves models to the specified device (e.g., GPU or CPU) and casts them to the</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        desired precision (specified by `self.dtype`). It then wraps models in</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        DistributedDataParallel (DDP) if more than one device is used.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    - Passes through optimizers unchanged.</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    - For dataloaders, it adjusts them to use a distributed sampler (if applicable)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        by calling a helper method. Note that only the sampler is prepared; moving the</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        actual batch data to the device is handled separately during training.</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        Please use the `prepare_batch` method to move the batch to correct device/dtype.</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        *args (Any): A variable number of objects to be prepared. These can include:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            - PyTorch models (`nn.Module`)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">            - Optimizers (`optim.Optimizer`)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">            - DataLoaders (or a dictionary-like `DictDataLoader` of dataloaders)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        tuple[Any, ...]: A tuple containing the prepared objects, where each object has been</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">                        modified as needed to support distributed training.</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="n">prepared</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="n">prepared</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="n">prepared</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_prepare_model</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">):</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="n">prepared</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_prepare_optimizer</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="n">DataLoader</span><span class="p">,</span> <span class="n">DictDataLoader</span><span class="p">)):</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="n">prepared</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_prepare_data</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="n">prepared</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">prepared</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.accelerator.Accelerator.prepare_batch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Moves a batch of data to the target device and casts it to the desired data dtype.</p>
<p>This method is typically called within the optimization step of your training loop.
It supports various batch formats:
    - If the batch is a dictionary, each value is moved individually.
    - If the batch is a tuple or list, each element is processed and returned as a tuple.
    - Otherwise, the batch is processed directly.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The batch of data to move to the device. This can be a dict, tuple, list,
         or any type compatible with <code>data_to_device</code>.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Any</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The batch with all elements moved to <code>self.device</code> and cast to <code>self.data_dtype</code>.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Any">Any</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/accelerator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="k">def</span><span class="w"> </span><span class="nf">prepare_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">    Moves a batch of data to the target device and casts it to the desired data dtype.</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">    This method is typically called within the optimization step of your training loop.</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">    It supports various batch formats:</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">        - If the batch is a dictionary, each value is moved individually.</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        - If the batch is a tuple or list, each element is processed and returned as a tuple.</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">        - Otherwise, the batch is processed directly.</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">        batch (Any): The batch of data to move to the device. This can be a dict, tuple, list,</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">                     or any type compatible with `data_to_device`.</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        Any: The batch with all elements moved to `self.device` and cast to `self.data_dtype`.</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>    <span class="k">if</span> <span class="n">batch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="n">key</span><span class="p">:</span> <span class="n">data_to_device</span><span class="p">(</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                <span class="n">value</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">data_dtype</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">batch</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="p">}</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="n">data_to_device</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">data_dtype</span><span class="p">)</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">batch</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="p">)</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="k">return</span> <span class="n">data_to_device</span><span class="p">(</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>            <span class="n">batch</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">execution</span><span class="o">.</span><span class="n">data_dtype</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="p">)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.accelerator.Accelerator.worker" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">worker</span><span class="p">(</span><span class="n">rank</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Worker function to be executed in each spawned process.</p>
<p>This function is called in every subprocess created by torch.multiprocessing (via mp.spawn).
It performs the following tasks:
  1. Sets up the accelerator for the given process rank. This typically involves configuring
     the GPU or other hardware resources for distributed training.
  2. If the retrieved method has been decorated (i.e. it has a '<strong>wrapped</strong>' attribute),
     the original, unwrapped function is invoked with the given arguments. Otherwise,
     the method is called directly.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rank</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The rank (or identifier) of the spawned process.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>instance</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The object (Trainer) that contains the method to execute.
               This object is expected to have an <code>accelerator</code> attribute with a <code>setup_process(rank)</code> method.
               This argument is optional, in case it is None, the fun will be called independently.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="object">object</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fun</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The function of the method on the instance to be executed.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Callable">Callable</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Positional arguments to pass to the target method.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Keyword arguments to pass to the target method.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/accelerator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="k">def</span><span class="w"> </span><span class="nf">worker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rank</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">instance</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">fun</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Worker function to be executed in each spawned process.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    This function is called in every subprocess created by torch.multiprocessing (via mp.spawn).</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    It performs the following tasks:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">      1. Sets up the accelerator for the given process rank. This typically involves configuring</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">         the GPU or other hardware resources for distributed training.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">      2. If the retrieved method has been decorated (i.e. it has a &#39;__wrapped__&#39; attribute),</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">         the original, unwrapped function is invoked with the given arguments. Otherwise,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">         the method is called directly.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        rank (int): The rank (or identifier) of the spawned process.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        instance (object): The object (Trainer) that contains the method to execute.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">                           This object is expected to have an `accelerator` attribute with a `setup_process(rank)` method.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">                           This argument is optional, in case it is None, the fun will be called independently.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        fun (Callable): The function of the method on the instance to be executed.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        args (tuple): Positional arguments to pass to the target method.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        kwargs (dict): Keyword arguments to pass to the target method.</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="c1"># Setup the accelerator for the given process rank (e.g., configuring GPU)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">if</span> <span class="n">instance</span> <span class="ow">and</span> <span class="n">instance</span><span class="o">.</span><span class="n">accelerator</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">instance</span><span class="o">.</span><span class="n">accelerator</span><span class="o">.</span><span class="n">setup_process</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">setup_process</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="s2">&quot;__wrapped__&quot;</span><span class="p">):</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="c1"># Explicitly get the original (unbound) method, passing in the instance.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="c1"># We need to call the original method in case so that MP spawn does not</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="c1"># create multiple processes. (To Avoid infinite loop)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">fun</span> <span class="o">=</span> <span class="n">fun</span><span class="o">.</span><span class="n">__wrapped__</span>  <span class="c1"># Unwrap if decorated</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="n">fun</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">if</span> <span class="n">instance</span> <span class="k">else</span> <span class="n">fun</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">fun</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tabs", "navigation.indexes", "navigation.sections", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../assets/_markdown_exec_pyodide.js"></script>
      
        <script src="../../extras/javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>