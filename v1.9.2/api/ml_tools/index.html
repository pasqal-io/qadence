
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://pasqal-io.github.io/qadence/v1.9.2/api/ml_tools/">
      
      
        <link rel="prev" href="../models/">
      
      
        <link rel="next" href="../serialization/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>QML tools - Qadence</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extras/css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extras/css/colors.css">
    
      <link rel="stylesheet" href="../../extras/css/home.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ml-tools" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Qadence" class="md-header__button md-logo" aria-label="Qadence" data-md-component="logo">
      
  <img src="../../extras/assets/logo/qadence_logo_small_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Qadence
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              QML tools
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pasqal-io/qadence/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    qadence
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting_started/installation/" class="md-tabs__link">
          
  
    
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../content/block_system/" class="md-tabs__link">
          
  
    
  
  Contents

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../tutorials/" class="md-tabs__link">
        
  
    
  
  Tutorials

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../blocks/" class="md-tabs__link">
          
  
    
  
  API

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Qadence" class="md-nav__button md-logo" aria-label="Qadence" data-md-component="logo">
      
  <img src="../../extras/assets/logo/qadence_logo_small_white.svg" alt="logo">

    </a>
    Qadence
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pasqal-io/qadence/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    qadence
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development & Info
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Development & Info
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/CODE_OF_CONDUCT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code of conduct
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/LICENSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contents
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Contents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/block_system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Block system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parametric programs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/quantummodels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantum models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/register/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantum registers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/state_init/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State initialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/hamiltonians/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arbitrary Hamiltonians
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/time_dependent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time-dependent generators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/qml_constructors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QML Constructors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/overlap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wavefunction overlaps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/backends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backends
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_11" >
        
          
          <label class="md-nav__link" for="__nav_3_11" id="__nav_3_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Useful info
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_11">
            <span class="md-nav__icon md-icon"></span>
            Useful info
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/state_conventions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State conventions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../content/serializ_and_prep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serialization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/digital_analog_qc/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Digital-analog quantum computing
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Digital-analog quantum computing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/analog-basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic operations on neutral-atoms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/analog-blocks-qcl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fitting a function with analog blocks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/semi-local-addressing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Restricted local addressability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/pulser-basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pulse-level programming with Pulser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/digital-analog-qcl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fitting a function with a Hamiltonian ansatz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/analog-qubo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solve a QUBO problem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/digital_analog_qc/daqc-cnot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CNOT with interacting qubits
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/qml/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Variational quantum algorithms
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Variational quantum algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/ml_tools/trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/ml_tools/callbacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Callbacks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/ml_tools/data_and_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data and Configurations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/config_qnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuring a QNN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/qcl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantum circuit learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/qaoa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solving MaxCut with QAOA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/qml/dqc_1d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Solving a 1D ODE
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/advanced_tutorials/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Advanced Tutorials
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Advanced Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/advanced_tutorials/differentiability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantum circuits differentiation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/advanced_tutorials/custom-models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom quantum models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/advanced_tutorials/projectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Projector blocks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/advanced_tutorials/profiling-and-debugging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling and debugging on CUDA devices
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials/realistic_sims/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Realistic simulations
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Realistic simulations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/realistic_sims/measurements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Measurement protocols
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/realistic_sims/noise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simulated errors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/realistic_sims/mitigation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Error mitigation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/development/architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture and sharp bits
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/development/draw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drawing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../blocks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Block system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../register/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Register
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quantumcircuit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QuantumCircuit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    State preparation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../noise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Noise
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constructors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transpile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transpilation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Execution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quantum models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    QML tools
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    QML tools
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ml-tools" class="md-nav__link">
    <span class="md-ellipsis">
      ML Tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ML Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer" class="md-nav__link">
    <span class="md-ellipsis">
      Trainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.build_optimize_result" class="md-nav__link">
    <span class="md-ellipsis">
      build_optimize_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_test_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_test_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_train_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_train_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_training" class="md-nav__link">
    <span class="md-ellipsis">
      run_training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_val_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_val_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_validation" class="md-nav__link">
    <span class="md-ellipsis">
      run_validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.test" class="md-nav__link">
    <span class="md-ellipsis">
      test
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig" class="md-nav__link">
    <span class="md-ellipsis">
      AnsatzConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AnsatzConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.ansatz_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      ansatz_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.ansatz_type" class="md-nav__link">
    <span class="md-ellipsis">
      ansatz_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.depth" class="md-nav__link">
    <span class="md-ellipsis">
      depth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.param_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      param_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.strategy_args" class="md-nav__link">
    <span class="md-ellipsis">
      strategy_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.tag" class="md-nav__link">
    <span class="md-ellipsis">
      tag
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureMapConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureMapConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.basis_set" class="md-nav__link">
    <span class="md-ellipsis">
      basis_set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.feature_map_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      feature_map_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.feature_range" class="md-nav__link">
    <span class="md-ellipsis">
      feature_range
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.inputs" class="md-nav__link">
    <span class="md-ellipsis">
      inputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.multivariate_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      multivariate_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.num_features" class="md-nav__link">
    <span class="md-ellipsis">
      num_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.num_repeats" class="md-nav__link">
    <span class="md-ellipsis">
      num_repeats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.operation" class="md-nav__link">
    <span class="md-ellipsis">
      operation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.param_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      param_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.reupload_scaling" class="md-nav__link">
    <span class="md-ellipsis">
      reupload_scaling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.tag" class="md-nav__link">
    <span class="md-ellipsis">
      tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.target_range" class="md-nav__link">
    <span class="md-ellipsis">
      target_range
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig" class="md-nav__link">
    <span class="md-ellipsis">
      TrainConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TrainConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.batch_size" class="md-nav__link">
    <span class="md-ellipsis">
      batch_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.checkpoint_best_only" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_best_only
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.checkpoint_every" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.create_subfolder_per_run" class="md-nav__link">
    <span class="md-ellipsis">
      create_subfolder_per_run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.log_folder" class="md-nav__link">
    <span class="md-ellipsis">
      log_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.max_iter" class="md-nav__link">
    <span class="md-ellipsis">
      max_iter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.plot_every" class="md-nav__link">
    <span class="md-ellipsis">
      plot_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.plotting_functions" class="md-nav__link">
    <span class="md-ellipsis">
      plotting_functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.print_every" class="md-nav__link">
    <span class="md-ellipsis">
      print_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.root_folder" class="md-nav__link">
    <span class="md-ellipsis">
      root_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.tracking_tool" class="md-nav__link">
    <span class="md-ellipsis">
      tracking_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.trainstop_criterion" class="md-nav__link">
    <span class="md-ellipsis">
      trainstop_criterion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.val_epsilon" class="md-nav__link">
    <span class="md-ellipsis">
      val_epsilon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.val_every" class="md-nav__link">
    <span class="md-ellipsis">
      val_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.validation_criterion" class="md-nav__link">
    <span class="md-ellipsis">
      validation_criterion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.verbose" class="md-nav__link">
    <span class="md-ellipsis">
      verbose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.write_every" class="md-nav__link">
    <span class="md-ellipsis">
      write_every
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.parameters.get_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.parameters.num_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      num_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.parameters.set_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      set_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.optimize_step.optimize_step" class="md-nav__link">
    <span class="md-ellipsis">
      optimize_step
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.optimize_step.update_ng_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      update_ng_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.DictDataLoader" class="md-nav__link">
    <span class="md-ellipsis">
      DictDataLoader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.InfiniteTensorDataset" class="md-nav__link">
    <span class="md-ellipsis">
      InfiniteTensorDataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult" class="md-nav__link">
    <span class="md-ellipsis">
      OptimizeResult
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OptimizeResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.extra" class="md-nav__link">
    <span class="md-ellipsis">
      extra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.iteration" class="md-nav__link">
    <span class="md-ellipsis">
      iteration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.loss" class="md-nav__link">
    <span class="md-ellipsis">
      loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      optimizer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.data_to_device" class="md-nav__link">
    <span class="md-ellipsis">
      data_to_device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.to_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      to_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN" class="md-nav__link">
    <span class="md-ellipsis">
      QNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN.from_configs" class="md-nav__link">
    <span class="md-ellipsis">
      from_configs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.derivative" class="md-nav__link">
    <span class="md-ellipsis">
      derivative
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.format_to_dict_fn" class="md-nav__link">
    <span class="md-ellipsis">
      format_to_dict_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback" class="md-nav__link">
    <span class="md-ellipsis">
      Callback
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Callback">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback.on" class="md-nav__link">
    <span class="md-ellipsis">
      on
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.EarlyStopping" class="md-nav__link">
    <span class="md-ellipsis">
      EarlyStopping
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EarlyStopping">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.EarlyStopping.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.GradientMonitoring" class="md-nav__link">
    <span class="md-ellipsis">
      GradientMonitoring
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GradientMonitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.GradientMonitoring.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCosineAnnealing" class="md-nav__link">
    <span class="md-ellipsis">
      LRSchedulerCosineAnnealing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LRSchedulerCosineAnnealing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCosineAnnealing.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCyclic" class="md-nav__link">
    <span class="md-ellipsis">
      LRSchedulerCyclic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LRSchedulerCyclic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCyclic.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerStepDecay" class="md-nav__link">
    <span class="md-ellipsis">
      LRSchedulerStepDecay
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LRSchedulerStepDecay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerStepDecay.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LoadCheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      LoadCheckpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LoadCheckpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LoadCheckpoint.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogHyperparameters" class="md-nav__link">
    <span class="md-ellipsis">
      LogHyperparameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LogHyperparameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogHyperparameters.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogModelTracker" class="md-nav__link">
    <span class="md-ellipsis">
      LogModelTracker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LogModelTracker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogModelTracker.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PlotMetrics" class="md-nav__link">
    <span class="md-ellipsis">
      PlotMetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PlotMetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PlotMetrics.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PrintMetrics" class="md-nav__link">
    <span class="md-ellipsis">
      PrintMetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PrintMetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PrintMetrics.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveBestCheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      SaveBestCheckpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SaveBestCheckpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveBestCheckpoint.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveCheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      SaveCheckpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SaveCheckpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveCheckpoint.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.WriteMetrics" class="md-nav__link">
    <span class="md-ellipsis">
      WriteMetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WriteMetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.WriteMetrics.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer" class="md-nav__link">
    <span class="md-ellipsis">
      BaseTrainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseTrainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      optimizer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.test_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      test_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.train_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      train_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.use_grad" class="md-nav__link">
    <span class="md-ellipsis">
      use_grad
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.val_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      val_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.callback" class="md-nav__link">
    <span class="md-ellipsis">
      callback
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.disable_grad_opt" class="md-nav__link">
    <span class="md-ellipsis">
      disable_grad_opt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.enable_grad_opt" class="md-nav__link">
    <span class="md-ellipsis">
      enable_grad_opt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_test_batch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_test_batch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_test_batch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_test_batch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_batch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_batch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_batch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_batch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_epoch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_epoch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_epoch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_epoch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_batch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_batch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_batch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_batch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_epoch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_epoch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_epoch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_epoch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.set_use_grad" class="md-nav__link">
    <span class="md-ellipsis">
      set_use_grad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter" class="md-nav__link">
    <span class="md-ellipsis">
      BaseWriter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      log_hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.print_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      print_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter" class="md-nav__link">
    <span class="md-ellipsis">
      MLFlowWriter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MLFlowWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.get_signature_from_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      get_signature_from_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.log_hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      log_hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter" class="md-nav__link">
    <span class="md-ellipsis">
      TensorBoardWriter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TensorBoardWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.log_hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      log_hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.get_writer" class="md-nav__link">
    <span class="md-ellipsis">
      get_writer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../serialization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../draw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Drawing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_16" >
        
          
          <label class="md-nav__link" for="__nav_5_16" id="__nav_5_16_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Backends
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_16">
            <span class="md-nav__icon md-icon"></span>
            Backends
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backends/backend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abstract backend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backends/pyqtorch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyQTorch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backends/pulser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pulser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backends/differentiable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DifferentiableBackend
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ml-tools" class="md-nav__link">
    <span class="md-ellipsis">
      ML Tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ML Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer" class="md-nav__link">
    <span class="md-ellipsis">
      Trainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.build_optimize_result" class="md-nav__link">
    <span class="md-ellipsis">
      build_optimize_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_test_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_test_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_train_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_train_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_training" class="md-nav__link">
    <span class="md-ellipsis">
      run_training
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_val_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_val_batch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.run_validation" class="md-nav__link">
    <span class="md-ellipsis">
      run_validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.trainer.Trainer.test" class="md-nav__link">
    <span class="md-ellipsis">
      test
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig" class="md-nav__link">
    <span class="md-ellipsis">
      AnsatzConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AnsatzConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.ansatz_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      ansatz_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.ansatz_type" class="md-nav__link">
    <span class="md-ellipsis">
      ansatz_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.depth" class="md-nav__link">
    <span class="md-ellipsis">
      depth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.param_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      param_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.strategy_args" class="md-nav__link">
    <span class="md-ellipsis">
      strategy_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.AnsatzConfig.tag" class="md-nav__link">
    <span class="md-ellipsis">
      tag
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureMapConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureMapConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.basis_set" class="md-nav__link">
    <span class="md-ellipsis">
      basis_set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.feature_map_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      feature_map_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.feature_range" class="md-nav__link">
    <span class="md-ellipsis">
      feature_range
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.inputs" class="md-nav__link">
    <span class="md-ellipsis">
      inputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.multivariate_strategy" class="md-nav__link">
    <span class="md-ellipsis">
      multivariate_strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.num_features" class="md-nav__link">
    <span class="md-ellipsis">
      num_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.num_repeats" class="md-nav__link">
    <span class="md-ellipsis">
      num_repeats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.operation" class="md-nav__link">
    <span class="md-ellipsis">
      operation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.param_prefix" class="md-nav__link">
    <span class="md-ellipsis">
      param_prefix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.reupload_scaling" class="md-nav__link">
    <span class="md-ellipsis">
      reupload_scaling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.tag" class="md-nav__link">
    <span class="md-ellipsis">
      tag
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.FeatureMapConfig.target_range" class="md-nav__link">
    <span class="md-ellipsis">
      target_range
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig" class="md-nav__link">
    <span class="md-ellipsis">
      TrainConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TrainConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.batch_size" class="md-nav__link">
    <span class="md-ellipsis">
      batch_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.checkpoint_best_only" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_best_only
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.checkpoint_every" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.create_subfolder_per_run" class="md-nav__link">
    <span class="md-ellipsis">
      create_subfolder_per_run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.log_folder" class="md-nav__link">
    <span class="md-ellipsis">
      log_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.max_iter" class="md-nav__link">
    <span class="md-ellipsis">
      max_iter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.plot_every" class="md-nav__link">
    <span class="md-ellipsis">
      plot_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.plotting_functions" class="md-nav__link">
    <span class="md-ellipsis">
      plotting_functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.print_every" class="md-nav__link">
    <span class="md-ellipsis">
      print_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.root_folder" class="md-nav__link">
    <span class="md-ellipsis">
      root_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.tracking_tool" class="md-nav__link">
    <span class="md-ellipsis">
      tracking_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.trainstop_criterion" class="md-nav__link">
    <span class="md-ellipsis">
      trainstop_criterion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.val_epsilon" class="md-nav__link">
    <span class="md-ellipsis">
      val_epsilon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.val_every" class="md-nav__link">
    <span class="md-ellipsis">
      val_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.validation_criterion" class="md-nav__link">
    <span class="md-ellipsis">
      validation_criterion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.verbose" class="md-nav__link">
    <span class="md-ellipsis">
      verbose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.config.TrainConfig.write_every" class="md-nav__link">
    <span class="md-ellipsis">
      write_every
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.parameters.get_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.parameters.num_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      num_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.parameters.set_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      set_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.optimize_step.optimize_step" class="md-nav__link">
    <span class="md-ellipsis">
      optimize_step
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.optimize_step.update_ng_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      update_ng_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.DictDataLoader" class="md-nav__link">
    <span class="md-ellipsis">
      DictDataLoader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.InfiniteTensorDataset" class="md-nav__link">
    <span class="md-ellipsis">
      InfiniteTensorDataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult" class="md-nav__link">
    <span class="md-ellipsis">
      OptimizeResult
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OptimizeResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.extra" class="md-nav__link">
    <span class="md-ellipsis">
      extra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.iteration" class="md-nav__link">
    <span class="md-ellipsis">
      iteration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.loss" class="md-nav__link">
    <span class="md-ellipsis">
      loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.OptimizeResult.optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      optimizer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.data_to_device" class="md-nav__link">
    <span class="md-ellipsis">
      data_to_device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.data.to_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      to_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN" class="md-nav__link">
    <span class="md-ellipsis">
      QNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.QNN.from_configs" class="md-nav__link">
    <span class="md-ellipsis">
      from_configs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.derivative" class="md-nav__link">
    <span class="md-ellipsis">
      derivative
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.models.format_to_dict_fn" class="md-nav__link">
    <span class="md-ellipsis">
      format_to_dict_fn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback" class="md-nav__link">
    <span class="md-ellipsis">
      Callback
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Callback">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback.on" class="md-nav__link">
    <span class="md-ellipsis">
      on
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.Callback.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.EarlyStopping" class="md-nav__link">
    <span class="md-ellipsis">
      EarlyStopping
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EarlyStopping">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.EarlyStopping.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.GradientMonitoring" class="md-nav__link">
    <span class="md-ellipsis">
      GradientMonitoring
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GradientMonitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.GradientMonitoring.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCosineAnnealing" class="md-nav__link">
    <span class="md-ellipsis">
      LRSchedulerCosineAnnealing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LRSchedulerCosineAnnealing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCosineAnnealing.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCyclic" class="md-nav__link">
    <span class="md-ellipsis">
      LRSchedulerCyclic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LRSchedulerCyclic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerCyclic.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerStepDecay" class="md-nav__link">
    <span class="md-ellipsis">
      LRSchedulerStepDecay
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LRSchedulerStepDecay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LRSchedulerStepDecay.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LoadCheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      LoadCheckpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LoadCheckpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LoadCheckpoint.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogHyperparameters" class="md-nav__link">
    <span class="md-ellipsis">
      LogHyperparameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LogHyperparameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogHyperparameters.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogModelTracker" class="md-nav__link">
    <span class="md-ellipsis">
      LogModelTracker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LogModelTracker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.LogModelTracker.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PlotMetrics" class="md-nav__link">
    <span class="md-ellipsis">
      PlotMetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PlotMetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PlotMetrics.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PrintMetrics" class="md-nav__link">
    <span class="md-ellipsis">
      PrintMetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PrintMetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.PrintMetrics.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveBestCheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      SaveBestCheckpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SaveBestCheckpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveBestCheckpoint.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveCheckpoint" class="md-nav__link">
    <span class="md-ellipsis">
      SaveCheckpoint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SaveCheckpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.SaveCheckpoint.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.WriteMetrics" class="md-nav__link">
    <span class="md-ellipsis">
      WriteMetrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WriteMetrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.callback.WriteMetrics.run_callback" class="md-nav__link">
    <span class="md-ellipsis">
      run_callback
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer" class="md-nav__link">
    <span class="md-ellipsis">
      BaseTrainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseTrainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      optimizer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.test_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      test_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.train_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      train_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.use_grad" class="md-nav__link">
    <span class="md-ellipsis">
      use_grad
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.val_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      val_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.callback" class="md-nav__link">
    <span class="md-ellipsis">
      callback
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.disable_grad_opt" class="md-nav__link">
    <span class="md-ellipsis">
      disable_grad_opt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.enable_grad_opt" class="md-nav__link">
    <span class="md-ellipsis">
      enable_grad_opt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_test_batch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_test_batch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_test_batch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_test_batch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_batch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_batch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_batch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_batch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_epoch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_epoch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_epoch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_epoch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_train_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_batch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_batch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_batch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_batch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_epoch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_epoch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_epoch_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_val_epoch_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.train_utils.base_trainer.BaseTrainer.set_use_grad" class="md-nav__link">
    <span class="md-ellipsis">
      set_use_grad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter" class="md-nav__link">
    <span class="md-ellipsis">
      BaseWriter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      log_hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.print_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      print_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.BaseWriter.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter" class="md-nav__link">
    <span class="md-ellipsis">
      MLFlowWriter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MLFlowWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.get_signature_from_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      get_signature_from_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.log_hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      log_hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter" class="md-nav__link">
    <span class="md-ellipsis">
      TensorBoardWriter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TensorBoardWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.log_hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      log_hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.open" class="md-nav__link">
    <span class="md-ellipsis">
      open
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qadence.ml_tools.callbacks.writer_registry.get_writer" class="md-nav__link">
    <span class="md-ellipsis">
      get_writer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>QML tools</h1>

<h2 id="ml-tools">ML Tools</h2>
<p>This module implements a <code>Trainer</code> class for torch <code>Modules</code> and <code>QuantumModel</code>. It also implements the <code>QNN</code> class and callbacks that can be used with the trainer module.</p>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.trainer.Trainer" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Trainer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">loss_fn</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">train_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">optimize_step</span><span class="o">=</span><span class="n">optimize_step</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_batches</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer" optional hover>BaseTrainer</autoref></code></p>


      <p>Trainer class to manage and execute training, validation, and testing loops for a model (eg.</p>
<p>QNN).</p>
<p>This class handles the overall training process, including:
- Managing epochs and steps
- Handling data loading and batching
- Computing and updating gradients
- Logging and monitoring training metrics</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.trainer.Trainer.current_epoch" optional hover>current_epoch</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The current epoch number.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.trainer.Trainer.global_step" optional hover>global_step</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The global step across all epochs.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.trainer.Trainer.log_device" optional hover>log_device</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Device for logging, default is "cpu".</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.trainer.Trainer.device" optional hover>device</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Device used for computation.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.device" optional hover>device</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.trainer.Trainer.dtype" optional hover>dtype</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Data type used for computation.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.dtype" optional hover>dtype</autoref> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.trainer.Trainer.data_dtype" optional hover>data_dtype</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Data type for data.
Depends on the model's data type.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.dtype" optional hover>dtype</autoref> | None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="inherited-attributes" open>
  <summary>Inherited Attributes</summary>
  <p>use_grad (bool): Indicates if gradients are used for optimization. Default is True.</p>
<p>model (nn.Module): The neural network model.
optimizer (optim.Optimizer | NGOptimizer | None): The optimizer for training.
config (TrainConfig): The configuration settings for training.
train_dataloader (DataLoader | DictDataLoader |  None): DataLoader for training data.
val_dataloader (DataLoader | DictDataLoader |  None): DataLoader for validation data.
test_dataloader (DataLoader | DictDataLoader |  None): DataLoader for testing data.</p>
<p>optimize_step (Callable): Function for performing an optimization step.
loss_fn (Callable): loss function to use.</p>
<p>num_training_batches (int): Number of training batches.
num_validation_batches (int): Number of validation batches.
num_test_batches (int): Number of test batches.</p>
<p>state (str): Current state in the training process</p>
</details>      <p>Default training routine
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>for epoch in max_iter + 1:
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    # Training
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    for batch in train_batches:
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        train model
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    # Validation
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    if val_every % epoch == 0:
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        for batch in val_batches:
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>            train model
</code></pre></div></p>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>In case of InfiniteTensorDataset, number of batches = 1.</li>
<li>In case of TensorDataset, number of batches are default.</li>
<li>Training is run for max_iter + 1 epochs. Epoch 0 logs untrained model.</li>
<li>Please look at the CallbackManager initialize_callbacks method to review the default
    logging behavior.</li>
</ul>
</details>      <p>Examples:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">torch.optim</span><span class="w"> </span><span class="kn">import</span> <span class="n">SGD</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">feature_map</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">hamiltonian_factory</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">hea</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">QNN</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">QuantumCircuit</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">TrainConfig</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">Z</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.trainer</span><span class="w"> </span><span class="kn">import</span> <span class="n">Trainer</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.optimize_step</span><span class="w"> </span><span class="kn">import</span> <span class="n">optimize_step</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_dataloader</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="c1"># Initialize the model</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="n">fm</span> <span class="o">=</span> <span class="n">feature_map</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">ansatz</span> <span class="o">=</span> <span class="n">hea</span><span class="p">(</span><span class="n">n_qubits</span><span class="o">=</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="n">observable</span> <span class="o">=</span> <span class="n">hamiltonian_factory</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">detuning</span><span class="o">=</span><span class="n">Z</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">ansatz</span><span class="p">)</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="n">model</span> <span class="o">=</span> <span class="n">QNN</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">observable</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;pyqtorch&quot;</span><span class="p">,</span> <span class="n">diff_mode</span><span class="o">=</span><span class="s2">&quot;ad&quot;</span><span class="p">)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="c1"># Set up the optimizer</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="n">optimizer</span> <span class="o">=</span> <span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="c1"># Use TrainConfig for configuring the training process</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    <span class="n">write_every</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>    <span class="n">checkpoint_every</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    <span class="n">val_every</span><span class="o">=</span><span class="mi">10</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="c1"># Create the Trainer instance with TrainConfig</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span><span class="p">,</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>    <span class="n">optimize_step</span><span class="o">=</span><span class="n">optimize_step</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">25</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="n">train_loader</span> <span class="o">=</span> <span class="n">to_dataloader</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">infinite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="n">val_loader</span> <span class="o">=</span> <span class="n">to_dataloader</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">infinite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="c1"># Train the model</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">)</span>
</code></pre></div>
<p>This also supports both gradient based and gradient free optimization.
The default support is for gradient based optimization.</p>
<p>Notes:</p>
<ul>
<li><strong>set_use_grad()</strong> (<em>class level</em>):This method is used to set the global <code>use_grad</code> flag,
    controlling whether the trainer uses gradient-based optimization.
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># gradient based</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">Trainer</span><span class="o">.</span><span class="n">set_use_grad</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># gradient free</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">Trainer</span><span class="o">.</span><span class="n">set_use_grad</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></li>
<li><strong>Context Managers</strong> (<em>instance level</em>):  <code>enable_grad_opt()</code> and <code>disable_grad_opt()</code> are
    context managers that temporarily switch the optimization mode for specific code blocks.
    This is useful when you want to mix gradient-based and gradient-free optimization
    in the same training process.
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># gradient based</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="k">with</span> <span class="n">trainer</span><span class="o">.</span><span class="n">enable_grad_opt</span><span class="p">(</span><span class="n">optimizer</span><span class="p">):</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c1"># gradient free</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="k">with</span> <span class="n">trainer</span><span class="o">.</span><span class="n">disable_grad_opt</span><span class="p">(</span><span class="n">ng_optimizer</span><span class="p">):</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</code></pre></div></li>
</ul>
<p>Examples</p>
<p><em>Gradient based optimization example Usage</em>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">optim</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">Trainer</span><span class="o">.</span><span class="n">set_use_grad</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="p">)</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">)</span>
</code></pre></div>
or
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="p">)</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="k">with</span> <span class="n">trainer</span><span class="o">.</span><span class="n">enable_grad_opt</span><span class="p">(</span><span class="n">optimizer</span><span class="p">):</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">)</span>
</code></pre></div></p>
<p><em>Gradient free optimization example Usage</em>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">nevergrad</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ng</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.parameters</span><span class="w"> </span><span class="kn">import</span> <span class="n">num_parameters</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">ng_optimizer</span> <span class="o">=</span> <span class="n">ng</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">NGOpt</span><span class="p">(</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>                <span class="n">budget</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">parametrization</span><span class="o">=</span> <span class="n">num_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>                <span class="p">)</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="n">Trainer</span><span class="o">.</span><span class="n">set_use_grad</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>    <span class="n">optimizer</span><span class="o">=</span><span class="n">ng_optimizer</span><span class="p">,</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="p">)</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">)</span>
</code></pre></div>
or
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">nevergrad</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ng</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.parameters</span><span class="w"> </span><span class="kn">import</span> <span class="n">num_parameters</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">ng_optimizer</span> <span class="o">=</span> <span class="n">ng</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">NGOpt</span><span class="p">(</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>        <span class="n">budget</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">parametrization</span><span class="o">=</span> <span class="n">num_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>        <span class="p">)</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="p">)</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="k">with</span> <span class="n">trainer</span><span class="o">.</span><span class="n">disable_grad_opt</span><span class="p">(</span><span class="n">ng_optimizer</span><span class="p">):</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>    <span class="n">trainer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">)</span>
</code></pre></div></p>

      <p>Initializes the Trainer class.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The PyTorch model to train.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>optimizer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The optimizer for training.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.optim.Optimizer" optional hover>Optimizer</autoref> | <autoref identifier="nevergrad.optimization.base.Optimizer" optional hover>Optimizer</autoref> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Training configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>loss_fn</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Loss function used for training.
If not specified, default mse loss will be used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref> | <autoref identifier="typing.Callable" optional hover>Callable</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;mse&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>train_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>val_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>test_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for test data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>optimize_step</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Function to execute an optimization step.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Callable" optional hover>Callable</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><autoref identifier="qadence.ml_tools.optimize_step.optimize_step" optional hover>optimize_step</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>device</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Device to use for computation.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.device" optional hover>device</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dtype</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Data type for computation.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.dtype" optional hover>dtype</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>max_batches</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum number of batches to process per epoch.
This is only valid in case of finite TensorDataset dataloaders.
if max_batches is not None, the maximum number of batches used will
be min(max_batches, len(dataloader.dataset))
In case of InfiniteTensorDataset only 1 batch per epoch is used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="n">optimizer</span><span class="p">:</span> <span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span> <span class="o">|</span> <span class="n">NGOptimizer</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="n">loss_fn</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="s2">&quot;mse&quot;</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="n">train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="n">test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="n">optimize_step</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">optimize_step</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">torch_device</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">torch_dtype</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="n">max_batches</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="p">):</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    Initializes the Trainer class.</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        model (nn.Module): The PyTorch model to train.</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        optimizer (optim.Optimizer | NGOptimizer | None): The optimizer for training.</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        config (TrainConfig): Training configuration object.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        loss_fn (str | Callable ): Loss function used for training.</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">            If not specified, default mse loss will be used.</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        train_dataloader (DataLoader | DictDataLoader |  None): DataLoader for training data.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        val_dataloader (DataLoader | DictDataLoader |  None): DataLoader for validation data.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        test_dataloader (DataLoader | DictDataLoader |  None): DataLoader for test data.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        optimize_step (Callable): Function to execute an optimization step.</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        device (torch_device): Device to use for computation.</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        dtype (torch_dtype): Data type for computation.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        max_batches (int | None): Maximum number of batches to process per epoch.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">            This is only valid in case of finite TensorDataset dataloaders.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">            if max_batches is not None, the maximum number of batches used will</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">            be min(max_batches, len(dataloader.dataset))</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">            In case of InfiniteTensorDataset only 1 batch per epoch is used.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="n">loss_fn</span><span class="o">=</span><span class="n">loss_fn</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">optimize_step</span><span class="o">=</span><span class="n">optimize_step</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="n">train_dataloader</span><span class="o">=</span><span class="n">train_dataloader</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">val_dataloader</span><span class="o">=</span><span class="n">val_dataloader</span><span class="p">,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">test_dataloader</span><span class="o">=</span><span class="n">test_dataloader</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="n">max_batches</span><span class="o">=</span><span class="n">max_batches</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">current_epoch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">global_step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">log_device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span> <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">device</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">:</span> <span class="n">torch_device</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">device</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span> <span class="n">torch_dtype</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">dtype</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">data_dtype</span><span class="p">:</span> <span class="n">torch_dtype</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stop_training</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_dtype</span> <span class="o">=</span> <span class="n">float64</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">complex128</span><span class="p">)</span> <span class="k">else</span> <span class="n">float32</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.build_optimize_result" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_optimize_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Builds and stores the optimization result by calculating the average loss and metrics.</p>
<p>Result (or loss_metrics) can have multiple formats:
- <code>None</code> Indicates no loss or metrics data is provided.
- <code>tuple[torch.Tensor, dict[str, Any]]</code> A single tuple containing the loss tensor
    and metrics dictionary - at the end of batch.
- <code>list[tuple[torch.Tensor, dict[str, Any]]]</code> A list of tuples for
    multiple batches.
- <code>list[list[tuple[torch.Tensor, dict[str, Any]]]]</code> A list of lists of tuples,
where each inner list represents metrics across multiple batches within an epoch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>result</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>(None |
    tuple[torch.Tensor, dict[Any, Any]] |
    list[tuple[torch.Tensor, dict[Any, Any]]] |
    list[list[tuple[torch.Tensor, dict[Any, Any]]]])
        The loss and metrics data, which can have multiple formats</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>None | <autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="dict" optional>dict</autoref>[<autoref identifier="typing.Any" optional hover>Any</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]] | <autoref identifier="list" optional>list</autoref>[<autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="dict" optional>dict</autoref>[<autoref identifier="typing.Any" optional hover>Any</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]] | <autoref identifier="list" optional>list</autoref>[<autoref identifier="list" optional>list</autoref>[<autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="dict" optional>dict</autoref>[<autoref identifier="typing.Any" optional hover>Any</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]]]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>None</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>This method does not return anything. It sets <code>self.opt_result</code> with</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code>None</code>
                  </span>
                </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>the computed average loss and metrics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="k">def</span><span class="w"> </span><span class="nf">build_optimize_result</span><span class="p">(</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>    <span class="n">result</span><span class="p">:</span> <span class="kc">None</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>    <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>    <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>    <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]],</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">    Builds and stores the optimization result by calculating the average loss and metrics.</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">    Result (or loss_metrics) can have multiple formats:</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a><span class="sd">    - `None` Indicates no loss or metrics data is provided.</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a><span class="sd">    - `tuple[torch.Tensor, dict[str, Any]]` A single tuple containing the loss tensor</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="sd">        and metrics dictionary - at the end of batch.</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="sd">    - `list[tuple[torch.Tensor, dict[str, Any]]]` A list of tuples for</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">        multiple batches.</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="sd">    - `list[list[tuple[torch.Tensor, dict[str, Any]]]]` A list of lists of tuples,</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">    where each inner list represents metrics across multiple batches within an epoch.</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a><span class="sd">        result: (None |</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="sd">                tuple[torch.Tensor, dict[Any, Any]] |</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="sd">                list[tuple[torch.Tensor, dict[Any, Any]]] |</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a><span class="sd">                list[list[tuple[torch.Tensor, dict[Any, Any]]]])</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">                    The loss and metrics data, which can have multiple formats</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a><span class="sd">        None: This method does not return anything. It sets `self.opt_result` with</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">        the computed average loss and metrics.</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>    <span class="n">loss_metrics</span> <span class="o">=</span> <span class="n">result</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>    <span class="k">if</span> <span class="n">loss_metrics</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="n">loss</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="n">metrics</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>        <span class="c1"># Single tuple case</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">loss_metrics</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="n">last_epoch</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>            <span class="c1"># Check if it&#39;s a list of tuples</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">loss_metrics</span><span class="p">):</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>                <span class="n">last_epoch</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="n">loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>            <span class="c1"># Check if it&#39;s a list of lists of tuples</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>            <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">loss_metrics</span><span class="p">):</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>                <span class="n">last_epoch</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>                    <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>                    <span class="n">loss_metrics</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">loss_metrics</span> <span class="k">else</span> <span class="p">[],</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>                <span class="p">)</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>                    <span class="s2">&quot;Invalid format for result: Expected None, tuple, list of tuples,&quot;</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>                    <span class="s2">&quot; or list of lists of tuples.&quot;</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>                <span class="p">)</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">last_epoch</span><span class="p">:</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>            <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{}</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>            <span class="c1"># Compute the average loss over the batches</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>            <span class="n">loss_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">loss_batch</span> <span class="k">for</span> <span class="n">loss_batch</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">last_epoch</span><span class="p">])</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>            <span class="n">avg_loss</span> <span class="o">=</span> <span class="n">loss_tensor</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>            <span class="c1"># Collect and average metrics for all batches</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>            <span class="n">metric_keys</span> <span class="o">=</span> <span class="n">last_epoch</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>            <span class="n">metrics_stacked</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">metric_keys</span><span class="p">}</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">metrics_batch</span> <span class="ow">in</span> <span class="n">last_epoch</span><span class="p">:</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">metric_keys</span><span class="p">:</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>                    <span class="n">value</span> <span class="o">=</span> <span class="n">metrics_batch</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>                    <span class="n">metrics_stacked</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>            <span class="n">avg_metrics</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">metrics_stacked</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">metric_keys</span><span class="p">}</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>            <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">avg_loss</span><span class="p">,</span> <span class="n">avg_metrics</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>    <span class="c1"># Store the optimization result</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">opt_result</span> <span class="o">=</span> <span class="n">OptimizeResult</span><span class="p">(</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current_epoch</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_old</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer_old</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">train_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Fits the model using the specified training configuration.</p>
<p>The dataloaders can be provided to train on new datasets, or the default dataloaders
provided in the trainer will be used.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>train_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>val_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.nn.Module" optional hover>Module</autoref>, <autoref identifier="torch.optim.Optimizer" optional hover>Optimizer</autoref>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[nn.Module, optim.Optimizer]: The trained model and optimizer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="n">train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="n">val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">]:</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    Fits the model using the specified training configuration.</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    The dataloaders can be provided to train on new datasets, or the default dataloaders</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    provided in the trainer will be used.</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        train_dataloader (DataLoader | DictDataLoader |  None): DataLoader for training data.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        val_dataloader (DataLoader | DictDataLoader |  None): DataLoader for validation data.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        tuple[nn.Module, optim.Optimizer]: The trained model and optimizer.</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="k">if</span> <span class="n">train_dataloader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader</span> <span class="o">=</span> <span class="n">train_dataloader</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="k">if</span> <span class="n">val_dataloader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">val_dataloader</span> <span class="o">=</span> <span class="n">val_dataloader</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_fit_setup</span><span class="p">()</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_train</span><span class="p">()</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_fit_end</span><span class="p">()</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">training_stage</span> <span class="o">=</span> <span class="n">TrainingStage</span><span class="p">(</span><span class="s2">&quot;idle&quot;</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.run_test_batch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_test_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Runs a single test batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>batch</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch of data from the DataLoader.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, ...]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="dict" optional>dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[torch.Tensor, dict[str, Any]]: Loss and metrics for the batch.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="nd">@BaseTrainer</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s2">&quot;test_batch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_test_batch</span><span class="p">(</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">    Runs a single test batch.</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">        batch (tuple[torch.Tensor, ...]): Batch of data from the DataLoader.</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">        tuple[torch.Tensor, dict[str, Any]]: Loss and metrics for the batch.</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="n">loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modify_batch_end_loss_metrics</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.run_train_batch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_train_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Runs a single training batch, performing optimization.</p>
<p>We use the step function to optimize the model based on use_grad.
    use_grad = True entails gradient based optimization, for which we use
    optimize_step function.
    use_grad = False entails gradient free optimization, for which we use
    update_ng_parameters function.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>batch</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch of data from the DataLoader.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, ...]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="dict" optional>dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[torch.Tensor, dict[str, Any]]: Loss and metrics for the batch.
tuple of (loss, metrics)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="nd">@BaseTrainer</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s2">&quot;train_batch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_train_batch</span><span class="p">(</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">    Runs a single training batch, performing optimization.</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">    We use the step function to optimize the model based on use_grad.</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        use_grad = True entails gradient based optimization, for which we use</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">        optimize_step function.</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">        use_grad = False entails gradient free optimization, for which we use</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">        update_ng_parameters function.</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        batch (tuple[torch.Tensor, ...]): Batch of data from the DataLoader.</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">        tuple[torch.Tensor, dict[str, Any]]: Loss and metrics for the batch.</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">            tuple of (loss, metrics)</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span><span class="p">:</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="c1"># Perform gradient-based optimization</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="n">loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimize_step</span><span class="p">(</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>            <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>            <span class="n">optimizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>            <span class="n">loss_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">,</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>            <span class="n">xs</span><span class="o">=</span><span class="n">batch</span><span class="p">,</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>            <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>            <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_dtype</span><span class="p">,</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="c1"># Perform optimization using Nevergrad</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">ng_params</span> <span class="o">=</span> <span class="n">update_ng_parameters</span><span class="p">(</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>            <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>            <span class="n">optimizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="n">loss_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">,</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="n">data</span><span class="o">=</span><span class="n">batch</span><span class="p">,</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="n">ng_params</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ng_params</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="p">)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ng_params</span> <span class="o">=</span> <span class="n">ng_params</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="n">loss_metrics</span> <span class="o">=</span> <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modify_batch_end_loss_metrics</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.run_training" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_training</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Runs the training for a single epoch, iterating over multiple batches.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><autoref identifier="list" optional>list</autoref>[<autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="dict" optional>dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>list[tuple[torch.Tensor, dict[str, Any]]]: Loss and metrics for each batch.
list                  -&gt; tuples
Training Batches      -&gt; (loss, metrics)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="nd">@BaseTrainer</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s2">&quot;train_epoch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_training</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">    Runs the training for a single epoch, iterating over multiple batches.</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">        dataloader (DataLoader): DataLoader for training data.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">        list[tuple[torch.Tensor, dict[str, Any]]]: Loss and metrics for each batch.</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">            list                  -&gt; tuples</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">            Training Batches      -&gt; (loss, metrics)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="n">train_epoch_loss_metrics</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="c1"># Quick Fix for iteration 0</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_reset_model_and_opt</span><span class="p">()</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch_iter</span><span class="p">(</span><span class="n">dataloader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_training_batches</span><span class="p">):</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_train_batch_start</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="n">train_batch_loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_train_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="n">train_epoch_loss_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_batch_loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_train_batch_end</span><span class="p">(</span><span class="n">train_batch_loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="k">return</span> <span class="n">train_epoch_loss_metrics</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.run_val_batch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_val_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Runs a single validation batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>batch</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Batch of data from the DataLoader.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, ...]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="dict" optional>dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[torch.Tensor, dict[str, Any]]: Loss and metrics for the batch.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="nd">@BaseTrainer</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s2">&quot;val_batch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_val_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">    Runs a single validation batch.</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">        batch (tuple[torch.Tensor, ...]): Batch of data from the DataLoader.</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">        tuple[torch.Tensor, dict[str, Any]]: Loss and metrics for the batch.</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>        <span class="n">loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modify_batch_end_loss_metrics</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.run_validation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_validation</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Runs the validation loop for a single epoch, iterating over multiple batches.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><autoref identifier="list" optional>list</autoref>[<autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="dict" optional>dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>list[tuple[torch.Tensor, dict[str, Any]]]: Loss and metrics for each batch.
list                  -&gt; tuples
Validation Batches      -&gt; (loss, metrics)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="nd">@BaseTrainer</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="s2">&quot;val_epoch&quot;</span><span class="p">)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">    Runs the validation loop for a single epoch, iterating over multiple batches.</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">        dataloader (DataLoader): DataLoader for validation data.</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        list[tuple[torch.Tensor, dict[str, Any]]]: Loss and metrics for each batch.</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">            list                  -&gt; tuples</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">            Validation Batches      -&gt; (loss, metrics)</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="n">val_epoch_loss_metrics</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch_iter</span><span class="p">(</span><span class="n">dataloader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_validation_batches</span><span class="p">):</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_val_batch_start</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="n">val_batch_loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_val_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="n">val_epoch_loss_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val_batch_loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_val_batch_end</span><span class="p">(</span><span class="n">val_batch_loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>    <span class="k">return</span> <span class="n">val_epoch_loss_metrics</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.trainer.Trainer.test" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">test</span><span class="p">(</span><span class="n">test_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Runs the testing loop if a test DataLoader is provided.</p>
<p>if the test_dataloader is not provided, default test_dataloader defined
in the Trainer class is used.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>test_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for test data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><autoref identifier="list" optional>list</autoref>[<autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="dict" optional>dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>list[tuple[torch.Tensor, dict[str, Any]]]: Loss and metrics for each batch.
list                    -&gt; tuples
Test Batches            -&gt; (loss, metrics)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="k">def</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">    Runs the testing loop if a test DataLoader is provided.</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">    if the test_dataloader is not provided, default test_dataloader defined</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">    in the Trainer class is used.</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">        test_dataloader (DataLoader): DataLoader for test data.</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        list[tuple[torch.Tensor, dict[str, Any]]]: Loss and metrics for each batch.</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">            list                    -&gt; tuples</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">            Test Batches            -&gt; (loss, metrics)</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>    <span class="k">if</span> <span class="n">test_dataloader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">test_dataloader</span> <span class="o">=</span> <span class="n">test_dataloader</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>    <span class="n">test_loss_metrics</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_batch_iter</span><span class="p">(</span><span class="n">test_dataloader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_training_batches</span><span class="p">):</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_test_batch_start</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="n">loss_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_test_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>        <span class="n">test_loss_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">on_test_batch_end</span><span class="p">(</span><span class="n">loss_metrics</span><span class="p">)</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="k">return</span> <span class="n">test_loss_metrics</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.config.AnsatzConfig" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">AnsatzConfig</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ansatz_type</span><span class="o">=</span><span class="n">AnsatzType</span><span class="o">.</span><span class="n">HEA</span><span class="p">,</span> <span class="n">ansatz_strategy</span><span class="o">=</span><span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span><span class="p">,</span> <span class="n">strategy_args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="n">param_prefix</span><span class="o">=</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">





  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.AnsatzConfig.ansatz_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ansatz_strategy</span><span class="p">:</span> <span class="n">Strategy</span> <span class="o">=</span> <span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Ansatz strategy.</p>
<p><code>Strategy.DIGITAL</code> for fully digital ansatz. Required if <code>ansatz_type</code> is <code>AnsatzType.IIA</code>.
<code>Strategy.SDAQC</code> for analog entangling block.
<code>Strategy.RYDBERG</code> for fully rydberg hea ansatz.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.AnsatzConfig.ansatz_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ansatz_type</span><span class="p">:</span> <span class="n">AnsatzType</span> <span class="o">=</span> <span class="n">AnsatzType</span><span class="o">.</span><span class="n">HEA</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>What type of ansatz.</p>
<p><code>AnsatzType.HEA</code> for Hardware Efficient Ansatz.
<code>AnsatzType.IIA</code> for Identity intialized Ansatz.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.AnsatzConfig.depth" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Number of layers of the ansatz.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.AnsatzConfig.param_prefix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">param_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;theta&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>The base bame of the variational parameter.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.AnsatzConfig.strategy_args" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">strategy_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>A dictionary containing keyword arguments to the function creating the ansatz.</p>
<p>Details about each below.</p>
<p>For <code>Strategy.DIGITAL</code> strategy, accepts the following:
    periodic (bool): if the qubits should be linked periodically.
        periodic=False is not supported in emu-c.
    operations (list): list of operations to cycle through in the
        digital single-qubit rotations of each layer.
        Defaults to  [RX, RY, RX] for hea and [RX, RY] for iia.
    entangler (AbstractBlock): 2-qubit entangling operation.
        Supports CNOT, CZ, CRX, CRY, CRZ, CPHASE. Controlld rotations
        will have variational parameters on the rotation angles.
        Defaults to CNOT</p>
<p>For <code>Strategy.SDAQC</code> strategy, accepts the following:
    operations (list): list of operations to cycle through in the
        digital single-qubit rotations of each layer.
        Defaults to  [RX, RY, RX] for hea and [RX, RY] for iia.
    entangler (AbstractBlock): Hamiltonian generator for the
        analog entangling layer. Time parameter is considered variational.
        Defaults to NN interaction.</p>
<p>For <code>Strategy.RYDBERG</code> strategy, accepts the following:
    addressable_detuning: whether to turn on the trainable semi-local addressing pattern
        on the detuning (n_i terms in the Hamiltonian).
        Defaults to True.
    addressable_drive: whether to turn on the trainable semi-local addressing pattern
        on the drive (sigma_i^x terms in the Hamiltonian).
        Defaults to False.
    tunable_phase: whether to have a tunable phase to get both sigma^x and sigma^y rotations
        in the drive term. If False, only a sigma^x term will be included in the drive part
        of the Hamiltonian generator.
        Defaults to False.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.AnsatzConfig.tag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tag</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>String to indicate the name tag of the ansatz.</p>
<p>Defaults to None, in which case no tag will be applied.</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.config.FeatureMapConfig" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">FeatureMapConfig</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">basis_set</span><span class="o">=</span><span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span><span class="p">,</span> <span class="n">reupload_scaling</span><span class="o">=</span><span class="n">ReuploadScaling</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">,</span> <span class="n">feature_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">multivariate_strategy</span><span class="o">=</span><span class="n">MultivariateStrategy</span><span class="o">.</span><span class="n">PARALLEL</span><span class="p">,</span> <span class="n">feature_map_strategy</span><span class="o">=</span><span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span><span class="p">,</span> <span class="n">param_prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_repeats</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">





  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.basis_set" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">basis_set</span><span class="p">:</span> <span class="n">BasisSet</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BasisSet</span><span class="p">]</span> <span class="o">=</span> <span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Basis set for feature encoding.</p>
<p>Takes qadence.BasisSet.
Give a single BasisSet to use the same for all features.
Give a dict of (str, BasisSet) where the key is the name of the variable and the
value is the BasisSet to use for encoding that feature.
BasisSet.FOURIER for Fourier encoding.
BasisSet.CHEBYSHEV for Chebyshev encoding.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.feature_map_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_map_strategy</span><span class="p">:</span> <span class="n">Strategy</span> <span class="o">=</span> <span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Strategy for feature map.</p>
<p>Accepts DIGITAL, ANALOG or RYDBERG. Defaults to DIGITAL.
If the strategy is incompatible with the <code>operation</code> chosen, then <code>operation</code>
gets preference and the given strategy is ignored.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.feature_range" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">feature_range</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Range of data that the input data is assumed to come from.</p>
<p>Give a single tuple to use the same range for all features.
Give a dict of (str, tuple) where the key is the name of the variable and the
value is the feature range to use for that feature.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.inputs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">inputs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Basic</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>List that indicates the order of variables of the tensors that are passed.</p>
<p>Optional if a single feature is being encoded, required otherwise. Given input tensors
<code>xs = torch.rand(batch_size, input_size:=2)</code> a QNN with <code>inputs=["t", "x"]</code> will
assign <code>t, x = xs[:,0], xs[:,1]</code>.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.multivariate_strategy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">multivariate_strategy</span><span class="p">:</span> <span class="n">MultivariateStrategy</span> <span class="o">=</span> <span class="n">MultivariateStrategy</span><span class="o">.</span><span class="n">PARALLEL</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>The encoding strategy in case of multi-variate function.</p>
<p>Takes qadence.MultivariateStrategy.
If PARALLEL, the features are encoded in one block of rotation gates
with the register being split in sub-registers for each feature.
If SERIES, the features are encoded sequentially using the full register for each feature, with
an ansatz block between them. PARALLEL is allowed only for DIGITAL <code>feature_map_strategy</code>.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.num_features" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_features</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Number of feature parameters to be encoded.</p>
<p>Defaults to 0. Thus, no feature parameters are encoded.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.num_repeats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_repeats</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Number of feature map layers repeated in the data reuploading step.</p>
<p>If all features are to be repeated the same number of times, then can give a single
<code>int</code>. For different number of repetitions for each feature, provide a dict
of (str, int) where the key is the name of the variable and the value is the
number of repetitions for that feature.
This amounts to the number of additional reuploads. So if <code>num_repeats</code> is N,
the data gets uploaded N+1 times. Defaults to no repetition.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.operation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">operation</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Parameter</span> <span class="o">|</span> <span class="n">Basic</span><span class="p">],</span> <span class="n">AnalogBlock</span><span class="p">]</span> <span class="o">|</span> <span class="n">Type</span><span class="p">[</span><span class="n">RX</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Type of operation.</p>
<p>Choose among the analog or digital rotations or a custom
callable function returning an AnalogBlock instance. If the type of operation is
incompatible with the <code>strategy</code> chosen, then <code>operation</code> gets preference and
the given strategy is ignored.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.param_prefix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">param_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>String prefix to create trainable parameters in Feature Map.</p>
<p>A string prefix to create trainable parameters multiplying the feature parameter
inside the feature-encoding function. Note that currently this does not take into
account the domain of the feature-encoding function.
Defaults to <code>None</code> and thus, the feature map is not trainable.
Note that this is separate from the name of the parameter.
The user can provide a single prefix for all features, and it will be appended
by appropriate feature name automatically.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.reupload_scaling" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reupload_scaling</span><span class="p">:</span> <span class="n">ReuploadScaling</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ReuploadScaling</span><span class="p">]</span> <span class="o">=</span> <span class="n">ReuploadScaling</span><span class="o">.</span><span class="n">CONSTANT</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Scaling for encoding the same feature on different qubits.</p>
<p>Scaling used to encode the same feature on different qubits in the
same layer of the feature maps. Takes qadence.ReuploadScaling.
Give a single ReuploadScaling to use the same for all features.
Give a dict of (str, ReuploadScaling) where the key is the name of the variable and the
value is the ReuploadScaling to use for encoding that feature.
ReuploadScaling.CONSTANT for constant scaling.
ReuploadScaling.TOWER for linearly increasing scaling.
ReuploadScaling.EXP for exponentially increasing scaling.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.tag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tag</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>String to indicate the name tag of the feature map.</p>
<p>Defaults to None, in which case no tag will be applied.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.FeatureMapConfig.target_range" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">target_range</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Range of data the data encoder assumes as natural range.</p>
<p>Give a single tuple to use the same range for all features.
Give a dict of (str, tuple) where the key is the name of the variable and the
value is the target range to use for that feature.</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.config.TrainConfig" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">TrainConfig</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">print_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">write_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">checkpoint_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">plot_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">list</span><span class="p">()(),</span> <span class="n">log_model</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">root_folder</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./qml_logs&#39;</span><span class="p">),</span> <span class="n">create_subfolder_per_run</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_folder</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">),</span> <span class="n">checkpoint_best_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">val_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">val_epsilon</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">validation_criterion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trainstop_criterion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tracking_tool</span><span class="o">=</span><span class="n">ExperimentTrackingTool</span><span class="o">.</span><span class="n">TENSORBOARD</span><span class="p">,</span> <span class="n">hyperparams</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="n">plotting_functions</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(),</span> <span class="n">_subfolders</span><span class="o">=</span><span class="nb">list</span><span class="p">())</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


      <p>Default configuration for the training process.</p>
<p>This class provides default settings for various aspects of the training loop,
such as logging, checkpointing, and validation. The default values for these
fields can be customized when an instance of <code>TrainConfig</code> is created.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">c</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span><span class="n">root_folder</span><span class="o">=</span><span class="s2">&quot;/tmp/train&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="err">Trai</span><span class="kc">n</span><span class="err">Co</span><span class="kc">nf</span><span class="err">ig(max_i</span><span class="kc">ter</span><span class="err">=</span><span class="mi">10000</span><span class="p">,</span><span class="w"> </span><span class="err">pri</span><span class="kc">nt</span><span class="err">_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">wri</span><span class="kc">te</span><span class="err">_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">checkpoi</span><span class="kc">nt</span><span class="err">_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">plo</span><span class="kc">t</span><span class="err">_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">callbacks=</span><span class="p">[],</span><span class="w"> </span><span class="err">log_model=False</span><span class="p">,</span><span class="w"> </span><span class="err">roo</span><span class="kc">t</span><span class="err">_</span><span class="kc">f</span><span class="err">older=&#39;/</span><span class="kc">t</span><span class="err">mp/</span><span class="kc">tra</span><span class="err">i</span><span class="kc">n</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">crea</span><span class="kc">te</span><span class="err">_sub</span><span class="kc">f</span><span class="err">older_per_ru</span><span class="kc">n</span><span class="err">=False</span><span class="p">,</span><span class="w"> </span><span class="err">log_</span><span class="kc">f</span><span class="err">older=PosixPa</span><span class="kc">t</span><span class="err">h(&#39;.&#39;)</span><span class="p">,</span><span class="w"> </span><span class="err">checkpoi</span><span class="kc">nt</span><span class="err">_bes</span><span class="kc">t</span><span class="err">_o</span><span class="kc">nl</span><span class="err">y=False</span><span class="p">,</span><span class="w"> </span><span class="err">val_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">val_epsilo</span><span class="kc">n</span><span class="err">=</span><span class="mf">1e-05</span><span class="p">,</span><span class="w"> </span><span class="err">valida</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">_cri</span><span class="kc">ter</span><span class="err">io</span><span class="kc">n</span><span class="err">=No</span><span class="kc">ne</span><span class="p">,</span><span class="w"> </span><span class="kc">tra</span><span class="err">i</span><span class="kc">nst</span><span class="err">op_cri</span><span class="kc">ter</span><span class="err">io</span><span class="kc">n</span><span class="err">=No</span><span class="kc">ne</span><span class="p">,</span><span class="w"> </span><span class="err">ba</span><span class="kc">t</span><span class="err">ch_size=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">verbose=True</span><span class="p">,</span><span class="w"> </span><span class="kc">tra</span><span class="err">cki</span><span class="kc">n</span><span class="err">g_</span><span class="kc">t</span><span class="err">ool=&lt;Experime</span><span class="kc">nt</span><span class="err">Tracki</span><span class="kc">n</span><span class="err">gTool.TENSORBOARD</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="kc">tens</span><span class="err">orboard&#39;&gt;</span><span class="p">,</span><span class="w"> </span><span class="err">hyperparams=</span><span class="p">{},</span><span class="w"> </span><span class="err">plo</span><span class="kc">tt</span><span class="err">i</span><span class="kc">n</span><span class="err">g_</span><span class="kc">fun</span><span class="err">c</span><span class="kc">t</span><span class="err">io</span><span class="kc">ns</span><span class="err">=()</span><span class="p">,</span><span class="w"> </span><span class="err">_sub</span><span class="kc">f</span><span class="err">olders=</span><span class="p">[]</span><span class="err">)</span>
</code></pre></div>

</div></p>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.batch_size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>The batch size to use when processing a list or tuple of torch.Tensors.</p>
<p>This specifies how many samples are processed in each training iteration.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.callbacks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">callbacks</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">list</span><span class="p">())</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>List of callbacks to execute during training.</p>
<p>Callbacks can be used for
custom behaviors, such as early stopping, custom logging, or other actions
triggered at specific events.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.checkpoint_best_only" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">checkpoint_best_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>If <code>True</code>, checkpoints are only saved if there is an improvement in the.</p>
<p>validation metric. This conserves storage by only keeping the best models.</p>
<p>validation_criterion is required when this is set to True.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.checkpoint_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">checkpoint_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Frequency (in epochs) for saving model and optimizer checkpoints during training.</p>
<p>Set to 0 to disable checkpointing. This helps in resuming training or recovering
models.
Note that setting checkpoint_best_only = True will disable this and only best checkpoints will
be saved.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.create_subfolder_per_run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_subfolder_per_run</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Whether to create a subfolder for each run, named <code>&lt;id&gt;_&lt;timestamp&gt;_&lt;PID&gt;</code>.</p>
<p>This ensures logs and checkpoints from different runs do not overwrite each other,
which is helpful for rapid prototyping. If <code>False</code>, training will resume from
the latest checkpoint if one exists in the specified log folder.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.hyperparams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hyperparams</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>A dictionary of hyperparameters to be tracked.</p>
<p>This can include learning rates,
regularization parameters, or any other training-related configurations.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.log_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_folder</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>The log folder for saving checkpoints and tensorboard logs.</p>
<p>This stores the path where all logs and checkpoints are being saved
for this training session. <code>log_folder</code> takes precedence over <code>root_folder</code> and
<code>create_subfolder_per_run</code> arguments. If the user specifies a log_folder,
all checkpoints will be saved in this folder and <code>root_folder</code> argument
will not be used.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.log_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_model</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Whether to log a serialized version of the model.</p>
<p>When set to <code>True</code>, the
model's state will be logged, useful for model versioning and reproducibility.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.max_iter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Number of training iterations (epochs) to perform.</p>
<p>This defines the total number
of times the model will be updated.</p>
<p>In case of InfiniteTensorDataset, each epoch will have 1 batch.
In case of TensorDataset, each epoch will have len(dataloader) batches.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.plot_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Frequency (in epochs) for generating and saving figures during training.</p>
<p>Set to 0 to disable plotting.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.plotting_functions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plotting_functions</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">LoggablePlotFunction</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">tuple</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Functions used for in-training plotting.</p>
<p>These are called to generate
plots that are logged or saved at specified intervals.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.print_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Frequency (in epochs) for printing loss and metrics to the console during training.</p>
<p>Set to 0 to disable this output, meaning that metrics and loss will not be printed
during training.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.root_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">root_folder</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./qml_logs&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>The root folder for saving checkpoints and tensorboard logs.</p>
<p>The default path is "./qml_logs"</p>
<p>This can be set to a specific directory where training artifacts are to be stored.
Checkpoints will be saved inside a subfolder in this directory. Subfolders will be
created based on <code>create_subfolder_per_run</code> argument.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.tracking_tool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tracking_tool</span><span class="p">:</span> <span class="n">ExperimentTrackingTool</span> <span class="o">=</span> <span class="n">ExperimentTrackingTool</span><span class="o">.</span><span class="n">TENSORBOARD</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>The tool used for tracking training progress and logging metrics.</p>
<p>Options include tools like TensorBoard, which help visualize and monitor
model training.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.trainstop_criterion" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trainstop_criterion</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>A function to determine if the training process should stop based on a.</p>
<p>specific stopping metric. If <code>None</code>, training continues until <code>max_iter</code> is reached.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.val_epsilon" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">val_epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-05</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>A small safety margin used to compare the current validation loss with the.</p>
<p>best previous validation loss. This is used to determine improvements in metrics.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.val_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">val_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Frequency (in epochs) for performing validation.</p>
<p>If set to 0, validation is not performed.
Note that metrics from validation are always written, regardless of the <code>write_every</code> setting.
Note that initial validation happens at the start of training (when val_every &gt; 0)
    For initial validation  - initial metrics are written.
                            - checkpoint is saved (when checkpoint_best_only = False)</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.validation_criterion" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validation_criterion</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>A function to evaluate whether a given validation metric meets a desired condition.</p>
<p>The validation_criterion has the following format:
def validation_criterion(val_loss: float, best_val_loss: float, val_epsilon: float) -&gt; bool:
    # process</p>
<p>If <code>None</code>, no custom validation criterion is applied.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.verbose" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Whether to print metrics and status messages during training.</p>
<p>If <code>True</code>, detailed metrics and status updates will be displayed in the console.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.config.TrainConfig.write_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Frequency (in epochs) for writing loss and metrics using the tracking tool during training.</p>
<p>Set to 0 to disable this logging, which prevents metrics from being logged to the tracking tool.
Note that the metrics will always be written at the end of training regardless of this setting.</p>
    </div>

</div>





  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.parameters.get_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Retrieve all trainable model parameters in a single vector.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>the input PyTorch model</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Tensor</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>a 1-dimensional tensor with the parameters</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.Tensor" optional hover>Tensor</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/parameters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve all trainable model parameters in a single vector.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        model (Module): the input PyTorch model</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        Tensor: a 1-dimensional tensor with the parameters</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">]</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.parameters.num_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Return the total number of parameters of the given model.</p>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/parameters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="k">def</span><span class="w"> </span><span class="nf">num_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the total number of parameters of the given model.&quot;&quot;&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.parameters.set_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Set all trainable parameters of a model from a single vector.</p>
<p>Notice that this function assumes prior knowledge of right number
of parameters in the model</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>the input PyTorch model</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>theta</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>the parameters to assign</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.Tensor" optional hover>Tensor</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/parameters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set all trainable parameters of a model from a single vector.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Notice that this function assumes prior knowledge of right number</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    of parameters in the model</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        model (Module): the input PyTorch model</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        theta (Tensor): the parameters to assign</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="k">for</span> <span class="n">ps</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>            <span class="k">if</span> <span class="n">ps</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>                <span class="n">n</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">numel</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>                <span class="k">if</span> <span class="n">ps</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>                    <span class="n">ps</span><span class="p">[()]</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">idx</span> <span class="p">:</span> <span class="n">idx</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>                    <span class="n">ps</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">idx</span> <span class="p">:</span> <span class="n">idx</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ps</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>                <span class="n">idx</span> <span class="o">+=</span> <span class="n">n</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.optimize_step.optimize_step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimize_step</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Default Torch optimize step with closure.</p>
<p>This is the default optimization step.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The input model to be optimized.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>optimizer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The chosen Torch optimizer.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.optim.Optimizer" optional hover>Optimizer</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>loss_fn</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A custom loss function
that returns the loss value and a dictionary of metrics.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Callable" optional hover>Callable</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>xs</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The input data. If None, it means
the given model does not require any input data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="dict" optional>dict</autoref> | <autoref identifier="list" optional>list</autoref> | <autoref identifier="qadence.backend.Tensor" optional hover>Tensor</autoref> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>device</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A target device to run computations on.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.device" optional hover>device</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dtype</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Data type for <code>xs</code> conversion.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.dtype" optional hover>dtype</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref> | <autoref identifier="float" optional>float</autoref>, <autoref identifier="dict" optional>dict</autoref> | None]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[Tensor | float, dict | None]: A tuple containing the computed loss value
and a dictionary with collected metrics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/optimize_step.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">optimize_step</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">optimizer</span><span class="p">:</span> <span class="n">Optimizer</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">loss_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">xs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Default Torch optimize step with closure.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    This is the default optimization step.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        model (Module): The input model to be optimized.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        optimizer (Optimizer): The chosen Torch optimizer.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        loss_fn (Callable): A custom loss function</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">            that returns the loss value and a dictionary of metrics.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        xs (dict | list | Tensor | None): The input data. If None, it means</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">            the given model does not require any input data.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        device (torch.device): A target device to run computations on.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        dtype (torch.dtype): Data type for `xs` conversion.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        tuple[Tensor | float, dict | None]: A tuple containing the computed loss value</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            and a dictionary with collected metrics.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{}</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">xs_to_device</span> <span class="o">=</span> <span class="n">data_to_device</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">closure</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="c1"># NOTE: We need the nonlocal as we can&#39;t return a metric dict and</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="c1"># because e.g. LBFGS calls this closure multiple times but for some</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="c1"># reason the returned loss is always the first one...</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="k">nonlocal</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">loss</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xs_to_device</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">retain_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="k">return</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">closure</span><span class="p">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="c1"># return the loss/metrics that are being mutated inside the closure...</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.optimize_step.update_ng_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_ng_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ng_params</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Update the model parameters using Nevergrad.</p>
<p>This function integrates Nevergrad for derivative-free optimization.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The PyTorch model to be optimized.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>optimizer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A Nevergrad optimizer instance.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="nevergrad.optimizers.Optimizer" optional hover>Optimizer</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>loss_fn</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A custom loss function
that returns the loss value and a dictionary of metrics.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Callable" optional hover>Callable</autoref>[[<autoref identifier="torch.nn.Module" optional hover>Module</autoref>, <autoref identifier="qadence.backend.Tensor" optional hover>Tensor</autoref> | None], <autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="float" optional>float</autoref>, <autoref identifier="dict" optional>dict</autoref>]]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>data</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Input data for the model. If None, it means the model does
not require input data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.backend.Tensor" optional hover>Tensor</autoref> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>ng_params</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current set of parameters managed by Nevergrad.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="nevergrad.p.Array" optional hover>Array</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="float" optional>float</autoref>, <autoref identifier="dict" optional>dict</autoref>, <autoref identifier="nevergrad.p.Array" optional hover>Array</autoref>]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[float, dict, ng.p.Array]: A tuple containing the computed loss value,
a dictionary of metrics, and the updated Nevergrad parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/optimize_step.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="k">def</span><span class="w"> </span><span class="nf">update_ng_parameters</span><span class="p">(</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">optimizer</span><span class="p">:</span> <span class="n">ng</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">loss_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Module</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]],</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">ng_params</span><span class="p">:</span> <span class="n">ng</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">ng</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Array</span><span class="p">]:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the model parameters using Nevergrad.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    This function integrates Nevergrad for derivative-free optimization.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        model (Module): The PyTorch model to be optimized.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        optimizer (ng.optimizers.Optimizer): A Nevergrad optimizer instance.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        loss_fn (Callable[[Module, Tensor | None], tuple[float, dict]]): A custom loss function</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            that returns the loss value and a dictionary of metrics.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        data (Tensor | None): Input data for the model. If None, it means the model does</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            not require input data.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        ng_params (ng.p.Array): The current set of parameters managed by Nevergrad.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        tuple[float, dict, ng.p.Array]: A tuple containing the computed loss value,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">            a dictionary of metrics, and the updated Nevergrad parameters.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">optimizer</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">ng_params</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">loss</span><span class="p">))</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">ng_params</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">ask</span><span class="p">()</span>  <span class="c1"># type: ignore[assignment]</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">params</span> <span class="o">=</span> <span class="n">promote_to_tensor</span><span class="p">(</span><span class="n">ng_params</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">set_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">ng_params</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.data.DictDataLoader" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">DictDataLoader</span><span class="p">(</span><span class="n">dataloaders</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


      <p>This class only holds a dictionary of <code>DataLoader</code>s and samples from them.</p>




  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.data.InfiniteTensorDataset" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">InfiniteTensorDataset</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="torch.utils.data.IterableDataset" optional hover>IterableDataset</autoref></code></p>


      <p>Randomly sample points from the first dimension of the given tensors.</p>
<p>Behaves like a normal torch <code>Dataset</code> just that we can sample from it as
many times as we want.</p>
<p>Examples:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">InfiniteTensorDataset</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># The dataset accepts any number of tensors with the same batch dimension</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">ds</span> <span class="o">=</span> <span class="n">InfiniteTensorDataset</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1"># call `next` to get one sample from each tensor:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">xs</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ds</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="err">(</span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.4300</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5015</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">1.</span><span class="p">]</span><span class="err">))</span>
</code></pre></div></p>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/data.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">tensors</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Randomly sample points from the first dimension of the given tensors.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    Behaves like a normal torch `Dataset` just that we can sample from it as</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    many times as we want.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    ```python exec=&quot;on&quot; source=&quot;above&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    from qadence.ml_tools.data import InfiniteTensorDataset</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    x_data, y_data = torch.rand(5,2), torch.ones(5,1)</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    # The dataset accepts any number of tensors with the same batch dimension</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    ds = InfiniteTensorDataset(x_data, y_data)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    # call `next` to get one sample from each tensor:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    xs = next(iter(ds))</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    print(str(xs)) # markdown-exec: hide</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    ```</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tensors</span> <span class="o">=</span> <span class="n">tensors</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tensors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.data.OptimizeResult" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">OptimizeResult</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">()(),</span> <span class="n">extra</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">()())</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


      <p>OptimizeResult stores many optimization intermediate values.</p>
<p>We store at a current iteration,
the model, optimizer, loss values, metrics. An extra dict
can be used for saving other information to be used for callbacks.</p>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.extra" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extra</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">())</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Extra dict for saving anything else to be used in callbacks.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.iteration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Current iteration number.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.loss" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">loss</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Loss value.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.metrics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">metrics</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">())</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Metrics that can be saved during training.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span><span class="p">:</span> <span class="n">Module</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Model at iteration.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.data.OptimizeResult.optimizer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimizer</span><span class="p">:</span> <span class="n">Optimizer</span> <span class="o">|</span> <span class="n">NGOptimizer</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Optimizer at iteration.</p>
    </div>

</div>





  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.data.data_to_device" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">data_to_device</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Utility method to move arbitrary data to 'device'.</p>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="nd">@singledispatch</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="k">def</span><span class="w"> </span><span class="nf">data_to_device</span><span class="p">(</span><span class="n">xs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Utility method to move arbitrary data to &#39;device&#39;.&quot;&quot;&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unable to move </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="si">}</span><span class="s2"> with input args: </span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2"> and kwargs: </span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.data.to_dataloader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dataloader</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">infinite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Convert torch tensors an (infinite) Dataloader.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>*tensors</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Torch tensors to use in the dataloader.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.Tensor" optional hover>Tensor</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>()</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>batch_size</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>batch size of sampled tensors</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>infinite</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>if <code>True</code>, the dataloader will keep sampling indefinitely even after the whole
dataset was sampled once</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="bool" optional>bool</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>
      <p>Examples:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_dataloader</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">loader</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">to_dataloader</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">infinite</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">loader</span><span class="p">))</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">loader</span><span class="p">))</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">loader</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">[</span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.8244</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2922</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3246</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6345</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7915</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.4082</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7652</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1494</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6814</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9754</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.8941</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6468</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8306</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5045</span><span class="p">]</span><span class="err">)</span><span class="p">]</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="p">[</span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.8815</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2183</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1525</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8522</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3831</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.2366</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4871</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4839</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8105</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1986</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.1423</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6649</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1249</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9310</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9246</span><span class="p">]</span><span class="err">)</span><span class="p">]</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="p">[</span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.8244</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2922</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3246</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6345</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7915</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.4082</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7652</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1494</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6814</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9754</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.8941</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1731</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6468</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8306</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5045</span><span class="p">]</span><span class="err">)</span><span class="p">]</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_dataloader</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">infinite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert torch tensors an (infinite) Dataloader.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        *tensors: Torch tensors to use in the dataloader.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        batch_size: batch size of sampled tensors</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        infinite: if `True`, the dataloader will keep sampling indefinitely even after the whole</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            dataset was sampled once</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    ```python exec=&quot;on&quot; source=&quot;above&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    from qadence.ml_tools import to_dataloader</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    (x, y, z) = [torch.rand(10) for _ in range(3)]</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    loader = iter(to_dataloader(x, y, z, batch_size=5, infinite=True))</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    print(next(loader))</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    print(next(loader))</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">    print(next(loader))</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    ```</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">ds</span> <span class="o">=</span> <span class="n">InfiniteTensorDataset</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">)</span> <span class="k">if</span> <span class="n">infinite</span> <span class="k">else</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="k">return</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.models.QNN" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">QNN</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">observable</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">BackendName</span><span class="o">.</span><span class="n">PYQTORCH</span><span class="p">,</span> <span class="n">diff_mode</span><span class="o">=</span><span class="n">DiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">,</span> <span class="n">measurement</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">configuration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">input_diff_mode</span><span class="o">=</span><span class="n">InputDiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.model.QuantumModel" optional hover>QuantumModel</autoref></code></p>


      <p>Quantum neural network model for n-dimensional inputs.</p>
<p>Examples:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">QNN</span><span class="p">,</span> <span class="n">Z</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="n">hea</span><span class="p">,</span> <span class="n">feature_map</span><span class="p">,</span> <span class="n">hamiltonian_factory</span><span class="p">,</span> <span class="n">kron</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># create the circuit</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">n_qubits</span><span class="p">,</span> <span class="n">depth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">fm</span> <span class="o">=</span> <span class="n">kron</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">feature_map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">param</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">feature_map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">support</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">param</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">ansatz</span> <span class="o">=</span> <span class="n">hea</span><span class="p">(</span><span class="n">n_qubits</span><span class="o">=</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="n">depth</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">ansatz</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">obs_base</span> <span class="o">=</span> <span class="n">hamiltonian_factory</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">detuning</span><span class="o">=</span><span class="n">Z</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="c1"># the QNN will yield two outputs</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">obs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">obs_base</span><span class="p">,</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">obs_base</span><span class="p">]</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="c1"># initialize and use the model</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="n">qnn</span> <span class="o">=</span> <span class="n">QNN</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">])</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">y</span> <span class="o">=</span> <span class="n">qnn</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kc">tens</span><span class="err">or(</span><span class="p">[[</span><span class="mf">-0.4102</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.8204</span><span class="p">],</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="mf">0.0515</span><span class="p">,</span><span class="w">  </span><span class="mf">0.1030</span><span class="p">],</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="mf">0.0287</span><span class="p">,</span><span class="w">  </span><span class="mf">0.0573</span><span class="p">]],</span><span class="w"> </span><span class="err">grad_</span><span class="kc">fn</span><span class="err">=&lt;Ca</span><span class="kc">t</span><span class="err">Backward</span><span class="mi">0</span><span class="err">&gt;)</span>
</code></pre></div>

</div></p>

      <p>Initialize the QNN.</p>
<p>The number of inputs is determined by the feature parameters in the input
quantum circuit while the number of outputs is determined by how many
observables are provided as input</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>circuit</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The quantum circuit to use for the QNN.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.circuit.QuantumCircuit" optional hover>QuantumCircuit</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>observable</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The observable.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="list" optional>list</autoref>[<autoref identifier="qadence.blocks.abstract.AbstractBlock" optional hover>AbstractBlock</autoref>] | <autoref identifier="qadence.blocks.abstract.AbstractBlock" optional hover>AbstractBlock</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>backend</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The chosen quantum backend.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.types.BackendName" optional hover>BackendName</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><autoref identifier="qadence.types.BackendName.PYQTORCH" optional hover>PYQTORCH</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>diff_mode</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The differentiation engine to use. Choices 'gpsr' or 'ad'.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.types.DiffMode" optional hover>DiffMode</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><autoref identifier="qadence.types.DiffMode.AD" optional hover>AD</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>measurement</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>optional measurement protocol. If None,
use exact expectation value with a statevector simulator</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.measurements.Measurements" optional hover>Measurements</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>noise</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A noise model to use.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.noise.NoiseHandler" optional hover>NoiseHandler</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>configuration</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>optional configuration for the backend</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.backend.BackendConfiguration" optional hover>BackendConfiguration</autoref> | <autoref identifier="dict" optional>dict</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>inputs</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List that indicates the order of variables of the tensors that are passed
to the model. Given input tensors <code>xs = torch.rand(batch_size, input_size:=2)</code> a QNN
with <code>inputs=["t", "x"]</code> will assign <code>t, x = xs[:,0], xs[:,1]</code>.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="list" optional>list</autoref>[<autoref identifier="sympy.Basic" optional hover>Basic</autoref> | <autoref identifier="str" optional>str</autoref>] | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>input_diff_mode</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The differentiation mode for the input tensor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.types.InputDiffMode" optional hover>InputDiffMode</autoref> | <autoref identifier="str" optional>str</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><autoref identifier="qadence.types.InputDiffMode.AD" optional hover>AD</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/models.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="n">circuit</span><span class="p">:</span> <span class="n">QuantumCircuit</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">observable</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AbstractBlock</span><span class="p">]</span> <span class="o">|</span> <span class="n">AbstractBlock</span><span class="p">,</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="n">backend</span><span class="p">:</span> <span class="n">BackendName</span> <span class="o">=</span> <span class="n">BackendName</span><span class="o">.</span><span class="n">PYQTORCH</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">diff_mode</span><span class="p">:</span> <span class="n">DiffMode</span> <span class="o">=</span> <span class="n">DiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">measurement</span><span class="p">:</span> <span class="n">Measurements</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="n">noise</span><span class="p">:</span> <span class="n">NoiseHandler</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="n">configuration</span><span class="p">:</span> <span class="n">BackendConfiguration</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">inputs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">Basic</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">input_diff_mode</span><span class="p">:</span> <span class="n">InputDiffMode</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">InputDiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="p">):</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the QNN.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    The number of inputs is determined by the feature parameters in the input</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    quantum circuit while the number of outputs is determined by how many</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    observables are provided as input</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        circuit: The quantum circuit to use for the QNN.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        observable: The observable.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        backend: The chosen quantum backend.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        diff_mode: The differentiation engine to use. Choices &#39;gpsr&#39; or &#39;ad&#39;.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        measurement: optional measurement protocol. If None,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            use exact expectation value with a statevector simulator</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        noise: A noise model to use.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        configuration: optional configuration for the backend</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        inputs: List that indicates the order of variables of the tensors that are passed</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            to the model. Given input tensors `xs = torch.rand(batch_size, input_size:=2)` a QNN</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            with `inputs=[&quot;t&quot;, &quot;x&quot;]` will assign `t, x = xs[:,0], xs[:,1]`.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        input_diff_mode: The differentiation mode for the input tensor.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">circuit</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">observable</span><span class="o">=</span><span class="n">observable</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">diff_mode</span><span class="o">=</span><span class="n">diff_mode</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">measurement</span><span class="o">=</span><span class="n">measurement</span><span class="p">,</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">configuration</span><span class="o">=</span><span class="n">configuration</span><span class="p">,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You need to provide at least one observable in the QNN constructor&quot;</span><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">inputs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)):</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">]</span>  <span class="c1"># type: ignore[union-attr]</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="k">elif</span> <span class="p">(</span><span class="n">inputs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">]</span>  <span class="c1"># type: ignore[union-attr]</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            Your QNN has more than one input. Please provide a list of inputs in the order of</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            your tensor domain. For example, if you want to pass</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            `xs = torch.rand(batch_size, input_size:=3)` to you QNN, where</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            ```</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            t = x[:,0]</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            x = x[:,1]</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            y = x[:,2]</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">            ```</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">            you have to specify</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            ```</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">            QNN(circuit, observable, inputs=[&quot;t&quot;, &quot;x&quot;, &quot;y&quot;])</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">            ```</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            You can also pass a list of sympy symbols.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="p">)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">format_to_dict</span> <span class="o">=</span> <span class="n">format_to_dict_fn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">input_diff_mode</span> <span class="o">=</span> <span class="n">InputDiffMode</span><span class="p">(</span><span class="n">input_diff_mode</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_diff_mode</span> <span class="o">==</span> <span class="n">InputDiffMode</span><span class="o">.</span><span class="n">FD</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">qadence.backends.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">finitediff</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__derivative</span> <span class="o">=</span> <span class="n">finitediff</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_diff_mode</span> <span class="o">==</span> <span class="n">InputDiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__derivative</span> <span class="o">=</span> <span class="n">_torch_derivative</span>  <span class="c1"># type: ignore[assignment]</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unkown forward diff mode: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input_diff_mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.models.QNN.forward" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">measurement</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endianness</span><span class="o">=</span><span class="n">Endianness</span><span class="o">.</span><span class="n">BIG</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Forward pass of the model.</p>
<p>This returns the (differentiable) expectation value of the given observable
operator defined in the constructor. Differently from the base QuantumModel
class, the QNN accepts also a tensor as input for the forward pass. The
tensor is expected to have shape: <code>n_batches x in_features</code> where <code>n_batches</code>
is the number of data points and <code>in_features</code> is the dimensionality of the problem</p>
<p>The output of the forward pass is the expectation value of the input
observable(s). If a single observable is given, the output shape is
<code>n_batches</code> while if multiple observables are given the output shape
is instead <code>n_batches x n_observables</code></p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>values</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>the values of the feature parameters</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="dict" optional>dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="torch.Tensor" optional hover>Tensor</autoref>] | <autoref identifier="torch.Tensor" optional hover>Tensor</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>state</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Initial state.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.Tensor" optional hover>Tensor</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>measurement</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>optional measurement protocol. If None,
use exact expectation value with a statevector simulator</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.measurements.Measurements" optional hover>Measurements</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>noise</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A noise model to use.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.noise.NoiseHandler" optional hover>NoiseHandler</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>endianness</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Endianness of the resulting bit strings.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.types.Endianness" optional hover>Endianness</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><autoref identifier="qadence.types.Endianness.BIG" optional hover>BIG</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Tensor</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>a tensor with the expectation value of the observables passed
in the constructor of the model</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.Tensor" optional hover>Tensor</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]</span> <span class="o">|</span> <span class="n">Tensor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="n">state</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="n">measurement</span><span class="p">:</span> <span class="n">Measurements</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="n">noise</span><span class="p">:</span> <span class="n">NoiseHandler</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="n">endianness</span><span class="p">:</span> <span class="n">Endianness</span> <span class="o">=</span> <span class="n">Endianness</span><span class="o">.</span><span class="n">BIG</span><span class="p">,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Forward pass of the model.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">    This returns the (differentiable) expectation value of the given observable</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    operator defined in the constructor. Differently from the base QuantumModel</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">    class, the QNN accepts also a tensor as input for the forward pass. The</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">    tensor is expected to have shape: `n_batches x in_features` where `n_batches`</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    is the number of data points and `in_features` is the dimensionality of the problem</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    The output of the forward pass is the expectation value of the input</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">    observable(s). If a single observable is given, the output shape is</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">    `n_batches` while if multiple observables are given the output shape</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    is instead `n_batches x n_observables`</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        values: the values of the feature parameters</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        state: Initial state.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        measurement: optional measurement protocol. If None,</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">            use exact expectation value with a statevector simulator</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        noise: A noise model to use.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        endianness: Endianness of the resulting bit strings.</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        Tensor: a tensor with the expectation value of the observables passed</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">            in the constructor of the model</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expectation</span><span class="p">(</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="n">values</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">measurement</span><span class="o">=</span><span class="n">measurement</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span> <span class="n">endianness</span><span class="o">=</span><span class="n">endianness</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.models.QNN.from_configs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_configs</span><span class="p">(</span><span class="n">register</span><span class="p">,</span> <span class="n">obs_config</span><span class="p">,</span> <span class="n">fm_config</span><span class="o">=</span><span class="n">FeatureMapConfig</span><span class="p">(),</span> <span class="n">ansatz_config</span><span class="o">=</span><span class="n">AnsatzConfig</span><span class="p">(),</span> <span class="n">backend</span><span class="o">=</span><span class="n">BackendName</span><span class="o">.</span><span class="n">PYQTORCH</span><span class="p">,</span> <span class="n">diff_mode</span><span class="o">=</span><span class="n">DiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">,</span> <span class="n">measurement</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">configuration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">input_diff_mode</span><span class="o">=</span><span class="n">InputDiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Create a QNN from a set of configurations.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>register</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The number of qubits or a register object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref> | <autoref identifier="qadence.register.Register" optional hover>Register</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>obs_config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration(s)
for the observable(s).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="list" optional>list</autoref>[<autoref identifier="qadence.constructors.ObservableConfig" optional hover>ObservableConfig</autoref>] | <autoref identifier="qadence.constructors.ObservableConfig" optional hover>ObservableConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fm_config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration for the feature map.
Defaults to no feature encoding block.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.FeatureMapConfig" optional hover>FeatureMapConfig</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><autoref identifier="qadence.ml_tools.config.FeatureMapConfig" optional hover>FeatureMapConfig</autoref>()</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>ansatz_config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration for the ansatz.
Defaults to a single layer of hardware efficient ansatz.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.AnsatzConfig" optional hover>AnsatzConfig</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><autoref identifier="qadence.ml_tools.config.AnsatzConfig" optional hover>AnsatzConfig</autoref>()</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>backend</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The chosen quantum backend.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.types.BackendName" optional hover>BackendName</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><autoref identifier="qadence.types.BackendName.PYQTORCH" optional hover>PYQTORCH</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>diff_mode</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The differentiation engine to use. Choices are
'gpsr' or 'ad'.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.types.DiffMode" optional hover>DiffMode</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><autoref identifier="qadence.types.DiffMode.AD" optional hover>AD</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>measurement</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Optional measurement protocol. If None,
use exact expectation value with a statevector simulator.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.measurements.Measurements" optional hover>Measurements</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>noise</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A noise model to use.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="Noise" optional>Noise</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>configuration</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Optional backend configuration.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.backend.BackendConfiguration" optional hover>BackendConfiguration</autoref> | <autoref identifier="dict" optional>dict</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>input_diff_mode</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The differentiation mode for the input tensor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.types.InputDiffMode" optional hover>InputDiffMode</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><autoref identifier="qadence.types.InputDiffMode.AD" optional hover>AD</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><autoref identifier="qadence.ml_tools.models.QNN" optional hover>QNN</autoref></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A QNN object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><autoref identifier="ValueError" optional>ValueError</autoref></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If the observable configuration is not provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
      <p>Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">AnsatzConfig</span><span class="p">,</span> <span class="n">FeatureMapConfig</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">QNN</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.constructors</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObservableConfig</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.operations</span><span class="w"> </span><span class="kn">import</span> <span class="n">Z</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.types</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">AnsatzType</span><span class="p">,</span> <span class="n">BackendName</span><span class="p">,</span> <span class="n">BasisSet</span><span class="p">,</span> <span class="n">ObservableTransform</span><span class="p">,</span> <span class="n">ReuploadScaling</span><span class="p">,</span> <span class="n">Strategy</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">register</span> <span class="o">=</span> <span class="mi">4</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">obs_config</span> <span class="o">=</span> <span class="n">ObservableConfig</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">detuning</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">scale</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">shift</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">transformation_type</span><span class="o">=</span><span class="n">ObservableTransform</span><span class="o">.</span><span class="n">SCALE</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">trainable_transform</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="n">fm_config</span> <span class="o">=</span> <span class="n">FeatureMapConfig</span><span class="p">(</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="n">num_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">],</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="n">basis_set</span><span class="o">=</span><span class="n">BasisSet</span><span class="o">.</span><span class="n">FOURIER</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="n">reupload_scaling</span><span class="o">=</span><span class="n">ReuploadScaling</span><span class="o">.</span><span class="n">CONSTANT</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    <span class="n">feature_range</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="p">},</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="n">ansatz_config</span> <span class="o">=</span> <span class="n">AnsatzConfig</span><span class="p">(</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    <span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    <span class="n">ansatz_type</span><span class="o">=</span><span class="n">AnsatzType</span><span class="o">.</span><span class="n">HEA</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>    <span class="n">ansatz_strategy</span><span class="o">=</span><span class="n">Strategy</span><span class="o">.</span><span class="n">DIGITAL</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="p">)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="n">qnn</span> <span class="o">=</span> <span class="n">QNN</span><span class="o">.</span><span class="n">from_configs</span><span class="p">(</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>    <span class="n">register</span><span class="p">,</span> <span class="n">obs_config</span><span class="p">,</span> <span class="n">fm_config</span><span class="p">,</span> <span class="n">ansatz_config</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">BackendName</span><span class="o">.</span><span class="n">PYQTORCH</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="n">y</span> <span class="o">=</span> <span class="n">qnn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kc">tens</span><span class="err">or(</span><span class="p">[[</span><span class="mf">2.6101</span><span class="p">],</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">        </span><span class="p">[</span><span class="mf">4.7983</span><span class="p">]],</span><span class="w"> </span><span class="err">grad_</span><span class="kc">fn</span><span class="err">=&lt;Ca</span><span class="kc">t</span><span class="err">Backward</span><span class="mi">0</span><span class="err">&gt;)</span>
</code></pre></div>

</div></p>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_configs</span><span class="p">(</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="bp">cls</span><span class="p">,</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="n">register</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Register</span><span class="p">,</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="n">obs_config</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">fm_config</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">FeatureMapConfig</span><span class="p">(),</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">ansatz_config</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">AnsatzConfig</span><span class="p">(),</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">backend</span><span class="p">:</span> <span class="n">BackendName</span> <span class="o">=</span> <span class="n">BackendName</span><span class="o">.</span><span class="n">PYQTORCH</span><span class="p">,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="n">diff_mode</span><span class="p">:</span> <span class="n">DiffMode</span> <span class="o">=</span> <span class="n">DiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="n">measurement</span><span class="p">:</span> <span class="n">Measurements</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="n">noise</span><span class="p">:</span> <span class="n">NoiseHandler</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">configuration</span><span class="p">:</span> <span class="n">BackendConfiguration</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">input_diff_mode</span><span class="p">:</span> <span class="n">InputDiffMode</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">InputDiffMode</span><span class="o">.</span><span class="n">AD</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QNN</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a QNN from a set of configurations.</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        register (int | Register): The number of qubits or a register object.</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">        obs_config (list[ObservableConfig] | ObservableConfig): The configuration(s)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">            for the observable(s).</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        fm_config (FeatureMapConfig): The configuration for the feature map.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">            Defaults to no feature encoding block.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        ansatz_config (AnsatzConfig): The configuration for the ansatz.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">            Defaults to a single layer of hardware efficient ansatz.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        backend (BackendName): The chosen quantum backend.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        diff_mode (DiffMode): The differentiation engine to use. Choices are</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">            &#39;gpsr&#39; or &#39;ad&#39;.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        measurement (Measurements): Optional measurement protocol. If None,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">            use exact expectation value with a statevector simulator.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        noise (Noise): A noise model to use.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        configuration (BackendConfiguration | dict): Optional backend configuration.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        input_diff_mode (InputDiffMode): The differentiation mode for the input tensor.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        A QNN object.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        ValueError: If the observable configuration is not provided.</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    ```python exec=&quot;on&quot; source=&quot;material-block&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    from qadence.ml_tools.config import AnsatzConfig, FeatureMapConfig</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    from qadence.ml_tools import QNN</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">    from qadence.constructors import ObservableConfig</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">    from qadence.operations import Z</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">    from qadence.types import (</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        AnsatzType, BackendName, BasisSet, ObservableTransform, ReuploadScaling, Strategy</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">    )</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">    register = 4</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    obs_config = ObservableConfig(</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        detuning=Z,</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        scale=5.0,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        shift=0.0,</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        transformation_type=ObservableTransform.SCALE,</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        trainable_transform=None,</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">    )</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">    fm_config = FeatureMapConfig(</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        num_features=2,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="sd">        inputs=[&quot;x&quot;, &quot;y&quot;],</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        basis_set=BasisSet.FOURIER,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        reupload_scaling=ReuploadScaling.CONSTANT,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        feature_range={</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">            &quot;x&quot;: (-1.0, 1.0),</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">            &quot;y&quot;: (0.0, 1.0),</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        },</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    )</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">    ansatz_config = AnsatzConfig(</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        depth=2,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        ansatz_type=AnsatzType.HEA,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        ansatz_strategy=Strategy.DIGITAL,</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    )</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    qnn = QNN.from_configs(</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        register, obs_config, fm_config, ansatz_config, backend=BackendName.PYQTORCH</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">    )</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    x = torch.rand(2, 2)</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    y = qnn(x)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    print(str(y)) # markdown-exec: hide</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">    ```</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">.constructors</span><span class="w"> </span><span class="kn">import</span> <span class="n">build_qnn_from_configs</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="k">return</span> <span class="n">build_qnn_from_configs</span><span class="p">(</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="n">register</span><span class="o">=</span><span class="n">register</span><span class="p">,</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="n">observable_config</span><span class="o">=</span><span class="n">obs_config</span><span class="p">,</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="n">fm_config</span><span class="o">=</span><span class="n">fm_config</span><span class="p">,</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="n">ansatz_config</span><span class="o">=</span><span class="n">ansatz_config</span><span class="p">,</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="n">diff_mode</span><span class="o">=</span><span class="n">diff_mode</span><span class="p">,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="n">measurement</span><span class="o">=</span><span class="n">measurement</span><span class="p">,</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="n">configuration</span><span class="o">=</span><span class="n">configuration</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="n">input_diff_mode</span><span class="o">=</span><span class="n">input_diff_mode</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.models.derivative" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">derivative</span><span class="p">(</span><span class="n">ufa</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">derivative_indices</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Compute derivatives w.r.t.</p>
<p>inputs of a UFA with a single output. The
<code>derivative_indices</code> specify which derivative(s) are computed.  E.g.
<code>derivative_indices=(1,2)</code> would compute the a second order derivative w.r.t
to the indices <code>1</code> and <code>2</code> of the input tensor.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>ufa</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model for which we want to compute the derivative.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>x</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>(batch_size, input_size) input tensor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.Tensor" optional hover>Tensor</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>derivative_indices</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Define which derivatives to compute.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="tuple" optional>tuple</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>
      <p>Examples:
If we create a UFA with three inputs and denote the first, second, and third
input with <code>x</code>, <code>y</code>, and <code>z</code> we can compute the following derivatives w.r.t
to those inputs:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">derivative</span><span class="p">,</span> <span class="n">QNN</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">FeatureMapConfig</span><span class="p">,</span> <span class="n">AnsatzConfig</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.constructors.hamiltonians</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObservableConfig</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.operations</span><span class="w"> </span><span class="kn">import</span> <span class="n">Z</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">fm_config</span> <span class="o">=</span> <span class="n">FeatureMapConfig</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">])</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">ansatz_config</span> <span class="o">=</span> <span class="n">AnsatzConfig</span><span class="p">()</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">obs_config</span> <span class="o">=</span> <span class="n">ObservableConfig</span><span class="p">(</span><span class="n">detuning</span><span class="o">=</span><span class="n">Z</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">f</span> <span class="o">=</span> <span class="n">QNN</span><span class="o">.</span><span class="n">from_configs</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">register</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">obs_config</span><span class="o">=</span><span class="n">obs_config</span><span class="p">,</span> <span class="n">fm_config</span><span class="o">=</span><span class="n">fm_config</span><span class="p">,</span> <span class="n">ansatz_config</span><span class="o">=</span><span class="n">ansatz_config</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c1"># df_dx</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="c1"># d2f_dydz</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="c1"># d3fdy2dx</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="n">derivative</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div>
<div class="result" markdown="1" >



</div></p>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="k">def</span><span class="w"> </span><span class="nf">derivative</span><span class="p">(</span><span class="n">ufa</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">derivative_indices</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute derivatives w.r.t.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    inputs of a UFA with a single output. The</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    `derivative_indices` specify which derivative(s) are computed.  E.g.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    `derivative_indices=(1,2)` would compute the a second order derivative w.r.t</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    to the indices `1` and `2` of the input tensor.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        ufa: The model for which we want to compute the derivative.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        x (Tensor): (batch_size, input_size) input tensor.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        derivative_indices (tuple): Define which derivatives to compute.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    If we create a UFA with three inputs and denote the first, second, and third</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">    input with `x`, `y`, and `z` we can compute the following derivatives w.r.t</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    to those inputs:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    ```py exec=&quot;on&quot; source=&quot;material-block&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    from qadence.ml_tools.models import derivative, QNN</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    from qadence.ml_tools.config import FeatureMapConfig, AnsatzConfig</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    from qadence.constructors.hamiltonians import ObservableConfig</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    from qadence.operations import Z</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    fm_config = FeatureMapConfig(num_features=3, inputs=[&quot;x&quot;, &quot;y&quot;, &quot;z&quot;])</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    ansatz_config = AnsatzConfig()</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    obs_config = ObservableConfig(detuning=Z)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    f = QNN.from_configs(</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        register=3, obs_config=obs_config, fm_config=fm_config, ansatz_config=ansatz_config,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    )</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    inputs = torch.rand(5,3,requires_grad=True)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    # df_dx</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    derivative(f, inputs, (0,))</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    # d2f_dydz</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    derivative(f, inputs, (1,2))</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    # d3fdy2dx</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    derivative(f, inputs, (1,1,0))</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    ```</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">assert</span> <span class="n">ufa</span><span class="o">.</span><span class="n">out_features</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Can only call `derivative` on models with 1D output.&quot;</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="k">return</span> <span class="n">ufa</span><span class="o">.</span><span class="n">_derivative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">derivative_indices</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.models.format_to_dict_fn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">format_to_dict_fn</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="p">[])</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Format an input tensor into the format required by the forward pass.</p>
<p>The tensor is assumed to have dimensions: n_batches x in_features where in_features
corresponds to the number of input features of the QNN</p>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="k">def</span><span class="w"> </span><span class="nf">format_to_dict_fn</span><span class="p">(</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">inputs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Tensor</span> <span class="o">|</span> <span class="n">ParamDictType</span><span class="p">],</span> <span class="n">ParamDictType</span><span class="p">]:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Format an input tensor into the format required by the forward pass.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    The tensor is assumed to have dimensions: n_batches x in_features where in_features</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    corresponds to the number of input features of the QNN</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">in_features</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">tensor_to_dict</span><span class="p">(</span><span class="n">values</span><span class="p">:</span> <span class="n">Tensor</span> <span class="o">|</span> <span class="n">ParamDictType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ParamDictType</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">size</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">values</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">in_features</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>                    <span class="sa">f</span><span class="s2">&quot;Model expects in_features=</span><span class="si">{</span><span class="n">in_features</span><span class="si">}</span><span class="s2"> but got </span><span class="si">{</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>                <span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="n">values</span> <span class="o">=</span> <span class="p">{</span><span class="n">fparam</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">values</span><span class="p">[:,</span> <span class="n">inputs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">fparam</span><span class="p">)]</span> <span class="k">for</span> <span class="n">fparam</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">}</span>  <span class="c1"># type: ignore[union-attr]</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="k">return</span> <span class="n">values</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">return</span> <span class="n">tensor_to_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.Callback" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Callback</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


      <p>Base class for defining various training callbacks.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback.on" optional hover>on</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The event on which to trigger the callback.
Must be a valid on value from: ["train_start", "train_end",
    "train_epoch_start", "train_epoch_end", "train_batch_start",
    "train_batch_end","val_epoch_start", "val_epoch_end",
    "val_batch_start", "val_batch_end", "test_batch_start",
    "test_batch_end"]</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback.called_every" optional hover>called_every</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback.callback" optional hover>callback</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The function to call if the condition is met.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.callback.CallbackFunction" optional hover>CallbackFunction</autoref> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback.callback_condition" optional hover>callback_condition</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Condition to check before calling.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.callback.CallbackConditionFunction" optional hover>CallbackConditionFunction</autoref> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback.modify_optimize_result" optional hover>modify_optimize_result</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Function to modify <code>OptimizeResult</code>.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.callback.CallbackFunction" optional hover>CallbackFunction</autoref> | <autoref identifier="dict" optional>dict</autoref>[<autoref identifier="str" optional>str</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>] | None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>
      <p>A callback can be defined in two ways:</p>
<ol>
<li><strong>By providing a callback function directly in the base class</strong>:
   This is useful for simple callbacks that don't require subclassing.</li>
</ol>
<p>Example:
   <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callback</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">custom_callback_function</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Custom callback executed.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">custom_callback</span> <span class="o">=</span> <span class="n">Callback</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;train_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">called_every</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">callback</span><span class="o">=</span><span class="n">custom_callback_function</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>
<ol>
<li><strong>By inheriting and implementing the <code>run_callback</code> method</strong>:
   This is suitable for more complex callbacks that require customization.</li>
</ol>
<p>Example:
   <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callback</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">CustomCallback</span><span class="p">(</span><span class="n">Callback</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">):</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Custom behavior in the inherited run_callback method.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">custom_callback</span> <span class="o">=</span> <span class="n">CustomCallback</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;train_end&quot;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="n">callback_condition</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="o">.</span><span class="n">extra</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">)</span> <span class="ow">or</span> <span class="n">opt_res</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="n">modify_optimize_result</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.callbacks.callback.Callback.on" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on</span><span class="p">:</span> <span class="n">TrainingStage</span> <span class="o">|</span> <span class="nb">str</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Returns the TrainingStage.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>TrainingStage</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>TrainingStage for the callback</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.stages.TrainingStage" optional hover>TrainingStage</autoref> | <autoref identifier="str" optional>str</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.Callback.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">when</span><span class="p">,</span> <span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Executes the callback if conditions are met.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>when</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event when the callback is triggered.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Any</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Result of the callback function if executed.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">when</span><span class="p">:</span> <span class="n">TrainingStage</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Executes the callback if conditions are met.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        when (str): The event when the callback is triggered.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        Any: Result of the callback function if executed.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on</span> <span class="o">==</span> <span class="n">when</span><span class="p">:</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="k">if</span> <span class="n">opt_result</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="n">opt_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span><span class="p">(</span><span class="n">opt_result</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_should_call</span><span class="p">(</span><span class="n">when</span><span class="p">,</span> <span class="n">opt_result</span><span class="p">):</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.Callback.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Executes the defined callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Any</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Result of the callback execution.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RAISES</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
              <span class="doc-raises-annotation">
                  <code><autoref identifier="NotImplementedError" optional>NotImplementedError</autoref></code>
              </span>
            </td>
            <td class="doc-raises-details">
              <div class="doc-md-description">
                <p>If not implemented in subclasses.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Executes the defined callback.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        Any: Result of the callback execution.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        NotImplementedError: If not implemented in subclasses.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Subclasses should override the run_callback method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.EarlyStopping" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="p">,</span> <span class="n">monitor</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback" optional hover>Callback</autoref></code></p>


      <p>Stops training when a monitored metric has not improved for a specified number of epochs.</p>
<p>This callback monitors a specified metric (e.g., validation loss or accuracy). If the metric
does not improve for a given patience period, training is stopped.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>EarlyStopping</code>, include it in the <code>callbacks</code> list when setting up your <code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">EarlyStopping</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the EarlyStopping callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">early_stopping</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;val_epoch_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>                               <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>                               <span class="n">monitor</span><span class="o">=</span><span class="s2">&quot;val_loss&quot;</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>                               <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>                               <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">early_stopping</span><span class="p">]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

      <p>Initializes the EarlyStopping callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>on</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event to trigger the callback (e.g., "val_epoch_end").</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>called_every</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>monitor</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The metric to monitor (e.g., "val_loss" or "train_loss").
All metrics returned by optimize step are available to monitor.
Please add "val_" and "train_" strings at the start of the metric name.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>patience</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Number of iterations to wait for improvement. Default is 5.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>5</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>mode</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to minimize ("min") or maximize ("max") the metric.
Default is "min".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;min&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">monitor</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">patience</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;min&quot;</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="p">):</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the EarlyStopping callback.</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">        on (str): The event to trigger the callback (e.g., &quot;val_epoch_end&quot;).</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">        called_every (int): Frequency of callback calls in terms of iterations.</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">        monitor (str): The metric to monitor (e.g., &quot;val_loss&quot; or &quot;train_loss&quot;).</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">            All metrics returned by optimize step are available to monitor.</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">            Please add &quot;val_&quot; and &quot;train_&quot; strings at the start of the metric name.</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">        patience (int, optional): Number of iterations to wait for improvement. Default is 5.</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="sd">        mode (str, optional): Whether to minimize (&quot;min&quot;) or maximize (&quot;max&quot;) the metric.</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">            Default is &quot;min&quot;.</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="n">called_every</span><span class="p">)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span> <span class="o">=</span> <span class="n">monitor</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">patience</span> <span class="o">=</span> <span class="n">patience</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">best_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span> <span class="k">else</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.EarlyStopping.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Monitors the metric and stops training if no improvement is observed.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-690" name="__codelineno-0-690"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a><span class="sd">    Monitors the metric and stops training if no improvement is observed.</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a><span class="sd">        writer (BaseWriter): The writer object for logging.</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>    <span class="n">current_value</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="p">)</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>    <span class="k">if</span> <span class="n">current_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Metric &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="si">}</span><span class="s2">&#39; is not available in the trainer&#39;s metrics.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span> <span class="ow">and</span> <span class="n">current_value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_value</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span> <span class="ow">and</span> <span class="n">current_value</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_value</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="p">):</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">best_value</span> <span class="o">=</span> <span class="n">current_value</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">counter</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">patience</span><span class="p">:</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>            <span class="sa">f</span><span class="s2">&quot;EarlyStopping: No improvement in &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="si">}</span><span class="s2">&#39; for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">patience</span><span class="si">}</span><span class="s2"> epochs. &quot;</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>            <span class="s2">&quot;Stopping training.&quot;</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="p">)</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>        <span class="n">trainer</span><span class="o">.</span><span class="n">stop_training</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.GradientMonitoring" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">GradientMonitoring</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback" optional hover>Callback</autoref></code></p>


      <p>Logs gradient statistics (e.g., mean, standard deviation, max) during training.</p>
<p>This callback monitors and logs statistics about the gradients of the model parameters
to help debug or optimize the training process.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>GradientMonitoring</code>, include it in the <code>callbacks</code> list when
setting up your <code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">GradientMonitoring</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the GradientMonitoring callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">gradient_monitoring</span> <span class="o">=</span> <span class="n">GradientMonitoring</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;train_batch_end&quot;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">gradient_monitoring</span><span class="p">]</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

      <p>Initializes the GradientMonitoring callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>on</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event to trigger the callback (e.g., "train_batch_end").</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>called_every</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-744" name="__codelineno-0-744"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the GradientMonitoring callback.</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">        on (str): The event to trigger the callback (e.g., &quot;train_batch_end&quot;).</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="sd">        called_every (int): Frequency of callback calls in terms of iterations.</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="n">called_every</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.GradientMonitoring.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Logs gradient statistics.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">    Logs gradient statistics.</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">        writer (BaseWriter): The writer object for logging.</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>    <span class="n">gradient_stats</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">trainer</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>        <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">grad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>            <span class="n">grad</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">grad</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>            <span class="n">gradient_stats</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>                <span class="p">{</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>                    <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_mean&quot;</span><span class="p">:</span> <span class="n">grad</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>                    <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_std&quot;</span><span class="p">:</span> <span class="n">grad</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                    <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_max&quot;</span><span class="p">:</span> <span class="n">grad</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>                    <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_min&quot;</span><span class="p">:</span> <span class="n">grad</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>                <span class="p">}</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>            <span class="p">)</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>    <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span><span class="p">,</span> <span class="n">gradient_stats</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.LRSchedulerCosineAnnealing" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LRSchedulerCosineAnnealing</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="n">min_lr</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback" optional hover>Callback</autoref></code></p>


      <p>Applies cosine annealing to the learning rate during training.</p>
<p>This callback decreases the learning rate following a cosine curve,
starting from the initial learning rate and annealing to a minimum (min_lr).</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>LRSchedulerCosineAnnealing</code>, include it in the <code>callbacks</code> list
when setting up your <code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">LRSchedulerCosineAnnealing</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the LRSchedulerCosineAnnealing callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">lr_cosine</span> <span class="o">=</span> <span class="n">LRSchedulerCosineAnnealing</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;train_batch_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>                                       <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>                                       <span class="n">t_max</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>                                       <span class="n">min_lr</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="c1"># Add the custom callback</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">lr_cosine</span><span class="p">]</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

      <p>Initializes the LRSchedulerCosineAnnealing callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>on</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event to trigger the callback.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>called_every</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>t_max</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The total number of iterations for one annealing cycle.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>min_lr</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The minimum learning rate. Default is 0.0.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="float" optional>float</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0.0</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">t_max</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">min_lr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">):</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the LRSchedulerCosineAnnealing callback.</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">        on (str): The event to trigger the callback.</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">        called_every (int): Frequency of callback calls in terms of iterations.</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">        t_max (int): The total number of iterations for one annealing cycle.</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">        min_lr (float, optional): The minimum learning rate. Default is 0.0.</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="n">called_every</span><span class="p">)</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">t_max</span> <span class="o">=</span> <span class="n">t_max</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">min_lr</span> <span class="o">=</span> <span class="n">min_lr</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.LRSchedulerCosineAnnealing.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Adjusts the learning rate using cosine annealing.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-620" name="__codelineno-0-620"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="sd">    Adjusts the learning rate using cosine annealing.</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a><span class="sd">        writer (BaseWriter): The writer object for logging.</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>    <span class="k">for</span> <span class="n">param_group</span> <span class="ow">in</span> <span class="n">trainer</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">param_groups</span><span class="p">:</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="n">max_lr</span> <span class="o">=</span> <span class="n">param_group</span><span class="p">[</span><span class="s2">&quot;lr&quot;</span><span class="p">]</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="n">new_lr</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">min_lr</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>            <span class="o">+</span> <span class="p">(</span><span class="n">max_lr</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_lr</span><span class="p">)</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>            <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">t_max</span><span class="p">))</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>        <span class="p">)</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="n">param_group</span><span class="p">[</span><span class="s2">&quot;lr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_lr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.LRSchedulerCyclic" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LRSchedulerCyclic</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="p">,</span> <span class="n">base_lr</span><span class="p">,</span> <span class="n">max_lr</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback" optional hover>Callback</autoref></code></p>


      <p>Applies a cyclic learning rate schedule during training.</p>
<p>This callback oscillates the learning rate between a minimum (base_lr)
and a maximum (max_lr) over a defined cycle length (step_size). The learning
rate follows a triangular wave pattern.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>LRSchedulerCyclic</code>, include it in the <code>callbacks</code> list when setting
up your <code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">LRSchedulerCyclic</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the LRSchedulerCyclic callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">lr_cyclic</span> <span class="o">=</span> <span class="n">LRSchedulerCyclic</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;train_batch_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>                              <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>                              <span class="n">base_lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>                              <span class="n">max_lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>                              <span class="n">step_size</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="c1"># Add the custom callback</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">lr_cyclic</span><span class="p">]</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

      <p>Initializes the LRSchedulerCyclic callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>on</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event to trigger the callback.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>called_every</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>base_lr</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The minimum learning rate.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="float" optional>float</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>max_lr</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The maximum learning rate.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="float" optional>float</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>step_size</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Number of iterations for half a cycle.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">base_lr</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">max_lr</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the LRSchedulerCyclic callback.</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">        on (str): The event to trigger the callback.</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">        called_every (int): Frequency of callback calls in terms of iterations.</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">        base_lr (float): The minimum learning rate.</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">        max_lr (float): The maximum learning rate.</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">        step_size (int): Number of iterations for half a cycle.</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="n">called_every</span><span class="p">)</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">base_lr</span> <span class="o">=</span> <span class="n">base_lr</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_lr</span> <span class="o">=</span> <span class="n">max_lr</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span> <span class="o">=</span> <span class="n">step_size</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.LRSchedulerCyclic.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Adjusts the learning rate cyclically.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">    Adjusts the learning rate cyclically.</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">        writer (BaseWriter): The writer object for logging.</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>    <span class="n">cycle</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span> <span class="o">//</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span><span class="p">)</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="n">x</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">cycle</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>    <span class="n">scale</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="n">new_lr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_lr</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_lr</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_lr</span><span class="p">)</span> <span class="o">*</span> <span class="n">scale</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="k">for</span> <span class="n">param_group</span> <span class="ow">in</span> <span class="n">trainer</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">param_groups</span><span class="p">:</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="n">param_group</span><span class="p">[</span><span class="s2">&quot;lr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_lr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.LRSchedulerStepDecay" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LRSchedulerStepDecay</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback" optional hover>Callback</autoref></code></p>


      <p>Reduces the learning rate by a factor at regular intervals.</p>
<p>This callback adjusts the learning rate by multiplying it with a decay factor
after a specified number of iterations. The learning rate is updated as:
    lr = lr * gamma</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>LRSchedulerStepDecay</code>, include it in the <code>callbacks</code> list when setting
up your <code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">LRSchedulerStepDecay</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the LRSchedulerStepDecay callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">lr_step_decay</span> <span class="o">=</span> <span class="n">LRSchedulerStepDecay</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s2">&quot;train_epoch_end&quot;</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>                                     <span class="n">called_every</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>                                     <span class="n">gamma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="c1"># Add the custom callback</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">lr_step_decay</span><span class="p">]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

      <p>Initializes the LRSchedulerStepDecay callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>on</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event to trigger the callback.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>called_every</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>gamma</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The decay factor applied to the learning rate.
A value &lt; 1 reduces the learning rate over time. Default is 0.5.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="float" optional>float</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0.5</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">):</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the LRSchedulerStepDecay callback.</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">        on (str): The event to trigger the callback.</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">        called_every (int): Frequency of callback calls in terms of iterations.</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">        gamma (float, optional): The decay factor applied to the learning rate.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">            A value &lt; 1 reduces the learning rate over time. Default is 0.5.</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="n">called_every</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.LRSchedulerStepDecay.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Runs the callback to apply step decay to the learning rate.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">    Runs the callback to apply step decay to the learning rate.</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">        writer (BaseWriter): The writer object for logging.</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="k">for</span> <span class="n">param_group</span> <span class="ow">in</span> <span class="n">trainer</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">param_groups</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="n">param_group</span><span class="p">[</span><span class="s2">&quot;lr&quot;</span><span class="p">]</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.LoadCheckpoint" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LoadCheckpoint</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback" optional hover>Callback</autoref></code></p>


      <p>Callback to load a model checkpoint.</p>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="n">callback_condition</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="o">.</span><span class="n">extra</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">)</span> <span class="ow">or</span> <span class="n">opt_res</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="n">modify_optimize_result</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.LoadCheckpoint.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Loads a model checkpoint.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Any</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The result of loading the checkpoint.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads a model checkpoint.</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">        Any: The result of loading the checkpoint.</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="n">folder</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">log_folder</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">model</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">optimizer</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">device</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">log_device</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="k">return</span> <span class="n">load_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.LogHyperparameters" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LogHyperparameters</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback" optional hover>Callback</autoref></code></p>


      <p>Callback to log hyperparameters using the writer.</p>
<p>The <code>LogHyperparameters</code> callback can be added to the <code>TrainConfig</code> callbacks
as a custom user defined callback.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>LogHyperparameters</code>, include it in the <code>callbacks</code> list when setting up your
<code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogHyperparameters</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the LogHyperparameters callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">log_hyper_callback</span> <span class="o">=</span> <span class="n">LogHyperparameters</span><span class="p">(</span><span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;val_batch_end&quot;</span><span class="p">,</span> <span class="n">called_every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="c1"># Add the custom callback that runs every 100 val_batch_end</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">log_hyper_callback</span><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="n">callback_condition</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="o">.</span><span class="n">extra</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">)</span> <span class="ow">or</span> <span class="n">opt_res</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="n">modify_optimize_result</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.LogHyperparameters.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Logs hyperparameters using the writer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Logs hyperparameters using the writer.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="n">hyperparams</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">hyperparams</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="n">writer</span><span class="o">.</span><span class="n">log_hyperparams</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.LogModelTracker" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LogModelTracker</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback" optional hover>Callback</autoref></code></p>


      <p>Callback to log the model using the writer.</p>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="n">callback_condition</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="o">.</span><span class="n">extra</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">)</span> <span class="ow">or</span> <span class="n">opt_res</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="n">modify_optimize_result</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.LogModelTracker.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Logs the model using the writer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Logs the model using the writer.</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">model</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="n">writer</span><span class="o">.</span><span class="n">log_model</span><span class="p">(</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="n">model</span><span class="p">,</span> <span class="n">trainer</span><span class="o">.</span><span class="n">train_dataloader</span><span class="p">,</span> <span class="n">trainer</span><span class="o">.</span><span class="n">val_dataloader</span><span class="p">,</span> <span class="n">trainer</span><span class="o">.</span><span class="n">test_dataloader</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.PlotMetrics" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">PlotMetrics</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback" optional hover>Callback</autoref></code></p>


      <p>Callback to plot metrics using the writer.</p>
<p>The <code>PlotMetrics</code> callback can be added to the <code>TrainConfig</code> callbacks as
a custom user defined callback.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>PlotMetrics</code>, include it in the <code>callbacks</code> list when setting up your
<code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">PlotMetrics</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the PlotMetrics callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">plot_metrics_callback</span> <span class="o">=</span> <span class="n">PlotMetrics</span><span class="p">(</span><span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;val_batch_end&quot;</span><span class="p">,</span> <span class="n">called_every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="c1"># Add the custom callback that runs every 100 val_batch_end</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">plot_metrics_callback</span><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="n">callback_condition</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="o">.</span><span class="n">extra</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">)</span> <span class="ow">or</span> <span class="n">opt_res</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="n">modify_optimize_result</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.PlotMetrics.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Plots metrics using the writer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots metrics using the writer.</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="n">plotting_functions</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">plotting_functions</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="n">writer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trainer</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span><span class="p">,</span> <span class="n">plotting_functions</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.PrintMetrics" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">PrintMetrics</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback" optional hover>Callback</autoref></code></p>


      <p>Callback to print metrics using the writer.</p>
<p>The <code>PrintMetrics</code> callback can be added to the <code>TrainConfig</code>
callbacks as a custom user defined callback.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>PrintMetrics</code>, include it in the <code>callbacks</code> list when
setting up your <code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">PrintMetrics</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the PrintMetrics callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">print_metrics_callback</span> <span class="o">=</span> <span class="n">PrintMetrics</span><span class="p">(</span><span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;val_batch_end&quot;</span><span class="p">,</span> <span class="n">called_every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="c1"># Add the custom callback that runs every 100 val_batch_end</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">print_metrics_callback</span><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="n">callback_condition</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="o">.</span><span class="n">extra</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">)</span> <span class="ow">or</span> <span class="n">opt_res</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="n">modify_optimize_result</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.PrintMetrics.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Prints metrics using the writer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints metrics using the writer.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">writer</span><span class="o">.</span><span class="n">print_metrics</span><span class="p">(</span><span class="n">opt_result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.SaveBestCheckpoint" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">SaveBestCheckpoint</span><span class="p">(</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.callback.SaveCheckpoint" optional hover>SaveCheckpoint</autoref></code></p>


      <p>Callback to save the best model checkpoint based on a validation criterion.</p>

      <p>Initializes the SaveBestCheckpoint callback.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>on</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The event to trigger the callback.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>called_every</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Frequency of callback calls in terms of iterations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the SaveBestCheckpoint callback.</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        on (str): The event to trigger the callback.</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        called_every (int): Frequency of callback calls in terms of iterations.</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="n">called_every</span><span class="p">)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">best_loss</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.SaveBestCheckpoint.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Saves the checkpoint if the current loss is better than the best loss.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves the checkpoint if the current loss is better than the best loss.</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">validation_criterion</span> <span class="ow">and</span> <span class="n">config</span><span class="o">.</span><span class="n">validation_criterion</span><span class="p">(</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="n">opt_result</span><span class="o">.</span><span class="n">loss</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_loss</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">val_epsilon</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="p">):</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">best_loss</span> <span class="o">=</span> <span class="n">opt_result</span><span class="o">.</span><span class="n">loss</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="n">folder</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">log_folder</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">model</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">optimizer</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="n">write_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="s2">&quot;best&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.SaveCheckpoint" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">SaveCheckpoint</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback" optional hover>Callback</autoref></code></p>


      <p>Callback to save a model checkpoint.</p>
<p>The <code>SaveCheckpoint</code> callback can be added to the <code>TrainConfig</code> callbacks
as a custom user defined callback.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>SaveCheckpoint</code>, include it in the <code>callbacks</code> list when setting up your
<code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">SaveCheckpoint</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the SaveCheckpoint callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">save_checkpoint_callback</span> <span class="o">=</span> <span class="n">SaveCheckpoint</span><span class="p">(</span><span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;val_batch_end&quot;</span><span class="p">,</span> <span class="n">called_every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="c1"># Add the custom callback that runs every 100 val_batch_end</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">save_checkpoint_callback</span><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="n">callback_condition</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="o">.</span><span class="n">extra</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">)</span> <span class="ow">or</span> <span class="n">opt_res</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="n">modify_optimize_result</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.SaveCheckpoint.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Saves a model checkpoint.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves a model checkpoint.</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="n">folder</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">log_folder</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">model</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">optimizer</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="n">write_checkpoint</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.callback.WriteMetrics" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">WriteMetrics</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span> <span class="n">called_every</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callback_condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modify_optimize_result</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.callback.Callback" optional hover>Callback</autoref></code></p>


      <p>Callback to write metrics using the writer.</p>
<p>The <code>WriteMetrics</code> callback can be added to the <code>TrainConfig</code> callbacks as
a custom user defined callback.</p>
<p>Example Usage in <code>TrainConfig</code>:
To use <code>WriteMetrics</code>, include it in the <code>callbacks</code> list when setting up your
<code>TrainConfig</code>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.ml_tools.callbacks</span><span class="w"> </span><span class="kn">import</span> <span class="n">WriteMetrics</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create an instance of the WriteMetrics callback</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">write_metrics_callback</span> <span class="o">=</span> <span class="n">WriteMetrics</span><span class="p">(</span><span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;val_batch_end&quot;</span><span class="p">,</span> <span class="n">called_every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">config</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="c1"># Print metrics every 1000 training epochs</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">print_every</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="c1"># Add the custom callback that runs every 100 val_batch_end</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">write_metrics_callback</span><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>
</code></pre></div>

</div></p>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="s2">&quot;idle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">callback_condition</span><span class="p">:</span> <span class="n">CallbackConditionFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">modify_optimize_result</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">called_every</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;called_every must be a positive integer or 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">:</span> <span class="n">CallbackFunction</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">callback</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">on</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">called_every</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">called_every</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">callback_condition</span> <span class="o">=</span> <span class="n">callback_condition</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="o">.</span><span class="n">extra</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">modify_optimize_result</span><span class="p">)</span> <span class="ow">or</span> <span class="n">opt_res</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">modify_optimize_result</span> <span class="o">=</span> <span class="n">modify_optimize_result</span> <span class="ow">or</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">opt_res</span><span class="p">:</span> <span class="n">opt_res</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.callback.WriteMetrics.run_callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_callback</span><span class="p">(</span><span class="n">trainer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">writer</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Writes metrics using the writer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>trainer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The training object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>writer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The writer object for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/callback.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trainer</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">writer</span><span class="p">:</span> <span class="n">BaseWriter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes metrics using the writer.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        trainer (Any): The training object.</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        config (TrainConfig): The configuration object.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        writer (BaseWriter ): The writer object for logging.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">opt_result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">opt_result</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">opt_result</span><span class="o">.</span><span class="n">iteration</span><span class="p">,</span> <span class="n">opt_result</span><span class="o">.</span><span class="n">metrics</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">BaseTrainer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">loss_fn</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">optimize_step</span><span class="o">=</span><span class="n">optimize_step</span><span class="p">,</span> <span class="n">train_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_batches</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


      <p>Base class for training machine learning models using a given optimizer.</p>
<p>The base class implements contextmanager for gradient based/free optimization,
properties, property setters, input validations, callback decorator generator,
and empty hooks for different training steps.</p>


<details class="this-class-provides" open>
  <summary>This class provides</summary>
  <ul>
<li>Context managers for enabling/disabling gradient-based optimization</li>
<li>Properties for managing models, optimizers, and dataloaders</li>
<li>Input validations and a callback decorator generator</li>
<li>Config and callback managers using the provided <code>TrainConfig</code></li>
</ul>
</details>

<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.use_grad" optional hover>use_grad</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Indicates if gradients are used for optimization. Default is True.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="bool" optional>bool</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.model" optional hover>model</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The neural network model.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.optimizer" optional hover>optimizer</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The optimizer for training.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.optim.Optimizer" optional hover>Optimizer</autoref> | <autoref identifier="nevergrad.optimization.base.Optimizer" optional hover>Optimizer</autoref> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.config" optional hover>config</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The configuration settings for training.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.train_dataloader" optional hover>train_dataloader</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="Dataloader" optional>Dataloader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.val_dataloader" optional hover>val_dataloader</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="Dataloader" optional>Dataloader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.test_dataloader" optional hover>test_dataloader</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>DataLoader for testing data.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="Dataloader" optional>Dataloader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.optimize_step" optional hover>optimize_step</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Function for performing an optimization step.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Callable" optional hover>Callable</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.loss_fn" optional hover>loss_fn</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>loss function to use. Default loss function
used is 'mse'</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code>Callable | str ]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.num_training_batches" optional hover>num_training_batches</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Number of training batches. In case of
InfiniteTensorDataset only 1 batch per epoch is used.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.num_validation_batches" optional hover>num_validation_batches</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Number of validation batches. In case of
InfiniteTensorDataset only 1 batch per epoch is used.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.num_test_batches" optional hover>num_test_batches</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Number of test batches. In case of
InfiniteTensorDataset only 1 batch per epoch is used.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.state" optional hover>state</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Current state in the training process</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

      <p>Initializes the BaseTrainer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to train.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>optimizer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The optimizer
for training.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.optim.Optimizer" optional hover>Optimizer</autoref> | <autoref identifier="nevergrad.optimization.base.Optimizer" optional hover>Optimizer</autoref> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The TrainConfig settings for training.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>loss_fn</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The loss function to use.
str input to be specified to use a default loss function.
currently supported loss functions: 'mse', 'cross_entropy'.
If not specified, default mse loss will be used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref> | <autoref identifier="typing.Callable" optional hover>Callable</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#39;mse&#39;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>train_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.
If the model does not need data to evaluate loss, no dataset
should be provided.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="Dataloader" optional>Dataloader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>val_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="Dataloader" optional>Dataloader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>test_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for testing data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="Dataloader" optional>Dataloader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>max_batches</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum number of batches to process per epoch.
This is only valid in case of finite TensorDataset dataloaders.
if max_batches is not None, the maximum number of batches used will
be min(max_batches, len(dataloader.dataset))
In case of InfiniteTensorDataset only 1 batch per epoch is used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">optimizer</span><span class="p">:</span> <span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span> <span class="o">|</span> <span class="n">NGOptimizer</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">loss_fn</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Callable</span> <span class="o">=</span> <span class="s2">&quot;mse&quot;</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">optimize_step</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">optimize_step</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">max_batches</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="p">):</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    Initializes the BaseTrainer.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        model (nn.Module): The model to train.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        optimizer (optim.Optimizer | NGOptimizer | None): The optimizer</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">            for training.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        config (TrainConfig): The TrainConfig settings for training.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        loss_fn (str | Callable): The loss function to use.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">            str input to be specified to use a default loss function.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">            currently supported loss functions: &#39;mse&#39;, &#39;cross_entropy&#39;.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            If not specified, default mse loss will be used.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        train_dataloader (Dataloader | DictDataLoader | None): DataLoader for training data.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">            If the model does not need data to evaluate loss, no dataset</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            should be provided.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        val_dataloader (Dataloader | DictDataLoader | None): DataLoader for validation data.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        test_dataloader (Dataloader | DictDataLoader | None): DataLoader for testing data.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        max_batches (int | None): Maximum number of batches to process per epoch.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            This is only valid in case of finite TensorDataset dataloaders.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            if max_batches is not None, the maximum number of batches used will</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            be min(max_batches, len(dataloader.dataset))</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            In case of InfiniteTensorDataset only 1 batch per epoch is used.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer</span><span class="p">:</span> <span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span> <span class="o">|</span> <span class="n">NGOptimizer</span> <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">:</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_batches</span> <span class="o">=</span> <span class="n">max_batches</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">num_training_batches</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">num_validation_batches</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">num_test_batches</span><span class="p">:</span> <span class="nb">int</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">train_dataloader</span> <span class="o">=</span> <span class="n">train_dataloader</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">val_dataloader</span> <span class="o">=</span> <span class="n">val_dataloader</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">test_dataloader</span> <span class="o">=</span> <span class="n">test_dataloader</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">get_loss_fn</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">optimize_step</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="n">optimize_step</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ng_params</span><span class="p">:</span> <span class="n">ng</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Array</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">training_stage</span><span class="p">:</span> <span class="n">TrainingStage</span> <span class="o">=</span> <span class="n">TrainingStage</span><span class="p">(</span><span class="s2">&quot;idle&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Returns the training configuration.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>TrainConfig</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The configuration object.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Returns the model if set, otherwise raises an error.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>nn.Module: The model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.optimizer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimizer</span><span class="p">:</span> <span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span> <span class="o">|</span> <span class="n">NGOptimizer</span> <span class="o">|</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Returns the optimizer if set, otherwise raises an error.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><autoref identifier="torch.optim.Optimizer" optional hover>Optimizer</autoref> | <autoref identifier="nevergrad.optimization.base.Optimizer" optional hover>Optimizer</autoref> | None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>optim.Optimizer | NGOptimizer | None: The optimizer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.test_dataloader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Returns the test DataLoader, validating its type.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>DataLoader</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The DataLoader for testing data.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.train_dataloader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Returns the training DataLoader, validating its type.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>DataLoader</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The DataLoader for training data.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.use_grad" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">use_grad</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Returns the optimization framework for the trainer.</p>
<p>use_grad = True : Gradient based optimization
use_grad = False : Gradient free optimization</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bool</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Bool value for using gradient.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="bool" optional>bool</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.val_dataloader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Returns the validation DataLoader, validating its type.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>DataLoader</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The DataLoader for validation data.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.callback" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">callback</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Decorator for executing callbacks before and after a phase.</p>
<p>Phase are different hooks during the training. list of valid
phases is defined in Callbacks.
We also update the current state of the training process in
the callback decorator.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>phase</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The phase for which the callback is executed (e.g., "train",
"train_epoch", "train_batch").</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="str" optional>str</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Callable</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The decorated function.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="typing.Callable" optional hover>Callable</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="n">phase</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    Decorator for executing callbacks before and after a phase.</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">    Phase are different hooks during the training. list of valid</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">    phases is defined in Callbacks.</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">    We also update the current state of the training process in</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">    the callback decorator.</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        phase (str): The phase for which the callback is executed (e.g., &quot;train&quot;,</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">            &quot;train_epoch&quot;, &quot;train_batch&quot;).</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        Callable: The decorated function.</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">method</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="n">start_event</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">phase</span><span class="si">}</span><span class="s2">_start&quot;</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="n">end_event</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">phase</span><span class="si">}</span><span class="s2">_end&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">training_stage</span> <span class="o">=</span> <span class="n">TrainingStage</span><span class="p">(</span><span class="n">start_event</span><span class="p">)</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">callback_manager</span><span class="o">.</span><span class="n">run_callbacks</span><span class="p">(</span><span class="n">trainer</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">training_stage</span> <span class="o">=</span> <span class="n">TrainingStage</span><span class="p">(</span><span class="n">end_event</span><span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="c1"># build_optimize_result method is defined in the trainer.</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">build_optimize_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">callback_manager</span><span class="o">.</span><span class="n">run_callbacks</span><span class="p">(</span><span class="n">trainer</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="k">return</span> <span class="n">result</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="k">return</span> <span class="n">wrapper</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="k">return</span> <span class="n">decorator</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.disable_grad_opt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">disable_grad_opt</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Context manager to temporarily disable gradient-based optimization.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>optimizer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The Nevergrad optimizer to use.
If no optimizer is provided, default optimizer for trainer
object will be used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="nevergrad.optimization.base.Optimizer" optional hover>Optimizer</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="nd">@contextmanager</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="k">def</span><span class="w"> </span><span class="nf">disable_grad_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">:</span> <span class="n">NGOptimizer</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">    Context manager to temporarily disable gradient-based optimization.</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        optimizer (NGOptimizer): The Nevergrad optimizer to use.</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">            If no optimizer is provided, default optimizer for trainer</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">            object will be used.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="n">original_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="n">original_optimizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">callback_manager</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span> <span class="k">if</span> <span class="n">optimizer</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="k">yield</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="n">original_mode</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">callback_manager</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="n">original_mode</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">original_optimizer</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.enable_grad_opt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">enable_grad_opt</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Context manager to temporarily enable gradient-based optimization.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>optimizer</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The PyTorch optimizer to use.
If no optimizer is provided, default optimizer for trainer
object will be used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.optim.Optimizer" optional hover>Optimizer</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="nd">@contextmanager</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="k">def</span><span class="w"> </span><span class="nf">enable_grad_opt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">:</span> <span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">    Context manager to temporarily enable gradient-based optimization.</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        optimizer (optim.Optimizer): The PyTorch optimizer to use.</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">            If no optimizer is provided, default optimizer for trainer</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">            object will be used.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="n">original_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="n">original_optimizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_optimizer</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">callback_manager</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">optimizer</span> <span class="k">if</span> <span class="n">optimizer</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="k">yield</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="n">original_mode</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">callback_manager</span><span class="o">.</span><span class="n">use_grad</span> <span class="o">=</span> <span class="n">original_mode</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">original_optimizer</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_test_batch_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_test_batch_end</span><span class="p">(</span><span class="n">test_batch_loss_metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Called at the end of each testing batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>test_batch_loss_metrics</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the testing batch loss.
tuple of (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_test_batch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_batch_loss_metrics</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">    Called at the end of each testing batch.</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">        test_batch_loss_metrics: Metrics for the testing batch loss.</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">            tuple of (loss, metrics)</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_test_batch_start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_test_batch_start</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Called at the start of each testing batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>batch</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A batch of data from the DataLoader. Typically a tuple containing
input tensors and corresponding target tensors.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, ...] | None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_test_batch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">    Called at the start of each testing batch.</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">        batch: A batch of data from the DataLoader. Typically a tuple containing</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">            input tensors and corresponding target tensors.</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_batch_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_train_batch_end</span><span class="p">(</span><span class="n">train_batch_loss_metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Called at the end of each training batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>train_batch_loss_metrics</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the training batch loss.
tuple of (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_train_batch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_batch_loss_metrics</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">    Called at the end of each training batch.</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        train_batch_loss_metrics: Metrics for the training batch loss.</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">            tuple of (loss, metrics)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_batch_start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_train_batch_start</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Called at the start of each training batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>batch</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A batch of data from the DataLoader. Typically a tuple containing
input tensors and corresponding target tensors.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, ...] | None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_train_batch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">    Called at the start of each training batch.</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">        batch: A batch of data from the DataLoader. Typically a tuple containing</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">            input tensors and corresponding target tensors.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_train_end</span><span class="p">(</span><span class="n">train_losses</span><span class="p">,</span> <span class="n">val_losses</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Called at the end of training.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>train_losses</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the training losses.
list    -&gt; list                  -&gt; tuples
Epochs  -&gt; Training Batches      -&gt; (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="list" optional>list</autoref>[<autoref identifier="list" optional>list</autoref>[<autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]]</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>val_losses</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the validation losses.
list    -&gt; list                  -&gt; tuples
Epochs  -&gt; Validation Batches    -&gt; (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="list" optional>list</autoref>[<autoref identifier="list" optional>list</autoref>[<autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]] | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_train_end</span><span class="p">(</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="n">train_losses</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="n">val_losses</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">    Called at the end of training.</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        train_losses (list[list[tuple[torch.Tensor, Any]]]):</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">            Metrics for the training losses.</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">            list    -&gt; list                  -&gt; tuples</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">            Epochs  -&gt; Training Batches      -&gt; (loss, metrics)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">        val_losses (list[list[tuple[torch.Tensor, Any]]] | None):</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">            Metrics for the validation losses.</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="sd">            list    -&gt; list                  -&gt; tuples</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">            Epochs  -&gt; Validation Batches    -&gt; (loss, metrics)</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_epoch_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_train_epoch_end</span><span class="p">(</span><span class="n">train_epoch_loss_metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Called at the end of each training epoch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>train_epoch_loss_metrics</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the training epoch losses.
list                  -&gt; tuples
Training Batches      -&gt; (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="list" optional>list</autoref>[<autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_train_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_epoch_loss_metrics</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    Called at the end of each training epoch.</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">        train_epoch_loss_metrics: Metrics for the training epoch losses.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">            list                  -&gt; tuples</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">            Training Batches      -&gt; (loss, metrics)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_epoch_start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_train_epoch_start</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Called at the start of each training epoch.</p>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_train_epoch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Called at the start of each training epoch.&quot;&quot;&quot;</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_train_start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_train_start</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Called at the start of training.</p>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_train_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Called at the start of training.&quot;&quot;&quot;</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_batch_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_val_batch_end</span><span class="p">(</span><span class="n">val_batch_loss_metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Called at the end of each validation batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>val_batch_loss_metrics</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the validation batch loss.
tuple of (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_val_batch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val_batch_loss_metrics</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">    Called at the end of each validation batch.</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">        val_batch_loss_metrics: Metrics for the validation batch loss.</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">            tuple of (loss, metrics)</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_batch_start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_val_batch_start</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Called at the start of each validation batch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>batch</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A batch of data from the DataLoader. Typically a tuple containing
input tensors and corresponding target tensors.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, ...] | None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_val_batch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">    Called at the start of each validation batch.</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        batch: A batch of data from the DataLoader. Typically a tuple containing</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            input tensors and corresponding target tensors.</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_epoch_end" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_val_epoch_end</span><span class="p">(</span><span class="n">val_epoch_loss_metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Called at the end of each validation epoch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>val_epoch_loss_metrics</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Metrics for the validation epoch loss.
list                    -&gt; tuples
Validation Batches      -&gt; (loss, metrics)</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="list" optional>list</autoref>[<autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="torch.Tensor" optional hover>Tensor</autoref>, <autoref identifier="typing.Any" optional hover>Any</autoref>]]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_val_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val_epoch_loss_metrics</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">    Called at the end of each validation epoch.</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">        val_epoch_loss_metrics: Metrics for the validation epoch loss.</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">            list                    -&gt; tuples</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">            Validation Batches      -&gt; (loss, metrics)</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.on_val_epoch_start" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_val_epoch_start</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Called at the start of each validation epoch.</p>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="k">def</span><span class="w"> </span><span class="nf">on_val_epoch_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Called at the start of each validation epoch.&quot;&quot;&quot;</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.train_utils.base_trainer.BaseTrainer.set_use_grad" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_use_grad</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Sets the global use_grad flag.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>value</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to use gradient-based optimization.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="bool" optional>bool</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/train_utils/base_trainer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_use_grad</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    Sets the global use_grad flag.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        value (bool): Whether to use gradient-based optimization.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;use_grad must be a boolean value.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="bp">cls</span><span class="o">.</span><span class="n">_use_grad</span> <span class="o">=</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter" class="doc doc-heading">
            <code>BaseWriter</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="abc.ABC" optional hover>ABC</autoref></code></p>


      <p>Abstract base class for experiment tracking writers.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">METHOD</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter.open" optional hover>open</autoref></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Opens the writer and sets up the logging
environment.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter.close" optional hover>close</autoref></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Closes the writer and finalizes any ongoing logging processes.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter.print_metrics" optional hover>print_metrics</autoref></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Prints metrics and loss in a formatted manner.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter.write" optional hover>write</autoref></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Writes the optimization results to the tracking tool.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_hyperparams" optional hover>log_hyperparams</autoref></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Logs the hyperparameters to the tracking tool.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter.plot" optional hover>plot</autoref></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Logs model plots using provided
plotting functions.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_model" optional hover>log_model</autoref></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Logs the model and any relevant information.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>




  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.close" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Closes the writer and finalizes logging.</p>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Closes the writer and finalizes logging.&quot;&quot;&quot;</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Writers must implement a close method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_hyperparams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_hyperparams</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Logs hyperparameters.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>hyperparams</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary of hyperparameters to log.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="dict" optional>dict</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="k">def</span><span class="w"> </span><span class="nf">log_hyperparams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyperparams</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    Logs hyperparameters.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        hyperparams (dict): A dictionary of hyperparameters to log.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Writers must implement a log_hyperparams method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.log_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Logs the model and associated data.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to log.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>train_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>val_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>test_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for testing data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="k">def</span><span class="w"> </span><span class="nf">log_model</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="n">train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    Logs the model and associated data.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        model (Module): The model to log.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        train_dataloader (DataLoader | DictDataLoader |  None): DataLoader for training data.</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        val_dataloader (DataLoader | DictDataLoader |  None): DataLoader for validation data.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        test_dataloader (DataLoader | DictDataLoader |  None): DataLoader for testing data.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Writers must implement a log_model method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.open" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">open</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">iteration</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Opens the writer and prepares it for logging.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Configuration object containing settings for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>iteration</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The iteration step to start logging from.
Defaults to None.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Opens the writer and prepares it for logging.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        config: Configuration object containing settings for logging.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        iteration (int, optional): The iteration step to start logging from.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Writers must implement an open method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">iteration</span><span class="p">,</span> <span class="n">plotting_functions</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Logs plots of the model using provided plotting functions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to plot.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>iteration</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current iteration number.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>plotting_functions</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Functions used to
generate plots.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="qadence.ml_tools.callbacks.writer_registry.PlottingFunction" optional hover>PlottingFunction</autoref>, ...]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">plotting_functions</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">PlottingFunction</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    Logs plots of the model using provided plotting functions.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        model (Module): The model to plot.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        iteration (int): The current iteration number.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        plotting_functions (tuple[PlottingFunction, ...]): Functions used to</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            generate plots.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Writers must implement a plot method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.print_metrics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_metrics</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Prints the metrics and loss in a readable format.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>result</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The optimization results to display.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.data.OptimizeResult" optional hover>OptimizeResult</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="k">def</span><span class="w"> </span><span class="nf">print_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="n">OptimizeResult</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints the metrics and loss in a readable format.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        result (OptimizeResult): The optimization results to display.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="c1"># Find the key in result.metrics that contains &quot;loss&quot; (case-insensitive)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">loss_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">metrics</span> <span class="k">if</span> <span class="s2">&quot;loss&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">()),</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">if</span> <span class="n">loss_key</span><span class="p">:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">loss_value</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="n">loss_key</span><span class="p">]</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">iteration</span><span class="si">:</span><span class="s2"> &gt;7</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">loss_key</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">loss_value</span><span class="si">:</span><span class="s2">.7f</span><span class="si">}</span><span class="s2"> -&quot;</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">iteration</span><span class="si">:</span><span class="s2"> &gt;7</span><span class="si">}</span><span class="s2"> | Loss: None -&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s2">.7f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">loss_key</span><span class="p">])</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.BaseWriter.write" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

      <p>Logs the results of the current iteration.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>iteration</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current training iteration.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metrics</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary of metrics to log, where keys are metric names
            and values are the corresponding metric values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="dict" optional>dict</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="nd">@abstractmethod</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="k">def</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">metrics</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    Logs the results of the current iteration.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        iteration (int): The current training iteration.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        metrics (dict): A dictionary of metrics to log, where keys are metric names</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">                        and values are the corresponding metric values.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Writers must implement a write method.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">MLFlowWriter</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code></p>


      <p>Writer for logging to MLflow.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.run" optional hover>run</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The active MLflow run.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="mlflow.entities.Run" optional hover>Run</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.mlflow" optional hover>mlflow</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The MLflow module.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="types.ModuleType" optional hover>ModuleType</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">mlflow.entities</span><span class="w"> </span><span class="kn">import</span> <span class="n">Run</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="s2">&quot;mlflow is not installed. Please install qadence with the mlflow feature: &quot;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="s2">&quot;`pip install qadence[mlflow]`.&quot;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">:</span> <span class="n">Run</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="p">:</span> <span class="n">ModuleType</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.close" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Closes the MLflow run.</p>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Closes the MLflow run.&quot;&quot;&quot;</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">end_run</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.get_signature_from_dataloader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_signature_from_dataloader</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Infers the signature of the model based on the input data from the dataloader.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to use for inference.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for model inputs.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><autoref identifier="typing.Any" optional hover>Any</autoref></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Optional[Any]: The inferred signature, if available.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_signature_from_dataloader</span><span class="p">(</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">    Infers the signature of the model based on the input data from the dataloader.</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        model (Module): The model to use for inference.</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        dataloader (DataLoader | DictDataLoader |  None): DataLoader for model inputs.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        Optional[Any]: The inferred signature, if available.</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">mlflow.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">infer_signature</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>    <span class="k">if</span> <span class="n">dataloader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="n">xs</span><span class="p">:</span> <span class="n">InputData</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="n">xs</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">dataloader</span><span class="p">))</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="n">xs</span> <span class="o">=</span> <span class="n">xs</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">preds</span> <span class="o">=</span> <span class="n">preds</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="k">return</span> <span class="n">infer_signature</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.log_hyperparams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_hyperparams</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Logs hyperparameters to MLflow.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>hyperparams</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary of hyperparameters to log.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="dict" optional>dict</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="k">def</span><span class="w"> </span><span class="nf">log_hyperparams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyperparams</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    Logs hyperparameters to MLflow.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        hyperparams (dict): A dictionary of hyperparameters to log.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="p">:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">log_params</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">)</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing&quot;</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.log_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Logs the model and its signature to MLflow using the provided data loaders.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to log.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>train_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>val_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>test_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for testing data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="k">def</span><span class="w"> </span><span class="nf">log_model</span><span class="p">(</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="n">train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="n">val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="n">test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">    Logs the model and its signature to MLflow using the provided data loaders.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        model (Module): The model to log.</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        train_dataloader (DataLoader | DictDataLoader |  None): DataLoader for training data.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">        val_dataloader (DataLoader | DictDataLoader |  None): DataLoader for validation data.</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">        test_dataloader (DataLoader | DictDataLoader |  None): DataLoader for testing data.</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing&quot;</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="p">)</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="n">signatures</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_signature_from_dataloader</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_dataloader</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">pytorch</span><span class="o">.</span><span class="n">log_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">artifact_path</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">signature</span><span class="o">=</span><span class="n">signatures</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.open" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">open</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">iteration</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Opens the MLflow writer and initializes an MLflow run.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Configuration object containing settings for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>iteration</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The iteration step to start logging from.
Defaults to None.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>mlflow</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The MLflow module instance.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="types.ModuleType" optional hover>ModuleType</autoref> | None</code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModuleType</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">    Opens the MLflow writer and initializes an MLflow run.</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        config: Configuration object containing settings for logging.</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        iteration (int, optional): The iteration step to start logging from.</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        mlflow: The MLflow module instance.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">mlflow</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span> <span class="o">=</span> <span class="n">mlflow</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="n">tracking_uri</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;MLFLOW_TRACKING_URI&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;MLFLOW_EXPERIMENT_NAME&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">()))</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">run_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;MLFLOW_RUN_NAME&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">()))</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="p">:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">set_tracking_uri</span><span class="p">(</span><span class="n">tracking_uri</span><span class="p">)</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="c1"># Create or get the experiment</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="n">exp_filter_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;name = &#39;</span><span class="si">{</span><span class="n">experiment_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="n">experiments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">search_experiments</span><span class="p">(</span><span class="n">filter_string</span><span class="o">=</span><span class="n">exp_filter_string</span><span class="p">)</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">experiments</span><span class="p">:</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">create_experiment</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">experiment_name</span><span class="p">)</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">set_experiment</span><span class="p">(</span><span class="n">experiment_name</span><span class="p">)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">start_run</span><span class="p">(</span><span class="n">run_name</span><span class="o">=</span><span class="n">run_name</span><span class="p">,</span> <span class="n">nested</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">iteration</span><span class="p">,</span> <span class="n">plotting_functions</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Logs plots of the model using provided plotting functions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to plot.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>iteration</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current iteration number.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>plotting_functions</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Functions used
to generate plots.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="qadence.ml_tools.callbacks.writer_registry.PlottingFunction" optional hover>PlottingFunction</autoref>, ...]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="n">plotting_functions</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">PlottingFunction</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">    Logs plots of the model using provided plotting functions.</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        model (Module): The model to plot.</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        iteration (int): The current iteration number.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        plotting_functions (tuple[PlottingFunction, ...]): Functions used</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">            to generate plots.</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="p">:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">plotting_functions</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="n">descr</span><span class="p">,</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">pf</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">iteration</span><span class="p">)</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">log_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">descr</span><span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing&quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.MLFlowWriter.write" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Logs the results of the current iteration to MLflow.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>iteration</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current training iteration.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metrics</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary of metrics to log, where keys are metric names
            and values are the corresponding metric values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="dict" optional>dict</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="k">def</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">metrics</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    Logs the results of the current iteration to MLflow.</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        iteration (int): The current training iteration.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        metrics (dict): A dictionary of metrics to log, where keys are metric names</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">                        and values are the corresponding metric values.</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mlflow</span><span class="o">.</span><span class="n">log_metrics</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">iteration</span><span class="p">)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing.&quot;</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">TensorBoardWriter</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code></p>


      <p>Writer for logging to TensorBoard.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.writer" optional hover>writer</autoref></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>The TensorBoard SummaryWriter instance.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.tensorboard.SummaryWriter" optional hover>SummaryWriter</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.close" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Closes the TensorBoard writer.</p>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Closes the TensorBoard writer.&quot;&quot;&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.log_hyperparams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_hyperparams</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Logs hyperparameters to TensorBoard.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>hyperparams</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary of hyperparameters to log.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="dict" optional>dict</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="k">def</span><span class="w"> </span><span class="nf">log_hyperparams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyperparams</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    Logs hyperparameters to TensorBoard.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        hyperparams (dict): A dictionary of hyperparameters to log.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_hparams</span><span class="p">(</span><span class="n">hyperparams</span><span class="p">,</span> <span class="p">{})</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing&quot;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.log_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">val_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Logs the model.</p>
<p>Currently not supported by TensorBoard.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to log.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>train_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for training data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>val_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for validation data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>test_dataloader</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataLoader for testing data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.data.DataLoader" optional hover>DataLoader</autoref> | <autoref identifier="qadence.ml_tools.data.DictDataLoader" optional hover>DictDataLoader</autoref> | None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="k">def</span><span class="w"> </span><span class="nf">log_model</span><span class="p">(</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="n">train_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="n">val_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">test_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span> <span class="o">|</span> <span class="n">DictDataLoader</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">    Logs the model.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    Currently not supported by TensorBoard.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        model (Module): The model to log.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        train_dataloader (DataLoader | DictDataLoader |  None): DataLoader for training data.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        val_dataloader (DataLoader | DictDataLoader |  None): DataLoader for validation data.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        test_dataloader (DataLoader | DictDataLoader |  None): DataLoader for testing data.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Model logging is not supported by tensorboard. No model will be logged.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.open" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">open</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">iteration</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Opens the TensorBoard writer.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Configuration object containing settings for logging.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.config.TrainConfig" optional hover>TrainConfig</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>iteration</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The iteration step to start logging from.
Defaults to None.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>SummaryWriter</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The initialized TensorBoard writer.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.utils.tensorboard.SummaryWriter" optional hover>SummaryWriter</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="k">def</span><span class="w"> </span><span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TrainConfig</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SummaryWriter</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    Opens the TensorBoard writer.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        config: Configuration object containing settings for logging.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        iteration (int, optional): The iteration step to start logging from.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            Defaults to None.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        SummaryWriter: The initialized TensorBoard writer.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="n">log_dir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">log_folder</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="n">purge_step</span> <span class="o">=</span> <span class="n">iteration</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="n">SummaryWriter</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="n">log_dir</span><span class="p">,</span> <span class="n">purge_step</span><span class="o">=</span><span class="n">purge_step</span><span class="p">)</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">iteration</span><span class="p">,</span> <span class="n">plotting_functions</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Logs plots of the model using provided plotting functions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>model</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The model to plot.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="torch.nn.Module" optional hover>Module</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>iteration</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current iteration number.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>plotting_functions</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Functions used
to generate plots.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="tuple" optional>tuple</autoref>[<autoref identifier="qadence.ml_tools.callbacks.writer_registry.PlottingFunction" optional hover>PlottingFunction</autoref>, ...]</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="n">plotting_functions</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">PlottingFunction</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    Logs plots of the model using provided plotting functions.</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        model (Module): The model to plot.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        iteration (int): The current iteration number.</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        plotting_functions (tuple[PlottingFunction, ...]): Functions used</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">            to generate plots.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">plotting_functions</span><span class="p">:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="n">descr</span><span class="p">,</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">pf</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">iteration</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_figure</span><span class="p">(</span><span class="n">descr</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">iteration</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing&quot;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="qadence.ml_tools.callbacks.writer_registry.TensorBoardWriter.write" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="n">metrics</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

      <p>Logs the results of the current iteration to TensorBoard.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>iteration</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current training iteration.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="int" optional>int</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>metrics</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A dictionary of metrics to log, where keys are metric names
            and values are the corresponding metric values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="dict" optional>dict</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="k">def</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iteration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">metrics</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">    Logs the results of the current iteration to TensorBoard.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        iteration (int): The current training iteration.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        metrics (dict): A dictionary of metrics to log, where keys are metric names</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">                        and values are the corresponding metric values.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="p">:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metrics</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">iteration</span><span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="s2">&quot;The writer is not initialized.&quot;</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="s2">&quot;Please call the &#39;writer.open()&#39; method before writing.&quot;</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="qadence.ml_tools.callbacks.writer_registry.get_writer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_writer</span><span class="p">(</span><span class="n">tracking_tool</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

      <p>Factory method to get the appropriate writer based on the tracking tool.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>tracking_tool</code></td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The experiment tracking tool to use.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.types.ExperimentTrackingTool" optional hover>ExperimentTrackingTool</autoref></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>BaseWriter</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>An instance of the appropriate writer.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><autoref identifier="qadence.ml_tools.callbacks.writer_registry.BaseWriter" optional hover>BaseWriter</autoref></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>qadence/ml_tools/callbacks/writer_registry.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_writer</span><span class="p">(</span><span class="n">tracking_tool</span><span class="p">:</span> <span class="n">ExperimentTrackingTool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseWriter</span><span class="p">:</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Factory method to get the appropriate writer based on the tracking tool.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">        tracking_tool (ExperimentTrackingTool): The experiment tracking tool to use.</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">        BaseWriter: An instance of the appropriate writer.</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">writer_class</span> <span class="o">=</span> <span class="n">WRITER_REGISTRY</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tracking_tool</span><span class="p">)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="k">if</span> <span class="n">writer_class</span><span class="p">:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">return</span> <span class="n">writer_class</span><span class="p">()</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported tracking tool: </span><span class="si">{</span><span class="n">tracking_tool</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tabs", "navigation.indexes", "navigation.sections", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="../../assets/_markdown_exec_pyodide.js"></script>
      
        <script src="../../extras/javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>